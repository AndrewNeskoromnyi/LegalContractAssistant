/*! For license information please see taskpane.js.LICENSE.txt */
<<<<<<< HEAD
!function(){var t={27852:function(t,e){!function(t){function e(){this.months=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],this.notKey=[",","{","}"," ","="],this.pos=0,this.input="",this.entries=new Array,this.currentEntry="",this.setInput=function(t){this.input=t},this.getEntries=function(){return this.entries},this.isWhitespace=function(t){return" "==t||"\r"==t||"\t"==t||"\n"==t},this.match=function(t,e){if(null!=e&&null!=e||(e=!0),this.skipWhitespace(e),this.input.substring(this.pos,this.pos+t.length)!=t)throw TypeError("Token mismatch: match","expected "+t+", found "+this.input.substring(this.pos));this.pos+=t.length,this.skipWhitespace(e)},this.tryMatch=function(t,e){return null!=e&&null!=e||(e=!0),this.skipWhitespace(e),this.input.substring(this.pos,this.pos+t.length)==t},this.matchAt=function(){for(;this.input.length>this.pos&&"@"!=this.input[this.pos];)this.pos++;return"@"==this.input[this.pos]},this.skipWhitespace=function(t){for(;this.isWhitespace(this.input[this.pos]);)this.pos++;if("%"==this.input[this.pos]&&1==t){for(;"\n"!=this.input[this.pos];)this.pos++;this.skipWhitespace(t)}},this.value_braces=function(){var t=0;this.match("{",!1);for(var e=this.pos,n=!1;;){if(!n)if("}"==this.input[this.pos]){if(!(t>0)){var r=this.pos;return this.match("}",!1),this.input.substring(e,r)}t--}else if("{"==this.input[this.pos])t++;else if(this.pos>=this.input.length-1)throw TypeError("Unterminated value: value_braces");n="\\"==this.input[this.pos]&&0==n,this.pos++}},this.value_comment=function(){for(var t="",e=0;!this.tryMatch("}",!1)||0!=e;){if(t+=this.input[this.pos],"{"==this.input[this.pos]&&e++,"}"==this.input[this.pos]&&e--,this.pos>=this.input.length-1)throw TypeError("Unterminated value: value_comment",+this.input.substring(start));this.pos++}return t},this.value_quotes=function(){this.match('"',!1);for(var t=this.pos,e=!1;;){if(!e){if('"'==this.input[this.pos]){var n=this.pos;return this.match('"',!1),this.input.substring(t,n)}if(this.pos>=this.input.length-1)throw TypeError("Unterminated value: value_quotes",this.input.substring(t))}e="\\"==this.input[this.pos]&&0==e,this.pos++}},this.single_value=function(){var t=this.pos;if(this.tryMatch("{"))return this.value_braces();if(this.tryMatch('"'))return this.value_quotes();var e=this.key();if(e.match("^[0-9]+$"))return e;if(this.months.indexOf(e.toLowerCase())>=0)return e.toLowerCase();throw"Value expected: single_value"+this.input.substring(t)+" for key: "+e},this.value=function(){var t=[];for(t.push(this.single_value());this.tryMatch("#");)this.match("#"),t.push(this.single_value());return t.join("")},this.key=function(t){for(var e=this.pos;;){if(this.pos>=this.input.length)throw TypeError("Runaway key: key");if(this.notKey.indexOf(this.input[this.pos])>=0)return t&&","!=this.input[this.pos]?(this.pos=e,null):this.input.substring(e,this.pos);this.pos++}},this.key_equals_value=function(){var t=this.key();if(this.tryMatch("=")){this.match("=");var e=this.value();return[t=t.trim(),e]}throw TypeError("Value expected, equals sign missing: key_equals_value",this.input.substring(this.pos))},this.key_value_list=function(){var t=this.key_equals_value();for(this.currentEntry.entryTags={},this.currentEntry.entryTags[t[0]]=t[1];this.tryMatch(",")&&(this.match(","),!this.tryMatch("}"));)t=this.key_equals_value(),this.currentEntry.entryTags[t[0]]=t[1]},this.entry_body=function(t){this.currentEntry={},this.currentEntry.citationKey=this.key(!0),this.currentEntry.entryType=t.substring(1),null!=this.currentEntry.citationKey&&this.match(","),this.key_value_list(),this.entries.push(this.currentEntry)},this.directive=function(){return this.match("@"),"@"+this.key()},this.preamble=function(){this.currentEntry={},this.currentEntry.entryType="PREAMBLE",this.currentEntry.entry=this.value_comment(),this.entries.push(this.currentEntry)},this.comment=function(){this.currentEntry={},this.currentEntry.entryType="COMMENT",this.currentEntry.entry=this.value_comment(),this.entries.push(this.currentEntry)},this.entry=function(t){this.entry_body(t)},this.alernativeCitationKey=function(){this.entries.forEach((function(t){!t.citationKey&&t.entryTags&&(t.citationKey="",t.entryTags.author&&(t.citationKey+=t.entryTags.author.split(",")[0]+=", "),t.citationKey+=t.entryTags.year)}))},this.bibtex=function(){for(;this.matchAt();){var t=this.directive();this.match("{"),"@STRING"==t.toUpperCase()?this.string():"@PREAMBLE"==t.toUpperCase()?this.preamble():"@COMMENT"==t.toUpperCase()?this.comment():this.entry(t),this.match("}")}this.alernativeCitationKey()}}t.toJSON=function(t){var n=new e;return n.setInput(t),n.bibtex(),n.entries},t.toBibtex=function(t,e){void 0===e&&(e=!0);var n="",r=",",s="";for(var o in e||(r=",\n",s="    "),t){if(n+="@"+t[o].entryType,n+="{",t[o].citationKey&&(n+=t[o].citationKey+r),t[o].entry&&(n+=t[o].entry),t[o].entryTags){var i=s;for(var a in t[o].entryTags)0!=i.trim().length&&(i+=r+s),i+=a+(e?"={":" = {")+t[o].entryTags[a]+"}";n+=i}n+=e?"}\n":"\n}\n\n"}return n}}(e)},38075:function(t,e,n){"use strict";var r=n(70453),s=n(10487),o=s(r("String.prototype.indexOf"));t.exports=function(t,e){var n=r(t,!!e);return"function"==typeof n&&o(t,".prototype.")>-1?s(n):n}},10487:function(t,e,n){"use strict";var r=n(66743),s=n(70453),o=n(96897),i=n(69675),a=s("%Function.prototype.apply%"),c=s("%Function.prototype.call%"),l=s("%Reflect.apply%",!0)||r.call(c,a),u=n(30655),f=s("%Math.max%");t.exports=function(t){if("function"!=typeof t)throw new i("a function is required");var e=l(r,c,arguments);return o(e,1+f(0,t.length-(arguments.length-1)),!0)};var h=function(){return l(r,a,arguments)};u?u(t.exports,"apply",{value:h}):t.exports.apply=h},30041:function(t,e,n){"use strict";var r=n(30655),s=n(58068),o=n(69675),i=n(75795);t.exports=function(t,e,n){if(!t||"object"!=typeof t&&"function"!=typeof t)throw new o("`obj` must be an object or a function`");if("string"!=typeof e&&"symbol"!=typeof e)throw new o("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new o("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new o("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new o("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new o("`loose`, if provided, must be a boolean");var a=arguments.length>3?arguments[3]:null,c=arguments.length>4?arguments[4]:null,l=arguments.length>5?arguments[5]:null,u=arguments.length>6&&arguments[6],f=!!i&&i(t,e);if(r)r(t,e,{configurable:null===l&&f?f.configurable:!l,enumerable:null===a&&f?f.enumerable:!a,value:n,writable:null===c&&f?f.writable:!c});else{if(!u&&(a||c||l))throw new s("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");t[e]=n}}},30655:function(t,e,n){"use strict";var r=n(70453)("%Object.defineProperty%",!0)||!1;if(r)try{r({},"a",{value:1})}catch(t){r=!1}t.exports=r},41237:function(t){"use strict";t.exports=EvalError},69383:function(t){"use strict";t.exports=Error},79290:function(t){"use strict";t.exports=RangeError},79538:function(t){"use strict";t.exports=ReferenceError},58068:function(t){"use strict";t.exports=SyntaxError},69675:function(t){"use strict";t.exports=TypeError},35345:function(t){"use strict";t.exports=URIError},89353:function(t){"use strict";var e=Object.prototype.toString,n=Math.max,r=function(t,e){for(var n=[],r=0;r<t.length;r+=1)n[r]=t[r];for(var s=0;s<e.length;s+=1)n[s+t.length]=e[s];return n};t.exports=function(t){var s=this;if("function"!=typeof s||"[object Function]"!==e.apply(s))throw new TypeError("Function.prototype.bind called on incompatible "+s);for(var o,i=function(t,e){for(var n=[],r=1,s=0;r<t.length;r+=1,s+=1)n[s]=t[r];return n}(arguments),a=n(0,s.length-i.length),c=[],l=0;l<a;l++)c[l]="$"+l;if(o=Function("binder","return function ("+function(t,e){for(var n="",r=0;r<t.length;r+=1)n+=t[r],r+1<t.length&&(n+=",");return n}(c)+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof o){var e=s.apply(this,r(i,arguments));return Object(e)===e?e:this}return s.apply(t,r(i,arguments))})),s.prototype){var u=function(){};u.prototype=s.prototype,o.prototype=new u,u.prototype=null}return o}},66743:function(t,e,n){"use strict";var r=n(89353);t.exports=Function.prototype.bind||r},70453:function(t,e,n){"use strict";var r,s=n(69383),o=n(41237),i=n(79290),a=n(79538),c=n(58068),l=n(69675),u=n(35345),f=Function,h=function(t){try{return f('"use strict"; return ('+t+").constructor;")()}catch(t){}},p=Object.getOwnPropertyDescriptor;if(p)try{p({},"")}catch(t){p=null}var d=function(){throw new l},y=p?function(){try{return d}catch(t){try{return p(arguments,"callee").get}catch(t){return d}}}():d,m=n(64039)(),g=n(80024)(),b=Object.getPrototypeOf||(g?function(t){return t.__proto__}:null),w={},v="undefined"!=typeof Uint8Array&&b?b(Uint8Array):r,_={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?r:ArrayBuffer,"%ArrayIteratorPrototype%":m&&b?b([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":w,"%AsyncGenerator%":w,"%AsyncGeneratorFunction%":w,"%AsyncIteratorPrototype%":w,"%Atomics%":"undefined"==typeof Atomics?r:Atomics,"%BigInt%":"undefined"==typeof BigInt?r:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?r:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":s,"%eval%":eval,"%EvalError%":o,"%Float32Array%":"undefined"==typeof Float32Array?r:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?r:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?r:FinalizationRegistry,"%Function%":f,"%GeneratorFunction%":w,"%Int8Array%":"undefined"==typeof Int8Array?r:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?r:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":m&&b?b(b([][Symbol.iterator]())):r,"%JSON%":"object"==typeof JSON?JSON:r,"%Map%":"undefined"==typeof Map?r:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&m&&b?b((new Map)[Symbol.iterator]()):r,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?r:Promise,"%Proxy%":"undefined"==typeof Proxy?r:Proxy,"%RangeError%":i,"%ReferenceError%":a,"%Reflect%":"undefined"==typeof Reflect?r:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?r:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&m&&b?b((new Set)[Symbol.iterator]()):r,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":m&&b?b(""[Symbol.iterator]()):r,"%Symbol%":m?Symbol:r,"%SyntaxError%":c,"%ThrowTypeError%":y,"%TypedArray%":v,"%TypeError%":l,"%Uint8Array%":"undefined"==typeof Uint8Array?r:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?r:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?r:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?r:Uint32Array,"%URIError%":u,"%WeakMap%":"undefined"==typeof WeakMap?r:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?r:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?r:WeakSet};if(b)try{null.error}catch(t){var x=b(b(t));_["%Error.prototype%"]=x}var S=function t(e){var n;if("%AsyncFunction%"===e)n=h("async function () {}");else if("%GeneratorFunction%"===e)n=h("function* () {}");else if("%AsyncGeneratorFunction%"===e)n=h("async function* () {}");else if("%AsyncGenerator%"===e){var r=t("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if("%AsyncIteratorPrototype%"===e){var s=t("%AsyncGenerator%");s&&b&&(n=b(s.prototype))}return _[e]=n,n},A={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},P=n(66743),E=n(9957),O=P.call(Function.call,Array.prototype.concat),j=P.call(Function.apply,Array.prototype.splice),k=P.call(Function.call,String.prototype.replace),R=P.call(Function.call,String.prototype.slice),I=P.call(Function.call,RegExp.prototype.exec),$=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,C=/\\(\\)?/g,T=function(t,e){var n,r=t;if(E(A,r)&&(r="%"+(n=A[r])[0]+"%"),E(_,r)){var s=_[r];if(s===w&&(s=S(r)),void 0===s&&!e)throw new l("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:n,name:r,value:s}}throw new c("intrinsic "+t+" does not exist!")};t.exports=function(t,e){if("string"!=typeof t||0===t.length)throw new l("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof e)throw new l('"allowMissing" argument must be a boolean');if(null===I(/^%?[^%]*%?$/,t))throw new c("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=function(t){var e=R(t,0,1),n=R(t,-1);if("%"===e&&"%"!==n)throw new c("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==e)throw new c("invalid intrinsic syntax, expected opening `%`");var r=[];return k(t,$,(function(t,e,n,s){r[r.length]=n?k(s,C,"$1"):e||t})),r}(t),r=n.length>0?n[0]:"",s=T("%"+r+"%",e),o=s.name,i=s.value,a=!1,u=s.alias;u&&(r=u[0],j(n,O([0,1],u)));for(var f=1,h=!0;f<n.length;f+=1){var d=n[f],y=R(d,0,1),m=R(d,-1);if(('"'===y||"'"===y||"`"===y||'"'===m||"'"===m||"`"===m)&&y!==m)throw new c("property names with quotes must have matching quotes");if("constructor"!==d&&h||(a=!0),E(_,o="%"+(r+="."+d)+"%"))i=_[o];else if(null!=i){if(!(d in i)){if(!e)throw new l("base intrinsic for "+t+" exists, but the property is not available.");return}if(p&&f+1>=n.length){var g=p(i,d);i=(h=!!g)&&"get"in g&&!("originalValue"in g.get)?g.get:i[d]}else h=E(i,d),i=i[d];h&&!a&&(_[o]=i)}}return i}},75795:function(t,e,n){"use strict";var r=n(70453)("%Object.getOwnPropertyDescriptor%",!0);if(r)try{r([],"length")}catch(t){r=null}t.exports=r},30592:function(t,e,n){"use strict";var r=n(30655),s=function(){return!!r};s.hasArrayLengthDefineBug=function(){if(!r)return null;try{return 1!==r([],"length",{value:1}).length}catch(t){return!0}},t.exports=s},80024:function(t){"use strict";var e={__proto__:null,foo:{}},n=Object;t.exports=function(){return{__proto__:e}.foo===e.foo&&!(e instanceof n)}},64039:function(t,e,n){"use strict";var r="undefined"!=typeof Symbol&&Symbol,s=n(41333);t.exports=function(){return"function"==typeof r&&"function"==typeof Symbol&&"symbol"==typeof r("foo")&&"symbol"==typeof Symbol("bar")&&s()}},41333:function(t){"use strict";t.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),n=Object(e);if("string"==typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(e in t[e]=42,t)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var r=Object.getOwnPropertySymbols(t);if(1!==r.length||r[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var s=Object.getOwnPropertyDescriptor(t,e);if(42!==s.value||!0!==s.enumerable)return!1}return!0}},9957:function(t,e,n){"use strict";var r=Function.prototype.call,s=Object.prototype.hasOwnProperty,o=n(66743);t.exports=o.call(r,s)},14385:function(t){"use strict";t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),e.hash&&(t+=e.hash),e.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(t)?'"'.concat(t,'"'):t):t}},58859:function(t,e,n){var r="function"==typeof Map&&Map.prototype,s=Object.getOwnPropertyDescriptor&&r?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,o=r&&s&&"function"==typeof s.get?s.get:null,i=r&&Map.prototype.forEach,a="function"==typeof Set&&Set.prototype,c=Object.getOwnPropertyDescriptor&&a?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,l=a&&c&&"function"==typeof c.get?c.get:null,u=a&&Set.prototype.forEach,f="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,h="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,p="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,d=Boolean.prototype.valueOf,y=Object.prototype.toString,m=Function.prototype.toString,g=String.prototype.match,b=String.prototype.slice,w=String.prototype.replace,v=String.prototype.toUpperCase,_=String.prototype.toLowerCase,x=RegExp.prototype.test,S=Array.prototype.concat,A=Array.prototype.join,P=Array.prototype.slice,E=Math.floor,O="function"==typeof BigInt?BigInt.prototype.valueOf:null,j=Object.getOwnPropertySymbols,k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,R="function"==typeof Symbol&&"object"==typeof Symbol.iterator,I="function"==typeof Symbol&&Symbol.toStringTag&&(Symbol.toStringTag,1)?Symbol.toStringTag:null,$=Object.prototype.propertyIsEnumerable,C=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function T(t,e){if(t===1/0||t===-1/0||t!=t||t&&t>-1e3&&t<1e3||x.call(/e/,e))return e;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof t){var r=t<0?-E(-t):E(t);if(r!==t){var s=String(r),o=b.call(e,s.length+1);return w.call(s,n,"$&_")+"."+w.call(w.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return w.call(e,n,"$&_")}var M=n(42634),N=M.custom,F=U(N)?N:null;function B(t,e,n){var r="double"===(n.quoteStyle||e)?'"':"'";return r+t+r}function L(t){return w.call(String(t),/"/g,"&quot;")}function W(t){return!("[object Array]"!==H(t)||I&&"object"==typeof t&&I in t)}function D(t){return!("[object RegExp]"!==H(t)||I&&"object"==typeof t&&I in t)}function U(t){if(R)return t&&"object"==typeof t&&t instanceof Symbol;if("symbol"==typeof t)return!0;if(!t||"object"!=typeof t||!k)return!1;try{return k.call(t),!0}catch(t){}return!1}t.exports=function t(e,r,s,a){var c=r||{};if(J(c,"quoteStyle")&&"single"!==c.quoteStyle&&"double"!==c.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(J(c,"maxStringLength")&&("number"==typeof c.maxStringLength?c.maxStringLength<0&&c.maxStringLength!==1/0:null!==c.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var y=!J(c,"customInspect")||c.customInspect;if("boolean"!=typeof y&&"symbol"!==y)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(J(c,"indent")&&null!==c.indent&&"\t"!==c.indent&&!(parseInt(c.indent,10)===c.indent&&c.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(J(c,"numericSeparator")&&"boolean"!=typeof c.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var v=c.numericSeparator;if(void 0===e)return"undefined";if(null===e)return"null";if("boolean"==typeof e)return e?"true":"false";if("string"==typeof e)return V(e,c);if("number"==typeof e){if(0===e)return 1/0/e>0?"0":"-0";var x=String(e);return v?T(e,x):x}if("bigint"==typeof e){var E=String(e)+"n";return v?T(e,E):E}var j=void 0===c.depth?5:c.depth;if(void 0===s&&(s=0),s>=j&&j>0&&"object"==typeof e)return W(e)?"[Array]":"[Object]";var N,q=function(t,e){var n;if("\t"===t.indent)n="\t";else{if(!("number"==typeof t.indent&&t.indent>0))return null;n=A.call(Array(t.indent+1)," ")}return{base:n,prev:A.call(Array(e+1),n)}}(c,s);if(void 0===a)a=[];else if(X(a,e)>=0)return"[Circular]";function G(e,n,r){if(n&&(a=P.call(a)).push(n),r){var o={depth:c.depth};return J(c,"quoteStyle")&&(o.quoteStyle=c.quoteStyle),t(e,o,s+1,a)}return t(e,c,s+1,a)}if("function"==typeof e&&!D(e)){var tt=function(t){if(t.name)return t.name;var e=g.call(m.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}(e),et=Z(e,G);return"[Function"+(tt?": "+tt:" (anonymous)")+"]"+(et.length>0?" { "+A.call(et,", ")+" }":"")}if(U(e)){var nt=R?w.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):k.call(e);return"object"!=typeof e||R?nt:K(nt)}if((N=e)&&"object"==typeof N&&("undefined"!=typeof HTMLElement&&N instanceof HTMLElement||"string"==typeof N.nodeName&&"function"==typeof N.getAttribute)){for(var rt="<"+_.call(String(e.nodeName)),st=e.attributes||[],ot=0;ot<st.length;ot++)rt+=" "+st[ot].name+"="+B(L(st[ot].value),"double",c);return rt+=">",e.childNodes&&e.childNodes.length&&(rt+="..."),rt+"</"+_.call(String(e.nodeName))+">"}if(W(e)){if(0===e.length)return"[]";var it=Z(e,G);return q&&!function(t){for(var e=0;e<t.length;e++)if(X(t[e],"\n")>=0)return!1;return!0}(it)?"["+Y(it,q)+"]":"[ "+A.call(it,", ")+" ]"}if(function(t){return!("[object Error]"!==H(t)||I&&"object"==typeof t&&I in t)}(e)){var at=Z(e,G);return"cause"in Error.prototype||!("cause"in e)||$.call(e,"cause")?0===at.length?"["+String(e)+"]":"{ ["+String(e)+"] "+A.call(at,", ")+" }":"{ ["+String(e)+"] "+A.call(S.call("[cause]: "+G(e.cause),at),", ")+" }"}if("object"==typeof e&&y){if(F&&"function"==typeof e[F]&&M)return M(e,{depth:j-s});if("symbol"!==y&&"function"==typeof e.inspect)return e.inspect()}if(function(t){if(!o||!t||"object"!=typeof t)return!1;try{o.call(t);try{l.call(t)}catch(t){return!0}return t instanceof Map}catch(t){}return!1}(e)){var ct=[];return i&&i.call(e,(function(t,n){ct.push(G(n,e,!0)+" => "+G(t,e))})),Q("Map",o.call(e),ct,q)}if(function(t){if(!l||!t||"object"!=typeof t)return!1;try{l.call(t);try{o.call(t)}catch(t){return!0}return t instanceof Set}catch(t){}return!1}(e)){var lt=[];return u&&u.call(e,(function(t){lt.push(G(t,e))})),Q("Set",l.call(e),lt,q)}if(function(t){if(!f||!t||"object"!=typeof t)return!1;try{f.call(t,f);try{h.call(t,h)}catch(t){return!0}return t instanceof WeakMap}catch(t){}return!1}(e))return z("WeakMap");if(function(t){if(!h||!t||"object"!=typeof t)return!1;try{h.call(t,h);try{f.call(t,f)}catch(t){return!0}return t instanceof WeakSet}catch(t){}return!1}(e))return z("WeakSet");if(function(t){if(!p||!t||"object"!=typeof t)return!1;try{return p.call(t),!0}catch(t){}return!1}(e))return z("WeakRef");if(function(t){return!("[object Number]"!==H(t)||I&&"object"==typeof t&&I in t)}(e))return K(G(Number(e)));if(function(t){if(!t||"object"!=typeof t||!O)return!1;try{return O.call(t),!0}catch(t){}return!1}(e))return K(G(O.call(e)));if(function(t){return!("[object Boolean]"!==H(t)||I&&"object"==typeof t&&I in t)}(e))return K(d.call(e));if(function(t){return!("[object String]"!==H(t)||I&&"object"==typeof t&&I in t)}(e))return K(G(String(e)));if("undefined"!=typeof window&&e===window)return"{ [object Window] }";if(e===n.g)return"{ [object globalThis] }";if(!function(t){return!("[object Date]"!==H(t)||I&&"object"==typeof t&&I in t)}(e)&&!D(e)){var ut=Z(e,G),ft=C?C(e)===Object.prototype:e instanceof Object||e.constructor===Object,ht=e instanceof Object?"":"null prototype",pt=!ft&&I&&Object(e)===e&&I in e?b.call(H(e),8,-1):ht?"Object":"",dt=(ft||"function"!=typeof e.constructor?"":e.constructor.name?e.constructor.name+" ":"")+(pt||ht?"["+A.call(S.call([],pt||[],ht||[]),": ")+"] ":"");return 0===ut.length?dt+"{}":q?dt+"{"+Y(ut,q)+"}":dt+"{ "+A.call(ut,", ")+" }"}return String(e)};var q=Object.prototype.hasOwnProperty||function(t){return t in this};function J(t,e){return q.call(t,e)}function H(t){return y.call(t)}function X(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}function V(t,e){if(t.length>e.maxStringLength){var n=t.length-e.maxStringLength,r="... "+n+" more character"+(n>1?"s":"");return V(b.call(t,0,e.maxStringLength),e)+r}return B(w.call(w.call(t,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,G),"single",e)}function G(t){var e=t.charCodeAt(0),n={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return n?"\\"+n:"\\x"+(e<16?"0":"")+v.call(e.toString(16))}function K(t){return"Object("+t+")"}function z(t){return t+" { ? }"}function Q(t,e,n,r){return t+" ("+e+") {"+(r?Y(n,r):A.call(n,", "))+"}"}function Y(t,e){if(0===t.length)return"";var n="\n"+e.prev+e.base;return n+A.call(t,","+n)+"\n"+e.prev}function Z(t,e){var n=W(t),r=[];if(n){r.length=t.length;for(var s=0;s<t.length;s++)r[s]=J(t,s)?e(t[s],t):""}var o,i="function"==typeof j?j(t):[];if(R){o={};for(var a=0;a<i.length;a++)o["$"+i[a]]=i[a]}for(var c in t)J(t,c)&&(n&&String(Number(c))===c&&c<t.length||R&&o["$"+c]instanceof Symbol||(x.call(/[^\w$]/,c)?r.push(e(c,t)+": "+e(t[c],t)):r.push(c+": "+e(t[c],t))));if("function"==typeof j)for(var l=0;l<i.length;l++)$.call(t,i[l])&&r.push("["+e(i[l])+"]: "+e(t[i[l]],t));return r}},74765:function(t){"use strict";var e=String.prototype.replace,n=/%20/g,r="RFC3986";t.exports={default:r,formatters:{RFC1738:function(t){return e.call(t,n,"+")},RFC3986:function(t){return String(t)}},RFC1738:"RFC1738",RFC3986:r}},55373:function(t,e,n){"use strict";var r=n(98636),s=n(62642),o=n(74765);t.exports={formats:o,parse:s,stringify:r}},62642:function(t,e,n){"use strict";var r=n(37720),s=Object.prototype.hasOwnProperty,o=Array.isArray,i={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:r.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},a=function(t){return t.replace(/&#(\d+);/g,(function(t,e){return String.fromCharCode(parseInt(e,10))}))},c=function(t,e){return t&&"string"==typeof t&&e.comma&&t.indexOf(",")>-1?t.split(","):t},l=function(t,e,n,r){if(t){var o=n.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,i=/(\[[^[\]]*])/g,a=n.depth>0&&/(\[[^[\]]*])/.exec(o),l=a?o.slice(0,a.index):o,u=[];if(l){if(!n.plainObjects&&s.call(Object.prototype,l)&&!n.allowPrototypes)return;u.push(l)}for(var f=0;n.depth>0&&null!==(a=i.exec(o))&&f<n.depth;){if(f+=1,!n.plainObjects&&s.call(Object.prototype,a[1].slice(1,-1))&&!n.allowPrototypes)return;u.push(a[1])}return a&&u.push("["+o.slice(a.index)+"]"),function(t,e,n,r){for(var s=r?e:c(e,n),o=t.length-1;o>=0;--o){var i,a=t[o];if("[]"===a&&n.parseArrays)i=[].concat(s);else{i=n.plainObjects?Object.create(null):{};var l="["===a.charAt(0)&&"]"===a.charAt(a.length-1)?a.slice(1,-1):a,u=parseInt(l,10);n.parseArrays||""!==l?!isNaN(u)&&a!==l&&String(u)===l&&u>=0&&n.parseArrays&&u<=n.arrayLimit?(i=[])[u]=s:"__proto__"!==l&&(i[l]=s):i={0:s}}s=i}return s}(u,e,n,r)}};t.exports=function(t,e){var n=function(t){if(!t)return i;if(null!==t.decoder&&void 0!==t.decoder&&"function"!=typeof t.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var e=void 0===t.charset?i.charset:t.charset;return{allowDots:void 0===t.allowDots?i.allowDots:!!t.allowDots,allowPrototypes:"boolean"==typeof t.allowPrototypes?t.allowPrototypes:i.allowPrototypes,allowSparse:"boolean"==typeof t.allowSparse?t.allowSparse:i.allowSparse,arrayLimit:"number"==typeof t.arrayLimit?t.arrayLimit:i.arrayLimit,charset:e,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:i.charsetSentinel,comma:"boolean"==typeof t.comma?t.comma:i.comma,decoder:"function"==typeof t.decoder?t.decoder:i.decoder,delimiter:"string"==typeof t.delimiter||r.isRegExp(t.delimiter)?t.delimiter:i.delimiter,depth:"number"==typeof t.depth||!1===t.depth?+t.depth:i.depth,ignoreQueryPrefix:!0===t.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof t.interpretNumericEntities?t.interpretNumericEntities:i.interpretNumericEntities,parameterLimit:"number"==typeof t.parameterLimit?t.parameterLimit:i.parameterLimit,parseArrays:!1!==t.parseArrays,plainObjects:"boolean"==typeof t.plainObjects?t.plainObjects:i.plainObjects,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:i.strictNullHandling}}(e);if(""===t||null==t)return n.plainObjects?Object.create(null):{};for(var u="string"==typeof t?function(t,e){var n,l={},u=e.ignoreQueryPrefix?t.replace(/^\?/,""):t,f=e.parameterLimit===1/0?void 0:e.parameterLimit,h=u.split(e.delimiter,f),p=-1,d=e.charset;if(e.charsetSentinel)for(n=0;n<h.length;++n)0===h[n].indexOf("utf8=")&&("utf8=%E2%9C%93"===h[n]?d="utf-8":"utf8=%26%2310003%3B"===h[n]&&(d="iso-8859-1"),p=n,n=h.length);for(n=0;n<h.length;++n)if(n!==p){var y,m,g=h[n],b=g.indexOf("]="),w=-1===b?g.indexOf("="):b+1;-1===w?(y=e.decoder(g,i.decoder,d,"key"),m=e.strictNullHandling?null:""):(y=e.decoder(g.slice(0,w),i.decoder,d,"key"),m=r.maybeMap(c(g.slice(w+1),e),(function(t){return e.decoder(t,i.decoder,d,"value")}))),m&&e.interpretNumericEntities&&"iso-8859-1"===d&&(m=a(m)),g.indexOf("[]=")>-1&&(m=o(m)?[m]:m),s.call(l,y)?l[y]=r.combine(l[y],m):l[y]=m}return l}(t,n):t,f=n.plainObjects?Object.create(null):{},h=Object.keys(u),p=0;p<h.length;++p){var d=h[p],y=l(d,u[d],n,"string"==typeof t);f=r.merge(f,y,n)}return!0===n.allowSparse?f:r.compact(f)}},98636:function(t,e,n){"use strict";var r=n(920),s=n(37720),o=n(74765),i=Object.prototype.hasOwnProperty,a={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},c=Array.isArray,l=String.prototype.split,u=Array.prototype.push,f=function(t,e){u.apply(t,c(e)?e:[e])},h=Date.prototype.toISOString,p=o.default,d={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:s.encode,encodeValuesOnly:!1,format:p,formatter:o.formatters[p],indices:!1,serializeDate:function(t){return h.call(t)},skipNulls:!1,strictNullHandling:!1},y={},m=function t(e,n,o,i,a,u,h,p,m,g,b,w,v,_,x,S){for(var A,P=e,E=S,O=0,j=!1;void 0!==(E=E.get(y))&&!j;){var k=E.get(e);if(O+=1,void 0!==k){if(k===O)throw new RangeError("Cyclic object value");j=!0}void 0===E.get(y)&&(O=0)}if("function"==typeof p?P=p(n,P):P instanceof Date?P=b(P):"comma"===o&&c(P)&&(P=s.maybeMap(P,(function(t){return t instanceof Date?b(t):t}))),null===P){if(a)return h&&!_?h(n,d.encoder,x,"key",w):n;P=""}if("string"==typeof(A=P)||"number"==typeof A||"boolean"==typeof A||"symbol"==typeof A||"bigint"==typeof A||s.isBuffer(P)){if(h){var R=_?n:h(n,d.encoder,x,"key",w);if("comma"===o&&_){for(var I=l.call(String(P),","),$="",C=0;C<I.length;++C)$+=(0===C?"":",")+v(h(I[C],d.encoder,x,"value",w));return[v(R)+(i&&c(P)&&1===I.length?"[]":"")+"="+$]}return[v(R)+"="+v(h(P,d.encoder,x,"value",w))]}return[v(n)+"="+v(String(P))]}var T,M=[];if(void 0===P)return M;if("comma"===o&&c(P))T=[{value:P.length>0?P.join(",")||null:void 0}];else if(c(p))T=p;else{var N=Object.keys(P);T=m?N.sort(m):N}for(var F=i&&c(P)&&1===P.length?n+"[]":n,B=0;B<T.length;++B){var L=T[B],W="object"==typeof L&&void 0!==L.value?L.value:P[L];if(!u||null!==W){var D=c(P)?"function"==typeof o?o(F,L):F:F+(g?"."+L:"["+L+"]");S.set(e,O);var U=r();U.set(y,S),f(M,t(W,D,o,i,a,u,h,p,m,g,b,w,v,_,x,U))}}return M};t.exports=function(t,e){var n,s=t,l=function(t){if(!t)return d;if(null!==t.encoder&&void 0!==t.encoder&&"function"!=typeof t.encoder)throw new TypeError("Encoder has to be a function.");var e=t.charset||d.charset;if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=o.default;if(void 0!==t.format){if(!i.call(o.formatters,t.format))throw new TypeError("Unknown format option provided.");n=t.format}var r=o.formatters[n],s=d.filter;return("function"==typeof t.filter||c(t.filter))&&(s=t.filter),{addQueryPrefix:"boolean"==typeof t.addQueryPrefix?t.addQueryPrefix:d.addQueryPrefix,allowDots:void 0===t.allowDots?d.allowDots:!!t.allowDots,charset:e,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:d.charsetSentinel,delimiter:void 0===t.delimiter?d.delimiter:t.delimiter,encode:"boolean"==typeof t.encode?t.encode:d.encode,encoder:"function"==typeof t.encoder?t.encoder:d.encoder,encodeValuesOnly:"boolean"==typeof t.encodeValuesOnly?t.encodeValuesOnly:d.encodeValuesOnly,filter:s,format:n,formatter:r,serializeDate:"function"==typeof t.serializeDate?t.serializeDate:d.serializeDate,skipNulls:"boolean"==typeof t.skipNulls?t.skipNulls:d.skipNulls,sort:"function"==typeof t.sort?t.sort:null,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:d.strictNullHandling}}(e);"function"==typeof l.filter?s=(0,l.filter)("",s):c(l.filter)&&(n=l.filter);var u,h=[];if("object"!=typeof s||null===s)return"";u=e&&e.arrayFormat in a?e.arrayFormat:e&&"indices"in e?e.indices?"indices":"repeat":"indices";var p=a[u];if(e&&"commaRoundTrip"in e&&"boolean"!=typeof e.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var y="comma"===p&&e&&e.commaRoundTrip;n||(n=Object.keys(s)),l.sort&&n.sort(l.sort);for(var g=r(),b=0;b<n.length;++b){var w=n[b];l.skipNulls&&null===s[w]||f(h,m(s[w],w,p,y,l.strictNullHandling,l.skipNulls,l.encode?l.encoder:null,l.filter,l.sort,l.allowDots,l.serializeDate,l.format,l.formatter,l.encodeValuesOnly,l.charset,g))}var v=h.join(l.delimiter),_=!0===l.addQueryPrefix?"?":"";return l.charsetSentinel&&("iso-8859-1"===l.charset?_+="utf8=%26%2310003%3B&":_+="utf8=%E2%9C%93&"),v.length>0?_+v:""}},37720:function(t,e,n){"use strict";var r=n(74765),s=Object.prototype.hasOwnProperty,o=Array.isArray,i=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),a=function(t,e){for(var n=e&&e.plainObjects?Object.create(null):{},r=0;r<t.length;++r)void 0!==t[r]&&(n[r]=t[r]);return n};t.exports={arrayToObject:a,assign:function(t,e){return Object.keys(e).reduce((function(t,n){return t[n]=e[n],t}),t)},combine:function(t,e){return[].concat(t,e)},compact:function(t){for(var e=[{obj:{o:t},prop:"o"}],n=[],r=0;r<e.length;++r)for(var s=e[r],i=s.obj[s.prop],a=Object.keys(i),c=0;c<a.length;++c){var l=a[c],u=i[l];"object"==typeof u&&null!==u&&-1===n.indexOf(u)&&(e.push({obj:i,prop:l}),n.push(u))}return function(t){for(;t.length>1;){var e=t.pop(),n=e.obj[e.prop];if(o(n)){for(var r=[],s=0;s<n.length;++s)void 0!==n[s]&&r.push(n[s]);e.obj[e.prop]=r}}}(e),t},decode:function(t,e,n){var r=t.replace(/\+/g," ");if("iso-8859-1"===n)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(t){return r}},encode:function(t,e,n,s,o){if(0===t.length)return t;var a=t;if("symbol"==typeof t?a=Symbol.prototype.toString.call(t):"string"!=typeof t&&(a=String(t)),"iso-8859-1"===n)return escape(a).replace(/%u[0-9a-f]{4}/gi,(function(t){return"%26%23"+parseInt(t.slice(2),16)+"%3B"}));for(var c="",l=0;l<a.length;++l){var u=a.charCodeAt(l);45===u||46===u||95===u||126===u||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||o===r.RFC1738&&(40===u||41===u)?c+=a.charAt(l):u<128?c+=i[u]:u<2048?c+=i[192|u>>6]+i[128|63&u]:u<55296||u>=57344?c+=i[224|u>>12]+i[128|u>>6&63]+i[128|63&u]:(l+=1,u=65536+((1023&u)<<10|1023&a.charCodeAt(l)),c+=i[240|u>>18]+i[128|u>>12&63]+i[128|u>>6&63]+i[128|63&u])}return c},isBuffer:function(t){return!(!t||"object"!=typeof t||!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t)))},isRegExp:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},maybeMap:function(t,e){if(o(t)){for(var n=[],r=0;r<t.length;r+=1)n.push(e(t[r]));return n}return e(t)},merge:function t(e,n,r){if(!n)return e;if("object"!=typeof n){if(o(e))e.push(n);else{if(!e||"object"!=typeof e)return[e,n];(r&&(r.plainObjects||r.allowPrototypes)||!s.call(Object.prototype,n))&&(e[n]=!0)}return e}if(!e||"object"!=typeof e)return[e].concat(n);var i=e;return o(e)&&!o(n)&&(i=a(e,r)),o(e)&&o(n)?(n.forEach((function(n,o){if(s.call(e,o)){var i=e[o];i&&"object"==typeof i&&n&&"object"==typeof n?e[o]=t(i,n,r):e.push(n)}else e[o]=n})),e):Object.keys(n).reduce((function(e,o){var i=n[o];return s.call(e,o)?e[o]=t(e[o],i,r):e[o]=i,e}),i)}}},96897:function(t,e,n){"use strict";var r=n(70453),s=n(30041),o=n(30592)(),i=n(75795),a=n(69675),c=r("%Math.floor%");t.exports=function(t,e){if("function"!=typeof t)throw new a("`fn` is not a function");if("number"!=typeof e||e<0||e>4294967295||c(e)!==e)throw new a("`length` must be a positive 32-bit integer");var n=arguments.length>2&&!!arguments[2],r=!0,l=!0;if("length"in t&&i){var u=i(t,"length");u&&!u.configurable&&(r=!1),u&&!u.writable&&(l=!1)}return(r||l||!n)&&(o?s(t,"length",e,!0,!0):s(t,"length",e)),t}},920:function(t,e,n){"use strict";var r=n(70453),s=n(38075),o=n(58859),i=n(69675),a=r("%WeakMap%",!0),c=r("%Map%",!0),l=s("WeakMap.prototype.get",!0),u=s("WeakMap.prototype.set",!0),f=s("WeakMap.prototype.has",!0),h=s("Map.prototype.get",!0),p=s("Map.prototype.set",!0),d=s("Map.prototype.has",!0),y=function(t,e){for(var n,r=t;null!==(n=r.next);r=n)if(n.key===e)return r.next=n.next,n.next=t.next,t.next=n,n};t.exports=function(){var t,e,n,r={assert:function(t){if(!r.has(t))throw new i("Side channel does not contain "+o(t))},get:function(r){if(a&&r&&("object"==typeof r||"function"==typeof r)){if(t)return l(t,r)}else if(c){if(e)return h(e,r)}else if(n)return function(t,e){var n=y(t,e);return n&&n.value}(n,r)},has:function(r){if(a&&r&&("object"==typeof r||"function"==typeof r)){if(t)return f(t,r)}else if(c){if(e)return d(e,r)}else if(n)return function(t,e){return!!y(t,e)}(n,r);return!1},set:function(r,s){a&&r&&("object"==typeof r||"function"==typeof r)?(t||(t=new a),u(t,r,s)):c?(e||(e=new c),p(e,r,s)):(n||(n={key:{},next:null}),function(t,e,n){var r=y(t,e);r?r.value=n:t.next={key:e,next:t.next,value:n}}(n,r,s))}};return r}},58394:function(t,e,n){"use strict";t.exports=n.p+"cfe425cae8a67416c0db.css"},42634:function(){}},e={};function n(r){var s=e[r];if(void 0!==s)return s.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}n.m=t,n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},function(){var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var s=r.length-1;s>-1&&(!t||!/^http(s?):/.test(t));)t=r[s--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t}(),n.b=document.baseURI||self.location.href,function(){"use strict";var t={};n.r(t),n.d(t,{xX:function(){return lt},qA:function(){return ut},LG:function(){return at},cH:function(){return ct},v3:function(){return ht},v7:function(){return ft},fK:function(){return yt},pf:function(){return vt},PO:function(){return bt},k5:function(){return wt},m_:function(){return dt},vc:function(){return it},Ll:function(){return pt},OE:function(){return gt},Is:function(){return mt}});const e="4.61.0";let r,s,o,i,a,c,l,u,f,h=!1,p=null,d=null,y=null,m=null;class g{constructor(t){this.body=t}get[Symbol.toStringTag](){return"MultipartBody"}}r||function(t,e={auto:!1}){if(h)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(r)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${r}'\``);h=e.auto,r=t.kind,s=t.fetch,p=t.Request,d=t.Response,y=t.Headers,o=t.FormData,m=t.Blob,i=t.File,a=t.ReadableStream,c=t.getMultipartRequestOptions,l=t.getDefaultAgent,u=t.fileFromPath,f=t.isFsReadStream}(function({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,s,o;try{n=fetch,r=Request,s=Response,o=Headers}catch(t){throw new Error(`this environment is missing the following Web Fetch API type: ${t.message}. ${e}`)}return{kind:"web",fetch:n,Request:r,Response:s,Headers:o,FormData:"undefined"!=typeof FormData?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:"undefined"!=typeof Blob?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:"undefined"!=typeof File?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:"undefined"!=typeof ReadableStream?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(t,e)=>({...e,body:new g(t)}),getDefaultAgent:t=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:t=>!1}}(),{auto:!0});class b{constructor(t,e){this.iterator=t,this.controller=e}static fromSSEResponse(t,e){let n=!1;return new b((async function*(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let r=!1;try{for await(const n of async function*(t,e){if(!t.body)throw e.abort(),new it("Attempted to iterate over a response with no body");const n=new v,r=new _,s=x(t.body);for await(const t of async function*(t){let e=new Uint8Array;for await(const n of t){if(null==n)continue;const t=n instanceof ArrayBuffer?new Uint8Array(n):"string"==typeof n?(new TextEncoder).encode(n):n;let r,s=new Uint8Array(e.length+t.length);for(s.set(e),s.set(t,e.length),e=s;-1!==(r=w(e));)yield e.slice(0,r),e=e.slice(r)}e.length>0&&(yield e)}(s))for(const e of r.decode(t)){const t=n.decode(e);t&&(yield t)}for(const t of r.flush()){const e=n.decode(t);e&&(yield e)}}(t,e))if(!r)if(n.data.startsWith("[DONE]"))r=!0;else if(null===n.event){let t;try{t=JSON.parse(n.data)}catch(t){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),t}if(t&&t.error)throw new at(void 0,t.error,void 0,void 0);yield t}else{let t;try{t=JSON.parse(n.data)}catch(t){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),t}if("error"==n.event)throw new at(void 0,t.error,t.message,void 0);yield{event:n.event,data:t}}r=!0}catch(t){if(t instanceof Error&&"AbortError"===t.name)return;throw t}finally{r||e.abort()}}),e)}static fromReadableStream(t,e){let n=!1;return new b((async function*(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let r=!1;try{for await(const e of async function*(){const e=new _,n=x(t);for await(const t of n)for(const n of e.decode(t))yield n;for(const t of e.flush())yield t}())r||e&&(yield JSON.parse(e));r=!0}catch(t){if(t instanceof Error&&"AbortError"===t.name)return;throw t}finally{r||e.abort()}}),e)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],e=[],n=this.iterator(),r=r=>({next:()=>{if(0===r.length){const r=n.next();t.push(r),e.push(r)}return r.shift()}});return[new b((()=>r(t)),this.controller),new b((()=>r(e)),this.controller)]}toReadableStream(){const t=this;let e;const n=new TextEncoder;return new a({async start(){e=t[Symbol.asyncIterator]()},async pull(t){try{const{value:r,done:s}=await e.next();if(s)return t.close();const o=n.encode(JSON.stringify(r)+"\n");t.enqueue(o)}catch(e){t.error(e)}},async cancel(){await(e.return?.())}})}}function w(t){for(let e=0;e<t.length-2;e++){if(10===t[e]&&10===t[e+1])return e+2;if(13===t[e]&&13===t[e+1])return e+2;if(13===t[e]&&10===t[e+1]&&e+3<t.length&&13===t[e+2]&&10===t[e+3])return e+4}return-1}class v{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const t={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],t}if(this.chunks.push(t),t.startsWith(":"))return null;let[e,n,r]=function(t,e){const n=t.indexOf(":");return-1!==n?[t.substring(0,n),":",t.substring(n+1)]:[t,"",""]}(t);return r.startsWith(" ")&&(r=r.substring(1)),"event"===e?this.event=r:"data"===e&&this.data.push(r),null}}class _{constructor(){this.buffer=[],this.trailingCR=!1}decode(t){let e=this.decodeText(t);if(this.trailingCR&&(e="\r"+e,this.trailingCR=!1),e.endsWith("\r")&&(this.trailingCR=!0,e=e.slice(0,-1)),!e)return[];const n=_.NEWLINE_CHARS.has(e[e.length-1]||"");let r=e.split(_.NEWLINE_REGEXP);return n&&r.pop(),1!==r.length||n?(this.buffer.length>0&&(r=[this.buffer.join("")+r[0],...r.slice(1)],this.buffer=[]),n||(this.buffer=[r.pop()||""]),r):(this.buffer.push(r[0]),[])}decodeText(t){if(null==t)return"";if("string"==typeof t)return t;if("undefined"!=typeof Buffer){if(t instanceof Buffer)return t.toString();if(t instanceof Uint8Array)return Buffer.from(t).toString();throw new it(`Unexpected: received non-Uint8Array (${t.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"!=typeof TextDecoder){if(t instanceof Uint8Array||t instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(t);throw new it(`Unexpected: received non-Uint8Array/ArrayBuffer (${t.constructor.name}) in a web platform. Please report this error.`)}throw new it("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const t=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,t}}function x(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const t=await e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}_.NEWLINE_CHARS=new Set(["\n","\r"]),_.NEWLINE_REGEXP=/\r\n|[\n\r]/g;const S=t=>null!=t&&"object"==typeof t&&"string"==typeof t.url&&"function"==typeof t.blob,A=t=>null!=t&&"object"==typeof t&&"string"==typeof t.name&&"number"==typeof t.lastModified&&P(t),P=t=>null!=t&&"object"==typeof t&&"number"==typeof t.size&&"string"==typeof t.type&&"function"==typeof t.text&&"function"==typeof t.slice&&"function"==typeof t.arrayBuffer;async function E(t,e,n){if(t=await t,A(t))return t;if(S(t)){const r=await t.blob();e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file");const s=P(r)?[await r.arrayBuffer()]:[r];return new i(s,e,n)}const r=await async function(t){let e=[];if("string"==typeof t||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(P(t))e.push(await t.arrayBuffer());else{if(!j(t))throw new Error(`Unexpected data type: ${typeof t}; constructor: ${t?.constructor?.name}; props: ${function(t){return`[${Object.getOwnPropertyNames(t).map((t=>`"${t}"`)).join(", ")}]`}(t)}`);for await(const n of t)e.push(n)}return e}(t);if(e||(e=function(t){return O(t.name)||O(t.filename)||O(t.path)?.split(/[\\/]/).pop()}(t)??"unknown_file"),!n?.type){const t=r[0]?.type;"string"==typeof t&&(n={...n,type:t})}return new i(r,e,n)}const O=t=>"string"==typeof t?t:"undefined"!=typeof Buffer&&t instanceof Buffer?String(t):void 0,j=t=>null!=t&&"object"==typeof t&&"function"==typeof t[Symbol.asyncIterator],k=t=>t&&"object"==typeof t&&t.body&&"MultipartBody"===t[Symbol.toStringTag],R=async t=>{const e=await I(t.body);return c(e,t)},I=async t=>{const e=new o;return await Promise.all(Object.entries(t||{}).map((([t,n])=>C(e,t,n)))),e},C=async(t,e,n)=>{if(void 0!==n){if(null==n)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)t.append(e,String(n));else if((t=>A(t)||S(t)||f(t))(n)){const r=await E(n);t.append(e,r)}else if(Array.isArray(n))await Promise.all(n.map((n=>C(t,e+"[]",n))));else{if("object"!=typeof n)throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`);await Promise.all(Object.entries(n).map((([n,r])=>C(t,`${e}[${n}]`,r))))}}};var T;async function M(t){const{response:e}=t;if(t.options.stream)return rt("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):b.fromSSEResponse(e,t.controller);if(204===e.status)return null;if(t.options.__binaryResponse)return e;const n=e.headers.get("content-type");if(n?.includes("application/json")||n?.includes("application/vnd.api+json")){const t=await e.json();return rt("response",e.status,e.url,e.headers,t),t}const r=await e.text();return rt("response",e.status,e.url,e.headers,r),r}class N extends Promise{constructor(t,e=M){super((t=>{t(null)})),this.responsePromise=t,this.parseResponse=e}_thenUnwrap(t){return new N(this.responsePromise,(async e=>t(await this.parseResponse(e))))}asResponse(){return this.responsePromise.then((t=>t.response))}async withResponse(){const[t,e]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:e}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(t,e){return this.parse().then(t,e)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}class F{constructor({baseURL:t,maxRetries:e=2,timeout:n=6e5,httpAgent:r,fetch:o}){this.baseURL=t,this.maxRetries=Q("maxRetries",e),this.timeout=Q("timeout",n),this.httpAgent=r,this.fetch=o??s}authHeaders(t){return{}}defaultHeaders(t){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...X(),...this.authHeaders(t)}}validateHeaders(t,e){}defaultIdempotencyKey(){return`stainless-node-retry-${st()}`}get(t,e){return this.methodRequest("get",t,e)}post(t,e){return this.methodRequest("post",t,e)}patch(t,e){return this.methodRequest("patch",t,e)}put(t,e){return this.methodRequest("put",t,e)}delete(t,e){return this.methodRequest("delete",t,e)}methodRequest(t,e,n){return this.request(Promise.resolve(n).then((async n=>{const r=n&&P(n?.body)?new DataView(await n.body.arrayBuffer()):n?.body instanceof DataView?n.body:n?.body instanceof ArrayBuffer?new DataView(n.body):n&&ArrayBuffer.isView(n?.body)?new DataView(n.body.buffer):n?.body;return{method:t,path:e,...n,body:r}})))}getAPIList(t,e,n){return this.requestAPIList(e,{method:"get",path:t,...n})}calculateContentLength(t){if("string"==typeof t){if("undefined"!=typeof Buffer)return Buffer.byteLength(t,"utf8").toString();if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(t).length.toString()}else if(ArrayBuffer.isView(t))return t.byteLength.toString();return null}buildRequest(t){const{method:e,path:n,query:r,headers:s={}}=t,o=ArrayBuffer.isView(t.body)||t.__binaryRequest&&"string"==typeof t.body?t.body:k(t.body)?t.body.body:t.body?JSON.stringify(t.body,null,2):null,i=this.calculateContentLength(o),a=this.buildURL(n,r);"timeout"in t&&Q("timeout",t.timeout);const c=t.timeout??this.timeout,u=t.httpAgent??this.httpAgent??l(a),f=c+1e3;return"number"==typeof u?.options?.timeout&&f>(u.options.timeout??0)&&(u.options.timeout=f),this.idempotencyHeader&&"get"!==e&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=t.idempotencyKey),{req:{method:e,...o&&{body:o},headers:this.buildHeaders({options:t,headers:s,contentLength:i}),...u&&{agent:u},signal:t.signal??null},url:a,timeout:c}}buildHeaders({options:t,headers:e,contentLength:n}){const s={};return n&&(s["content-length"]=n),nt(s,this.defaultHeaders(t)),nt(s,e),k(t.body)&&"node"!==r&&delete s["content-type"],this.validateHeaders(s,e),s}async prepareOptions(t){}async prepareRequest(t,{url:e,options:n}){}parseHeaders(t){return t?Symbol.iterator in t?Object.fromEntries(Array.from(t).map((t=>[...t]))):{...t}:{}}makeStatusError(t,e,n,r){return at.generate(t,e,n,r)}request(t,e=null){return new N(this.makeRequest(t,e))}async makeRequest(t,e){const n=await t;null==e&&(e=n.maxRetries??this.maxRetries),await this.prepareOptions(n);const{req:r,url:s,timeout:o}=this.buildRequest(n);if(await this.prepareRequest(r,{url:s,options:n}),rt("request",s,n,r.headers),n.signal?.aborted)throw new ct;const i=new AbortController,a=await this.fetchWithTimeout(s,r,o,i).catch(Y);if(a instanceof Error){if(n.signal?.aborted)throw new ct;if(e)return this.retryRequest(n,e);if("AbortError"===a.name)throw new ut;throw new lt({cause:a})}const c=W(a.headers);if(!a.ok){if(e&&this.shouldRetry(a))return rt(`response (error; retrying, ${e} attempts remaining)`,a.status,s,c),this.retryRequest(n,e,c);const t=await a.text().catch((t=>Y(t).message)),r=V(t),o=r?void 0:t;throw rt(`response (error; ${e?"(error; no more retries left)":"(error; not retryable)"})`,a.status,s,c,o),this.makeStatusError(a.status,r,o,c)}return{response:a,options:n,controller:i}}requestAPIList(t,e){const n=this.makeRequest(e,null);return new L(this,n,t)}buildURL(t,e){const n=K(t)?new URL(t):new URL(this.baseURL+(this.baseURL.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),r=this.defaultQuery();return tt(r)||(e={...r,...e}),"object"==typeof e&&e&&!Array.isArray(e)&&(n.search=this.stringifyQuery(e)),n.toString()}stringifyQuery(t){return Object.entries(t).filter((([t,e])=>void 0!==e)).map((([t,e])=>{if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return`${encodeURIComponent(t)}=${encodeURIComponent(e)}`;if(null===e)return`${encodeURIComponent(t)}=`;throw new it(`Cannot stringify type ${typeof e}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)})).join("&")}async fetchWithTimeout(t,e,n,r){const{signal:s,...o}=e||{};s&&s.addEventListener("abort",(()=>r.abort()));const i=setTimeout((()=>r.abort()),n);return this.getRequestClient().fetch.call(void 0,t,{signal:r.signal,...o}).finally((()=>{clearTimeout(i)}))}getRequestClient(){return{fetch:this.fetch}}shouldRetry(t){const e=t.headers.get("x-should-retry");return"true"===e||"false"!==e&&(408===t.status||409===t.status||429===t.status||t.status>=500)}async retryRequest(t,e,n){let r;const s=n?.["retry-after-ms"];if(s){const t=parseFloat(s);Number.isNaN(t)||(r=t)}const o=n?.["retry-after"];if(o&&!r){const t=parseFloat(o);r=Number.isNaN(t)?Date.parse(o)-Date.now():1e3*t}if(!(r&&0<=r&&r<6e4)){const n=t.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(e,n)}return await z(r),this.makeRequest(t,e-1)}calculateDefaultRetryTimeoutMillis(t,e){const n=e-t;return Math.min(.5*Math.pow(2,n),8)*(1-.25*Math.random())*1e3}getUserAgent(){return`${this.constructor.name}/JS ${e}`}}class B{constructor(t,e,n,r){T.set(this,void 0),function(t,e,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===r?s.call(t,n):s?s.value=n:e.set(t,n)}(this,T,t,"f"),this.options=r,this.response=e,this.body=n}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageInfo()}async getNextPage(){const t=this.nextPageInfo();if(!t)throw new it("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const e={...this.options};if("params"in t&&"object"==typeof e.query)e.query={...e.query,...t.params};else if("url"in t){const n=[...Object.entries(e.query||{}),...t.url.searchParams.entries()];for(const[e,r]of n)t.url.searchParams.set(e,r);e.query=void 0,e.path=t.url.toString()}return await function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)}(this,T,"f").requestAPIList(this.constructor,e)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[(T=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const e of t.getPaginatedItems())yield e}}class L extends N{constructor(t,e,n){super(e,(async e=>new n(t,e.response,await M(e),e.options)))}async*[Symbol.asyncIterator](){const t=await(this);for await(const e of t)yield e}}const W=t=>new Proxy(Object.fromEntries(t.entries()),{get(t,e){const n=e.toString();return t[n.toLowerCase()]||t[n]}}),D={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},U=t=>"object"==typeof t&&null!==t&&!tt(t)&&Object.keys(t).every((t=>et(D,t))),q=t=>"x32"===t?"x32":"x86_64"===t||"x64"===t?"x64":"arm"===t?"arm":"aarch64"===t||"arm64"===t?"arm64":t?`other:${t}`:"unknown",J=t=>(t=t.toLowerCase()).includes("ios")?"iOS":"android"===t?"Android":"darwin"===t?"MacOS":"win32"===t?"Windows":"freebsd"===t?"FreeBSD":"openbsd"===t?"OpenBSD":"linux"===t?"Linux":t?`Other:${t}`:"Unknown";let H;const X=()=>H??(H=(()=>{if("undefined"!=typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e,"X-Stainless-OS":J(Deno.build.os),"X-Stainless-Arch":q(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if("[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e,"X-Stainless-OS":J(process.platform),"X-Stainless-Arch":q(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=function(){if("undefined"==typeof navigator||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const t=n.exec(navigator.userAgent);if(t)return{browser:e,version:`${t[1]||0}.${t[2]||0}.${t[3]||0}`}}return null}();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}})()),V=t=>{try{return JSON.parse(t)}catch(t){return}},G=new RegExp("^(?:[a-z]+:)?//","i"),K=t=>G.test(t),z=t=>new Promise((e=>setTimeout(e,t))),Q=(t,e)=>{if("number"!=typeof e||!Number.isInteger(e))throw new it(`${t} must be an integer`);if(e<0)throw new it(`${t} must be a positive integer`);return e},Y=t=>{if(t instanceof Error)return t;if("object"==typeof t&&null!==t)try{return new Error(JSON.stringify(t))}catch{}return new Error(t)},Z=t=>"undefined"!=typeof process?process.env?.[t]?.trim()??void 0:"undefined"!=typeof Deno?Deno.env?.get?.(t)?.trim():void 0;function tt(t){if(!t)return!0;for(const e in t)return!1;return!0}function et(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function nt(t,e){for(const n in e){if(!et(e,n))continue;const r=n.toLowerCase();if(!r)continue;const s=e[n];null===s?delete t[r]:void 0!==s&&(t[r]=s)}}function rt(t,...e){"undefined"!=typeof process&&"true"===process?.env?.DEBUG&&console.log(`OpenAI:DEBUG:${t}`,...e)}const st=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}));function ot(t){return null!=t&&"object"==typeof t&&!Array.isArray(t)}class it extends Error{}class at extends it{constructor(t,e,n,r){super(`${at.makeMessage(t,e,n)}`),this.status=t,this.headers=r,this.request_id=r?.["x-request-id"];const s=e;this.error=s,this.code=s?.code,this.param=s?.param,this.type=s?.type}static makeMessage(t,e,n){const r=e?.message?"string"==typeof e.message?e.message:JSON.stringify(e.message):e?JSON.stringify(e):n;return t&&r?`${t} ${r}`:t?`${t} status code (no body)`:r||"(no status code or body)"}static generate(t,e,n,r){if(!t)return new lt({message:n,cause:Y(e)});const s=e?.error;return 400===t?new ft(t,s,n,r):401===t?new ht(t,s,n,r):403===t?new pt(t,s,n,r):404===t?new dt(t,s,n,r):409===t?new yt(t,s,n,r):422===t?new mt(t,s,n,r):429===t?new gt(t,s,n,r):t>=500?new bt(t,s,n,r):new at(t,s,n,r)}}class ct extends at{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0),this.status=void 0}}class lt extends at{constructor({message:t,cause:e}){super(void 0,void 0,t||"Connection error.",void 0),this.status=void 0,e&&(this.cause=e)}}class ut extends lt{constructor({message:t}={}){super({message:t??"Request timed out."})}}class ft extends at{constructor(){super(...arguments),this.status=400}}class ht extends at{constructor(){super(...arguments),this.status=401}}class pt extends at{constructor(){super(...arguments),this.status=403}}class dt extends at{constructor(){super(...arguments),this.status=404}}class yt extends at{constructor(){super(...arguments),this.status=409}}class mt extends at{constructor(){super(...arguments),this.status=422}}class gt extends at{constructor(){super(...arguments),this.status=429}}class bt extends at{}class wt extends it{constructor(){super("Could not parse response content as the length limit was reached")}}class vt extends it{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var _t=n(55373);class xt extends B{constructor(t,e,n,r){super(t,e,n,r),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class St extends B{constructor(t,e,n,r){super(t,e,n,r),this.data=n.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const t=this.nextPageInfo();if(!t)return null;if("params"in t)return t.params;const e=Object.fromEntries(t.url.searchParams);return Object.keys(e).length?e:null}nextPageInfo(){const t=this.getPaginatedItems();if(!t.length)return null;const e=t[t.length-1]?.id;return e?{params:{after:e}}:null}}class At{constructor(t){this._client=t}}class Pt extends At{create(t,e){return this._client.post("/completions",{body:t,...e,stream:t.stream??!1})}}Pt||(Pt={});class Et extends At{create(t,e){return this._client.post("/chat/completions",{body:t,...e,stream:t.stream??!1})}}Et||(Et={});class Ot extends At{constructor(){super(...arguments),this.completions=new Et(this._client)}}!function(t){t.Completions=Et}(Ot||(Ot={}));class jt extends At{create(t,e){return this._client.post("/embeddings",{body:t,...e})}}jt||(jt={});class kt extends At{create(t,e){return this._client.post("/files",R({body:t,...e}))}retrieve(t,e){return this._client.get(`/files/${t}`,e)}list(t={},e){return U(t)?this.list({},t):this._client.getAPIList("/files",Rt,{query:t,...e})}del(t,e){return this._client.delete(`/files/${t}`,e)}content(t,e){return this._client.get(`/files/${t}/content`,{...e,__binaryResponse:!0})}retrieveContent(t,e){return this._client.get(`/files/${t}/content`,{...e,headers:{Accept:"application/json",...e?.headers}})}async waitForProcessing(t,{pollInterval:e=5e3,maxWait:n=18e5}={}){const r=new Set(["processed","error","deleted"]),s=Date.now();let o=await this.retrieve(t);for(;!o.status||!r.has(o.status);)if(await z(e),o=await this.retrieve(t),Date.now()-s>n)throw new ut({message:`Giving up on waiting for file ${t} to finish processing after ${n} milliseconds.`});return o}}class Rt extends xt{}!function(t){t.FileObjectsPage=Rt}(kt||(kt={}));class It extends At{createVariation(t,e){return this._client.post("/images/variations",R({body:t,...e}))}edit(t,e){return this._client.post("/images/edits",R({body:t,...e}))}generate(t,e){return this._client.post("/images/generations",{body:t,...e})}}It||(It={});class $t extends At{create(t,e){return this._client.post("/audio/speech",{body:t,...e,__binaryResponse:!0})}}$t||($t={});class Ct extends At{create(t,e){return this._client.post("/audio/transcriptions",R({body:t,...e}))}}Ct||(Ct={});class Tt extends At{create(t,e){return this._client.post("/audio/translations",R({body:t,...e}))}}Tt||(Tt={});class Mt extends At{constructor(){super(...arguments),this.transcriptions=new Ct(this._client),this.translations=new Tt(this._client),this.speech=new $t(this._client)}}!function(t){t.Transcriptions=Ct,t.Translations=Tt,t.Speech=$t}(Mt||(Mt={}));class Nt extends At{create(t,e){return this._client.post("/moderations",{body:t,...e})}}Nt||(Nt={});class Ft extends At{retrieve(t,e){return this._client.get(`/models/${t}`,e)}list(t){return this._client.getAPIList("/models",Bt,t)}del(t,e){return this._client.delete(`/models/${t}`,e)}}class Bt extends xt{}!function(t){t.ModelsPage=Bt}(Ft||(Ft={}));class Lt extends At{list(t,e={},n){return U(e)?this.list(t,{},e):this._client.getAPIList(`/fine_tuning/jobs/${t}/checkpoints`,Wt,{query:e,...n})}}class Wt extends St{}!function(t){t.FineTuningJobCheckpointsPage=Wt}(Lt||(Lt={}));class Dt extends At{constructor(){super(...arguments),this.checkpoints=new Lt(this._client)}create(t,e){return this._client.post("/fine_tuning/jobs",{body:t,...e})}retrieve(t,e){return this._client.get(`/fine_tuning/jobs/${t}`,e)}list(t={},e){return U(t)?this.list({},t):this._client.getAPIList("/fine_tuning/jobs",Ut,{query:t,...e})}cancel(t,e){return this._client.post(`/fine_tuning/jobs/${t}/cancel`,e)}listEvents(t,e={},n){return U(e)?this.listEvents(t,{},e):this._client.getAPIList(`/fine_tuning/jobs/${t}/events`,qt,{query:e,...n})}}class Ut extends St{}class qt extends St{}!function(t){t.FineTuningJobsPage=Ut,t.FineTuningJobEventsPage=qt,t.Checkpoints=Lt,t.FineTuningJobCheckpointsPage=Wt}(Dt||(Dt={}));class Jt extends At{constructor(){super(...arguments),this.jobs=new Dt(this._client)}}!function(t){t.Jobs=Dt,t.FineTuningJobsPage=Ut,t.FineTuningJobEventsPage=qt}(Jt||(Jt={}));class Ht extends At{create(t,e){return this._client.post("/assistants",{body:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}retrieve(t,e){return this._client.get(`/assistants/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}update(t,e,n){return this._client.post(`/assistants/${t}`,{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(t={},e){return U(t)?this.list({},t):this._client.getAPIList("/assistants",Xt,{query:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}del(t,e){return this._client.delete(`/assistants/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}}class Xt extends St{}function Vt(t){return"function"==typeof t.parse}!function(t){t.AssistantsPage=Xt}(Ht||(Ht={}));const Gt=t=>"assistant"===t?.role,Kt=t=>"function"===t?.role,zt=t=>"tool"===t?.role;var Qt,Yt,Zt,te,ee,ne,re,se,oe,ie,ae,ce,le,ue=function(t,e,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(t,n):s?s.value=n:e.set(t,n),n},fe=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};class he{constructor(){Qt.add(this),this.controller=new AbortController,Yt.set(this,void 0),Zt.set(this,(()=>{})),te.set(this,(()=>{})),ee.set(this,void 0),ne.set(this,(()=>{})),re.set(this,(()=>{})),se.set(this,{}),oe.set(this,!1),ie.set(this,!1),ae.set(this,!1),ce.set(this,!1),ue(this,Yt,new Promise(((t,e)=>{ue(this,Zt,t,"f"),ue(this,te,e,"f")})),"f"),ue(this,ee,new Promise(((t,e)=>{ue(this,ne,t,"f"),ue(this,re,e,"f")})),"f"),fe(this,Yt,"f").catch((()=>{})),fe(this,ee,"f").catch((()=>{}))}_run(t){setTimeout((()=>{t().then((()=>{this._emitFinal(),this._emit("end")}),fe(this,Qt,"m",le).bind(this))}),0)}_connected(){this.ended||(fe(this,Zt,"f").call(this),this._emit("connect"))}get ended(){return fe(this,oe,"f")}get errored(){return fe(this,ie,"f")}get aborted(){return fe(this,ae,"f")}abort(){this.controller.abort()}on(t,e){return(fe(this,se,"f")[t]||(fe(this,se,"f")[t]=[])).push({listener:e}),this}off(t,e){const n=fe(this,se,"f")[t];if(!n)return this;const r=n.findIndex((t=>t.listener===e));return r>=0&&n.splice(r,1),this}once(t,e){return(fe(this,se,"f")[t]||(fe(this,se,"f")[t]=[])).push({listener:e,once:!0}),this}emitted(t){return new Promise(((e,n)=>{ue(this,ce,!0,"f"),"error"!==t&&this.once("error",n),this.once(t,e)}))}async done(){ue(this,ce,!0,"f"),await fe(this,ee,"f")}_emit(t,...e){if(fe(this,oe,"f"))return;"end"===t&&(ue(this,oe,!0,"f"),fe(this,ne,"f").call(this));const n=fe(this,se,"f")[t];if(n&&(fe(this,se,"f")[t]=n.filter((t=>!t.once)),n.forEach((({listener:t})=>t(...e)))),"abort"===t){const t=e[0];return fe(this,ce,"f")||n?.length||Promise.reject(t),fe(this,te,"f").call(this,t),fe(this,re,"f").call(this,t),void this._emit("end")}if("error"===t){const t=e[0];fe(this,ce,"f")||n?.length||Promise.reject(t),fe(this,te,"f").call(this,t),fe(this,re,"f").call(this,t),this._emit("end")}}_emitFinal(){}}function pe(t){return"auto-parseable-response-format"===t?.$brand}function de(t){return"auto-parseable-tool"===t?.$brand}function ye(t,e){const n=t.choices.map((t=>{if("length"===t.finish_reason)throw new wt;if("content_filter"===t.finish_reason)throw new vt;return{...t,message:{...t.message,tool_calls:t.message.tool_calls?.map((t=>function(t,e){const n=t.tools?.find((t=>t.function?.name===e.function.name));return{...e,function:{...e.function,parsed_arguments:de(n)?n.$parseRaw(e.function.arguments):n?.function.strict?JSON.parse(e.function.arguments):null}}}(e,t)))??[],parsed:t.message.content&&!t.message.refusal?me(e,t.message.content):null}}}));return{...t,choices:n}}function me(t,e){return"json_schema"!==t.response_format?.type?null:"json_schema"===t.response_format?.type?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function ge(t,e){if(!t)return!1;const n=t.tools?.find((t=>t.function?.name===e.function.name));return de(n)||n?.function.strict||!1}function be(t){return!!pe(t.response_format)||(t.tools?.some((t=>de(t)||"function"===t.type&&!0===t.function.strict))??!1)}Yt=new WeakMap,Zt=new WeakMap,te=new WeakMap,ee=new WeakMap,ne=new WeakMap,re=new WeakMap,se=new WeakMap,oe=new WeakMap,ie=new WeakMap,ae=new WeakMap,ce=new WeakMap,Qt=new WeakSet,le=function(t){if(ue(this,ie,!0,"f"),t instanceof Error&&"AbortError"===t.name&&(t=new ct),t instanceof ct)return ue(this,ae,!0,"f"),this._emit("abort",t);if(t instanceof it)return this._emit("error",t);if(t instanceof Error){const e=new it(t.message);return e.cause=t,this._emit("error",e)}return this._emit("error",new it(String(t)))};var we,ve,_e,xe,Se,Ae,Pe,Ee,Oe=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};const je=10;class ke extends he{constructor(){super(...arguments),we.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(t){this._chatCompletions.push(t),this._emit("chatCompletion",t);const e=t.choices[0]?.message;return e&&this._addMessage(e),t}_addMessage(t,e=!0){if("content"in t||(t.content=null),this.messages.push(t),e)if(this._emit("message",t),(Kt(t)||zt(t))&&t.content)this._emit("functionCallResult",t.content);else if(Gt(t)&&t.function_call)this._emit("functionCall",t.function_call);else if(Gt(t)&&t.tool_calls)for(const e of t.tool_calls)"function"===e.type&&this._emit("functionCall",e.function)}async finalChatCompletion(){await this.done();const t=this._chatCompletions[this._chatCompletions.length-1];if(!t)throw new it("stream ended without producing a ChatCompletion");return t}async finalContent(){return await this.done(),Oe(this,we,"m",ve).call(this)}async finalMessage(){return await this.done(),Oe(this,we,"m",_e).call(this)}async finalFunctionCall(){return await this.done(),Oe(this,we,"m",xe).call(this)}async finalFunctionCallResult(){return await this.done(),Oe(this,we,"m",Se).call(this)}async totalUsage(){return await this.done(),Oe(this,we,"m",Ae).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const t=this._chatCompletions[this._chatCompletions.length-1];t&&this._emit("finalChatCompletion",t);const e=Oe(this,we,"m",_e).call(this);e&&this._emit("finalMessage",e);const n=Oe(this,we,"m",ve).call(this);n&&this._emit("finalContent",n);const r=Oe(this,we,"m",xe).call(this);r&&this._emit("finalFunctionCall",r);const s=Oe(this,we,"m",Se).call(this);null!=s&&this._emit("finalFunctionCallResult",s),this._chatCompletions.some((t=>t.usage))&&this._emit("totalUsage",Oe(this,we,"m",Ae).call(this))}async _createChatCompletion(t,e,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),Oe(this,we,"m",Pe).call(this,e);const s=await t.chat.completions.create({...e,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(ye(s,e))}async _runChatCompletion(t,e,n){for(const t of e.messages)this._addMessage(t,!1);return await this._createChatCompletion(t,e,n)}async _runFunctions(t,e,n){const r="function",{function_call:s="auto",stream:o,...i}=e,a="string"!=typeof s&&s?.name,{maxChatCompletions:c=je}=n||{},l={};for(const t of e.functions)l[t.name||t.function.name]=t;const u=e.functions.map((t=>({name:t.name||t.function.name,parameters:t.parameters,description:t.description})));for(const t of e.messages)this._addMessage(t,!1);for(let e=0;e<c;++e){const e=await this._createChatCompletion(t,{...i,function_call:s,functions:u,messages:[...this.messages]},n),o=e.choices[0]?.message;if(!o)throw new it("missing message in ChatCompletion response");if(!o.function_call)return;const{name:c,arguments:f}=o.function_call,h=l[c];if(!h){const t=`Invalid function_call: ${JSON.stringify(c)}. Available options are: ${u.map((t=>JSON.stringify(t.name))).join(", ")}. Please try again`;this._addMessage({role:r,name:c,content:t});continue}if(a&&a!==c){const t=`Invalid function_call: ${JSON.stringify(c)}. ${JSON.stringify(a)} requested. Please try again`;this._addMessage({role:r,name:c,content:t});continue}let p;try{p=Vt(h)?await h.parse(f):f}catch(t){this._addMessage({role:r,name:c,content:t instanceof Error?t.message:String(t)});continue}const d=await h.function(p,this),y=Oe(this,we,"m",Ee).call(this,d);if(this._addMessage({role:r,name:c,content:y}),a)return}}async _runTools(t,e,n){const r="tool",{tool_choice:s="auto",stream:o,...i}=e,a="string"!=typeof s&&s?.function?.name,{maxChatCompletions:c=je}=n||{},l=e.tools.map((t=>{if(de(t)){if(!t.$callback)throw new it("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:t.$callback,name:t.function.name,description:t.function.description||"",parameters:t.function.parameters,parse:t.$parseRaw,strict:!0}}}return t})),u={};for(const t of l)"function"===t.type&&(u[t.function.name||t.function.function.name]=t.function);const f="tools"in e?l.map((t=>"function"===t.type?{type:"function",function:{name:t.function.name||t.function.function.name,parameters:t.function.parameters,description:t.function.description,strict:t.function.strict}}:t)):void 0;for(const t of e.messages)this._addMessage(t,!1);for(let e=0;e<c;++e){const e=await this._createChatCompletion(t,{...i,tool_choice:s,tools:f,messages:[...this.messages]},n),o=e.choices[0]?.message;if(!o)throw new it("missing message in ChatCompletion response");if(!o.tool_calls?.length)return;for(const t of o.tool_calls){if("function"!==t.type)continue;const e=t.id,{name:n,arguments:s}=t.function,o=u[n];if(!o){const t=`Invalid tool_call: ${JSON.stringify(n)}. Available options are: ${Object.keys(u).map((t=>JSON.stringify(t))).join(", ")}. Please try again`;this._addMessage({role:r,tool_call_id:e,content:t});continue}if(a&&a!==n){const t=`Invalid tool_call: ${JSON.stringify(n)}. ${JSON.stringify(a)} requested. Please try again`;this._addMessage({role:r,tool_call_id:e,content:t});continue}let i;try{i=Vt(o)?await o.parse(s):s}catch(t){const n=t instanceof Error?t.message:String(t);this._addMessage({role:r,tool_call_id:e,content:n});continue}const c=await o.function(i,this),l=Oe(this,we,"m",Ee).call(this,c);if(this._addMessage({role:r,tool_call_id:e,content:l}),a)return}}}}we=new WeakSet,ve=function(){return Oe(this,we,"m",_e).call(this).content??null},_e=function(){let t=this.messages.length;for(;t-- >0;){const e=this.messages[t];if(Gt(e)){const{function_call:t,...n}=e,r={...n,content:e.content??null,refusal:e.refusal??null};return t&&(r.function_call=t),r}}throw new it("stream ended without producing a ChatCompletionMessage with role=assistant")},xe=function(){for(let t=this.messages.length-1;t>=0;t--){const e=this.messages[t];if(Gt(e)&&e?.function_call)return e.function_call;if(Gt(e)&&e?.tool_calls?.length)return e.tool_calls.at(-1)?.function}},Se=function(){for(let t=this.messages.length-1;t>=0;t--){const e=this.messages[t];if(Kt(e)&&null!=e.content)return e.content;if(zt(e)&&null!=e.content&&"string"==typeof e.content&&this.messages.some((t=>"assistant"===t.role&&t.tool_calls?.some((t=>"function"===t.type&&t.id===e.tool_call_id)))))return e.content}},Ae=function(){const t={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:e}of this._chatCompletions)e&&(t.completion_tokens+=e.completion_tokens,t.prompt_tokens+=e.prompt_tokens,t.total_tokens+=e.total_tokens);return t},Pe=function(t){if(null!=t.n&&t.n>1)throw new it("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Ee=function(t){return"string"==typeof t?t:void 0===t?"undefined":JSON.stringify(t)};class Re extends ke{static runFunctions(t,e,n){const r=new Re,s={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run((()=>r._runFunctions(t,e,s))),r}static runTools(t,e,n){const r=new Re,s={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run((()=>r._runTools(t,e,s))),r}_addMessage(t,e=!0){super._addMessage(t,e),Gt(t)&&t.content&&this._emit("content",t.content)}}class Ie extends Error{}class $e extends Error{}const Ce=t=>function(t,e=511){if("string"!=typeof t)throw new TypeError("expecting str, got "+typeof t);if(!t.trim())throw new Error(`${t} is empty`);return((t,e)=>{const n=t.length;let r=0;const s=t=>{throw new Ie(`${t} at position ${r}`)},o=t=>{throw new $e(`${t} at position ${r}`)},i=()=>(f(),r>=n&&s("Unexpected end of input"),'"'===t[r]?a():"{"===t[r]?c():"["===t[r]?l():"null"===t.substring(r,r+4)||16&e&&n-r<4&&"null".startsWith(t.substring(r))?(r+=4,null):"true"===t.substring(r,r+4)||32&e&&n-r<4&&"true".startsWith(t.substring(r))?(r+=4,!0):"false"===t.substring(r,r+5)||32&e&&n-r<5&&"false".startsWith(t.substring(r))?(r+=5,!1):"Infinity"===t.substring(r,r+8)||128&e&&n-r<8&&"Infinity".startsWith(t.substring(r))?(r+=8,1/0):"-Infinity"===t.substring(r,r+9)||256&e&&1<n-r&&n-r<9&&"-Infinity".startsWith(t.substring(r))?(r+=9,-1/0):"NaN"===t.substring(r,r+3)||64&e&&n-r<3&&"NaN".startsWith(t.substring(r))?(r+=3,NaN):u()),a=()=>{const i=r;let a=!1;for(r++;r<n&&('"'!==t[r]||a&&"\\"===t[r-1]);)a="\\"===t[r]&&!a,r++;if('"'==t.charAt(r))try{return JSON.parse(t.substring(i,++r-Number(a)))}catch(t){o(String(t))}else if(1&e)try{return JSON.parse(t.substring(i,r-Number(a))+'"')}catch(e){return JSON.parse(t.substring(i,t.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},c=()=>{r++,f();const o={};try{for(;"}"!==t[r];){if(f(),r>=n&&8&e)return o;const s=a();f(),r++;try{const t=i();Object.defineProperty(o,s,{value:t,writable:!0,enumerable:!0,configurable:!0})}catch(t){if(8&e)return o;throw t}f(),","===t[r]&&r++}}catch(t){if(8&e)return o;s("Expected '}' at end of object")}return r++,o},l=()=>{r++;const n=[];try{for(;"]"!==t[r];)n.push(i()),f(),","===t[r]&&r++}catch(t){if(4&e)return n;s("Expected ']' at end of array")}return r++,n},u=()=>{if(0===r){"-"===t&&2&e&&s("Not sure what '-' is");try{return JSON.parse(t)}catch(n){if(2&e)try{return"."===t[t.length-1]?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch(t){}o(String(n))}}const i=r;for("-"===t[r]&&r++;t[r]&&!",]}".includes(t[r]);)r++;r!=n||2&e||s("Unterminated number literal");try{return JSON.parse(t.substring(i,r))}catch(n){"-"===t.substring(i,r)&&2&e&&s("Not sure what '-' is");try{return JSON.parse(t.substring(i,t.lastIndexOf("e")))}catch(t){o(String(t))}}},f=()=>{for(;r<n&&" \n\r\t".includes(t[r]);)r++};return i()})(t.trim(),e)}(t,509);var Te,Me,Ne,Fe,Be,Le,We,De,Ue,qe,Je,He,Xe=function(t,e,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(t,n):s?s.value=n:e.set(t,n),n},Ve=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};class Ge extends ke{constructor(t){super(),Te.add(this),Me.set(this,void 0),Ne.set(this,void 0),Fe.set(this,void 0),Xe(this,Me,t,"f"),Xe(this,Ne,[],"f")}get currentChatCompletionSnapshot(){return Ve(this,Fe,"f")}static fromReadableStream(t){const e=new Ge(null);return e._run((()=>e._fromReadableStream(t))),e}static createChatCompletion(t,e,n){const r=new Ge(e);return r._run((()=>r._runChatCompletion(t,{...e,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}}))),r}async _createChatCompletion(t,e,n){super._createChatCompletion;const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),Ve(this,Te,"m",Be).call(this);const s=await t.chat.completions.create({...e,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const t of s)Ve(this,Te,"m",We).call(this,t);if(s.controller.signal?.aborted)throw new ct;return this._addChatCompletion(Ve(this,Te,"m",qe).call(this))}async _fromReadableStream(t,e){const n=e?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),Ve(this,Te,"m",Be).call(this),this._connected();const r=b.fromReadableStream(t,this.controller);let s;for await(const t of r)s&&s!==t.id&&this._addChatCompletion(Ve(this,Te,"m",qe).call(this)),Ve(this,Te,"m",We).call(this,t),s=t.id;if(r.controller.signal?.aborted)throw new ct;return this._addChatCompletion(Ve(this,Te,"m",qe).call(this))}[(Me=new WeakMap,Ne=new WeakMap,Fe=new WeakMap,Te=new WeakSet,Be=function(){this.ended||Xe(this,Fe,void 0,"f")},Le=function(t){let e=Ve(this,Ne,"f")[t.index];return e||(e={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Ve(this,Ne,"f")[t.index]=e,e)},We=function(t){if(this.ended)return;const e=Ve(this,Te,"m",He).call(this,t);this._emit("chunk",t,e);for(const n of t.choices){const t=e.choices[n.index];null!=n.delta.content&&"assistant"===t.message?.role&&t.message?.content&&(this._emit("content",n.delta.content,t.message.content),this._emit("content.delta",{delta:n.delta.content,snapshot:t.message.content,parsed:t.message.parsed})),null!=n.delta.refusal&&"assistant"===t.message?.role&&t.message?.refusal&&this._emit("refusal.delta",{delta:n.delta.refusal,snapshot:t.message.refusal}),null!=n.logprobs?.content&&"assistant"===t.message?.role&&this._emit("logprobs.content.delta",{content:n.logprobs?.content,snapshot:t.logprobs?.content??[]}),null!=n.logprobs?.refusal&&"assistant"===t.message?.role&&this._emit("logprobs.refusal.delta",{refusal:n.logprobs?.refusal,snapshot:t.logprobs?.refusal??[]});const r=Ve(this,Te,"m",Le).call(this,t);t.finish_reason&&(Ve(this,Te,"m",Ue).call(this,t),null!=r.current_tool_call_index&&Ve(this,Te,"m",De).call(this,t,r.current_tool_call_index));for(const e of n.delta.tool_calls??[])r.current_tool_call_index!==e.index&&(Ve(this,Te,"m",Ue).call(this,t),null!=r.current_tool_call_index&&Ve(this,Te,"m",De).call(this,t,r.current_tool_call_index)),r.current_tool_call_index=e.index;for(const e of n.delta.tool_calls??[]){const n=t.message.tool_calls?.[e.index];n?.type&&"function"===n?.type&&this._emit("tool_calls.function.arguments.delta",{name:n.function?.name,index:e.index,arguments:n.function.arguments,parsed_arguments:n.function.parsed_arguments,arguments_delta:e.function?.arguments??""})}}},De=function(t,e){if(Ve(this,Te,"m",Le).call(this,t).done_tool_calls.has(e))return;const n=t.message.tool_calls?.[e];if(!n)throw new Error("no tool call snapshot");if(!n.type)throw new Error("tool call snapshot missing `type`");if("function"===n.type){const t=Ve(this,Me,"f")?.tools?.find((t=>"function"===t.type&&t.function.name===n.function.name));this._emit("tool_calls.function.arguments.done",{name:n.function.name,index:e,arguments:n.function.arguments,parsed_arguments:de(t)?t.$parseRaw(n.function.arguments):t?.function.strict?JSON.parse(n.function.arguments):null})}else n.type},Ue=function(t){const e=Ve(this,Te,"m",Le).call(this,t);if(t.message.content&&!e.content_done){e.content_done=!0;const n=Ve(this,Te,"m",Je).call(this);this._emit("content.done",{content:t.message.content,parsed:n?n.$parseRaw(t.message.content):null})}t.message.refusal&&!e.refusal_done&&(e.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),t.logprobs?.content&&!e.logprobs_content_done&&(e.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),t.logprobs?.refusal&&!e.logprobs_refusal_done&&(e.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},qe=function(){if(this.ended)throw new it("stream has ended, this shouldn't happen");const t=Ve(this,Fe,"f");if(!t)throw new it("request ended without sending any chunks");return Xe(this,Fe,void 0,"f"),Xe(this,Ne,[],"f"),function(t,e){const{id:n,choices:r,created:s,model:o,system_fingerprint:i,...a}=t,c={...a,id:n,choices:r.map((({message:e,finish_reason:n,index:r,logprobs:s,...o})=>{if(!n)throw new it(`missing finish_reason for choice ${r}`);const{content:i=null,function_call:a,tool_calls:c,...l}=e,u=e.role;if(!u)throw new it(`missing role for choice ${r}`);if(a){const{arguments:t,name:c}=a;if(null==t)throw new it(`missing function_call.arguments for choice ${r}`);if(!c)throw new it(`missing function_call.name for choice ${r}`);return{...o,message:{content:i,function_call:{arguments:t,name:c},role:u,refusal:e.refusal??null},finish_reason:n,index:r,logprobs:s}}return c?{...o,index:r,finish_reason:n,logprobs:s,message:{...l,role:u,content:i,refusal:e.refusal??null,tool_calls:c.map(((e,n)=>{const{function:s,type:o,id:i,...a}=e,{arguments:c,name:l,...u}=s||{};if(null==i)throw new it(`missing choices[${r}].tool_calls[${n}].id\n${Ke(t)}`);if(null==o)throw new it(`missing choices[${r}].tool_calls[${n}].type\n${Ke(t)}`);if(null==l)throw new it(`missing choices[${r}].tool_calls[${n}].function.name\n${Ke(t)}`);if(null==c)throw new it(`missing choices[${r}].tool_calls[${n}].function.arguments\n${Ke(t)}`);return{...a,id:i,type:o,function:{...u,name:l,arguments:c}}}))}}:{...o,message:{...l,content:i,role:u,refusal:e.refusal??null},finish_reason:n,index:r,logprobs:s}})),created:s,model:o,object:"chat.completion",...i?{system_fingerprint:i}:{}};return function(t,e){return e&&be(e)?ye(t,e):{...t,choices:t.choices.map((t=>({...t,message:{...t.message,parsed:null,tool_calls:t.message.tool_calls??[]}})))}}(c,e)}(t,Ve(this,Me,"f"))},Je=function(){const t=Ve(this,Me,"f")?.response_format;return pe(t)?t:null},He=function(t){var e,n,r,s;let o=Ve(this,Fe,"f");const{choices:i,...a}=t;o?Object.assign(o,a):o=Xe(this,Fe,{...a,choices:[]},"f");for(const{delta:i,finish_reason:a,index:c,logprobs:l=null,...u}of t.choices){let t=o.choices[c];if(t||(t=o.choices[c]={finish_reason:a,index:c,message:{},logprobs:l,...u}),l)if(t.logprobs){const{content:r,refusal:s,...o}=l;Object.assign(t.logprobs,o),r&&((e=t.logprobs).content??(e.content=[]),t.logprobs.content.push(...r)),s&&((n=t.logprobs).refusal??(n.refusal=[]),t.logprobs.refusal.push(...s))}else t.logprobs=Object.assign({},l);if(a&&(t.finish_reason=a,Ve(this,Me,"f")&&be(Ve(this,Me,"f")))){if("length"===a)throw new wt;if("content_filter"===a)throw new vt}if(Object.assign(t,u),!i)continue;const{content:f,refusal:h,function_call:p,role:d,tool_calls:y,...m}=i;if(Object.assign(t.message,m),h&&(t.message.refusal=(t.message.refusal||"")+h),d&&(t.message.role=d),p&&(t.message.function_call?(p.name&&(t.message.function_call.name=p.name),p.arguments&&((r=t.message.function_call).arguments??(r.arguments=""),t.message.function_call.arguments+=p.arguments)):t.message.function_call=p),f&&(t.message.content=(t.message.content||"")+f,!t.message.refusal&&Ve(this,Te,"m",Je).call(this)&&(t.message.parsed=Ce(t.message.content))),y){t.message.tool_calls||(t.message.tool_calls=[]);for(const{index:e,id:n,type:r,function:o,...i}of y){const a=(s=t.message.tool_calls)[e]??(s[e]={});Object.assign(a,i),n&&(a.id=n),r&&(a.type=r),o&&(a.function??(a.function={name:o.name??"",arguments:""})),o?.name&&(a.function.name=o.name),o?.arguments&&(a.function.arguments+=o.arguments,ge(Ve(this,Me,"f"),a)&&(a.function.parsed_arguments=Ce(a.function.arguments)))}}}return o},Symbol.asyncIterator)](){const t=[],e=[];let n=!1;return this.on("chunk",(n=>{const r=e.shift();r?r.resolve(n):t.push(n)})),this.on("end",(()=>{n=!0;for(const t of e)t.resolve(void 0);e.length=0})),this.on("abort",(t=>{n=!0;for(const n of e)n.reject(t);e.length=0})),this.on("error",(t=>{n=!0;for(const n of e)n.reject(t);e.length=0})),{next:async()=>t.length?{value:t.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise(((t,n)=>e.push({resolve:t,reject:n}))).then((t=>t?{value:t,done:!1}:{value:void 0,done:!0})),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new b(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Ke(t){return JSON.stringify(t)}class ze extends Ge{static fromReadableStream(t){const e=new ze(null);return e._run((()=>e._fromReadableStream(t))),e}static runFunctions(t,e,n){const r=new ze(null),s={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run((()=>r._runFunctions(t,e,s))),r}static runTools(t,e,n){const r=new ze(e),s={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run((()=>r._runTools(t,e,s))),r}}class Qe extends At{parse(t,e){return function(t){for(const e of t??[]){if("function"!==e.type)throw new it(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(!0!==e.function.strict)throw new it(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}(t.tools),this._client.chat.completions.create(t,{...e,headers:{...e?.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap((e=>ye(e,t)))}runFunctions(t,e){return t.stream?ze.runFunctions(this._client,t,e):Re.runFunctions(this._client,t,e)}runTools(t,e){return t.stream?ze.runTools(this._client,t,e):Re.runTools(this._client,t,e)}stream(t,e){return Ge.createChatCompletion(this._client,t,e)}}class Ye extends At{constructor(){super(...arguments),this.completions=new Qe(this._client)}}!function(t){t.Completions=Qe}(Ye||(Ye={}));var Ze,tn,en,nn,rn,sn,on,an,cn,ln,un,fn,hn,pn,dn,yn,mn,gn,bn,wn,vn,_n,xn,Sn=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)},An=function(t,e,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(t,n):s?s.value=n:e.set(t,n),n};class Pn extends he{constructor(){super(...arguments),Ze.add(this),tn.set(this,[]),en.set(this,{}),nn.set(this,{}),rn.set(this,void 0),sn.set(this,void 0),on.set(this,void 0),an.set(this,void 0),cn.set(this,void 0),ln.set(this,void 0),un.set(this,void 0),fn.set(this,void 0),hn.set(this,void 0)}[(tn=new WeakMap,en=new WeakMap,nn=new WeakMap,rn=new WeakMap,sn=new WeakMap,on=new WeakMap,an=new WeakMap,cn=new WeakMap,ln=new WeakMap,un=new WeakMap,fn=new WeakMap,hn=new WeakMap,Ze=new WeakSet,Symbol.asyncIterator)](){const t=[],e=[];let n=!1;return this.on("event",(n=>{const r=e.shift();r?r.resolve(n):t.push(n)})),this.on("end",(()=>{n=!0;for(const t of e)t.resolve(void 0);e.length=0})),this.on("abort",(t=>{n=!0;for(const n of e)n.reject(t);e.length=0})),this.on("error",(t=>{n=!0;for(const n of e)n.reject(t);e.length=0})),{next:async()=>t.length?{value:t.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise(((t,n)=>e.push({resolve:t,reject:n}))).then((t=>t?{value:t,done:!1}:{value:void 0,done:!0})),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(t){const e=new Pn;return e._run((()=>e._fromReadableStream(t))),e}async _fromReadableStream(t,e){const n=e?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),this._connected();const r=b.fromReadableStream(t,this.controller);for await(const t of r)Sn(this,Ze,"m",pn).call(this,t);if(r.controller.signal?.aborted)throw new ct;return this._addRun(Sn(this,Ze,"m",dn).call(this))}toReadableStream(){return new b(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(t,e,n,r,s){const o=new Pn;return o._run((()=>o._runToolAssistantStream(t,e,n,r,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}}))),o}async _createToolAssistantStream(t,e,n,r,s){const o=s?.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",(()=>this.controller.abort())));const i={...r,stream:!0},a=await t.submitToolOutputs(e,n,i,{...s,signal:this.controller.signal});this._connected();for await(const t of a)Sn(this,Ze,"m",pn).call(this,t);if(a.controller.signal?.aborted)throw new ct;return this._addRun(Sn(this,Ze,"m",dn).call(this))}static createThreadAssistantStream(t,e,n){const r=new Pn;return r._run((()=>r._threadAssistantStream(t,e,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}}))),r}static createAssistantStream(t,e,n,r){const s=new Pn;return s._run((()=>s._runAssistantStream(t,e,n,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}}))),s}currentEvent(){return Sn(this,un,"f")}currentRun(){return Sn(this,fn,"f")}currentMessageSnapshot(){return Sn(this,rn,"f")}currentRunStepSnapshot(){return Sn(this,hn,"f")}async finalRunSteps(){return await this.done(),Object.values(Sn(this,en,"f"))}async finalMessages(){return await this.done(),Object.values(Sn(this,nn,"f"))}async finalRun(){if(await this.done(),!Sn(this,sn,"f"))throw Error("Final run was not received.");return Sn(this,sn,"f")}async _createThreadAssistantStream(t,e,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort())));const s={...e,stream:!0},o=await t.createAndRun(s,{...n,signal:this.controller.signal});this._connected();for await(const t of o)Sn(this,Ze,"m",pn).call(this,t);if(o.controller.signal?.aborted)throw new ct;return this._addRun(Sn(this,Ze,"m",dn).call(this))}async _createAssistantStream(t,e,n,r){const s=r?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",(()=>this.controller.abort())));const o={...n,stream:!0},i=await t.create(e,o,{...r,signal:this.controller.signal});this._connected();for await(const t of i)Sn(this,Ze,"m",pn).call(this,t);if(i.controller.signal?.aborted)throw new ct;return this._addRun(Sn(this,Ze,"m",dn).call(this))}static accumulateDelta(t,e){for(const[n,r]of Object.entries(e)){if(!t.hasOwnProperty(n)){t[n]=r;continue}let e=t[n];if(null!=e)if("index"!==n&&"type"!==n){if("string"==typeof e&&"string"==typeof r)e+=r;else if("number"==typeof e&&"number"==typeof r)e+=r;else{if(!ot(e)||!ot(r)){if(Array.isArray(e)&&Array.isArray(r)){if(e.every((t=>"string"==typeof t||"number"==typeof t))){e.push(...r);continue}for(const t of r){if(!ot(t))throw new Error(`Expected array delta entry to be an object but got: ${t}`);const n=t.index;if(null==n)throw console.error(t),new Error("Expected array delta entry to have an `index` property");if("number"!=typeof n)throw new Error(`Expected array delta entry \`index\` property to be a number but got ${n}`);const r=e[n];null==r?e.push(t):e[n]=this.accumulateDelta(r,t)}continue}throw Error(`Unhandled record type: ${n}, deltaValue: ${r}, accValue: ${e}`)}e=this.accumulateDelta(e,r)}t[n]=e}else t[n]=r;else t[n]=r}return t}_addRun(t){return t}async _threadAssistantStream(t,e,n){return await this._createThreadAssistantStream(e,t,n)}async _runAssistantStream(t,e,n,r){return await this._createAssistantStream(e,t,n,r)}async _runToolAssistantStream(t,e,n,r,s){return await this._createToolAssistantStream(n,t,e,r,s)}}pn=function(t){if(!this.ended)switch(An(this,un,t,"f"),Sn(this,Ze,"m",gn).call(this,t),t.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":Sn(this,Ze,"m",_n).call(this,t);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Sn(this,Ze,"m",mn).call(this,t);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":Sn(this,Ze,"m",yn).call(this,t);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},dn=function(){if(this.ended)throw new it("stream has ended, this shouldn't happen");if(!Sn(this,sn,"f"))throw Error("Final run has not been received");return Sn(this,sn,"f")},yn=function(t){const[e,n]=Sn(this,Ze,"m",wn).call(this,t,Sn(this,rn,"f"));An(this,rn,e,"f"),Sn(this,nn,"f")[e.id]=e;for(const t of n){const n=e.content[t.index];"text"==n?.type&&this._emit("textCreated",n.text)}switch(t.event){case"thread.message.created":this._emit("messageCreated",t.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",t.data.delta,e),t.data.delta.content)for(const n of t.data.delta.content){if("text"==n.type&&n.text){let t=n.text,r=e.content[n.index];if(!r||"text"!=r.type)throw Error("The snapshot associated with this text delta is not text or missing");this._emit("textDelta",t,r.text)}if(n.index!=Sn(this,on,"f")){if(Sn(this,an,"f"))switch(Sn(this,an,"f").type){case"text":this._emit("textDone",Sn(this,an,"f").text,Sn(this,rn,"f"));break;case"image_file":this._emit("imageFileDone",Sn(this,an,"f").image_file,Sn(this,rn,"f"))}An(this,on,n.index,"f")}An(this,an,e.content[n.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(void 0!==Sn(this,on,"f")){const e=t.data.content[Sn(this,on,"f")];if(e)switch(e.type){case"image_file":this._emit("imageFileDone",e.image_file,Sn(this,rn,"f"));break;case"text":this._emit("textDone",e.text,Sn(this,rn,"f"))}}Sn(this,rn,"f")&&this._emit("messageDone",t.data),An(this,rn,void 0,"f")}},mn=function(t){const e=Sn(this,Ze,"m",bn).call(this,t);switch(An(this,hn,e,"f"),t.event){case"thread.run.step.created":this._emit("runStepCreated",t.data);break;case"thread.run.step.delta":const n=t.data.delta;if(n.step_details&&"tool_calls"==n.step_details.type&&n.step_details.tool_calls&&"tool_calls"==e.step_details.type)for(const t of n.step_details.tool_calls)t.index==Sn(this,cn,"f")?this._emit("toolCallDelta",t,e.step_details.tool_calls[t.index]):(Sn(this,ln,"f")&&this._emit("toolCallDone",Sn(this,ln,"f")),An(this,cn,t.index,"f"),An(this,ln,e.step_details.tool_calls[t.index],"f"),Sn(this,ln,"f")&&this._emit("toolCallCreated",Sn(this,ln,"f")));this._emit("runStepDelta",t.data.delta,e);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":An(this,hn,void 0,"f"),"tool_calls"==t.data.step_details.type&&Sn(this,ln,"f")&&(this._emit("toolCallDone",Sn(this,ln,"f")),An(this,ln,void 0,"f")),this._emit("runStepDone",t.data,e)}},gn=function(t){Sn(this,tn,"f").push(t),this._emit("event",t)},bn=function(t){switch(t.event){case"thread.run.step.created":return Sn(this,en,"f")[t.data.id]=t.data,t.data;case"thread.run.step.delta":let e=Sn(this,en,"f")[t.data.id];if(!e)throw Error("Received a RunStepDelta before creation of a snapshot");let n=t.data;if(n.delta){const r=Pn.accumulateDelta(e,n.delta);Sn(this,en,"f")[t.data.id]=r}return Sn(this,en,"f")[t.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":Sn(this,en,"f")[t.data.id]=t.data}if(Sn(this,en,"f")[t.data.id])return Sn(this,en,"f")[t.data.id];throw new Error("No snapshot available")},wn=function(t,e){let n=[];switch(t.event){case"thread.message.created":return[t.data,n];case"thread.message.delta":if(!e)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=t.data;if(r.delta.content)for(const t of r.delta.content)if(t.index in e.content){let n=e.content[t.index];e.content[t.index]=Sn(this,Ze,"m",vn).call(this,t,n)}else e.content[t.index]=t,n.push(t);return[e,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(e)return[e,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},vn=function(t,e){return Pn.accumulateDelta(e,t)},_n=function(t){switch(An(this,fn,t.data,"f"),t.event){case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.cancelling":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":An(this,sn,t.data,"f"),Sn(this,ln,"f")&&(this._emit("toolCallDone",Sn(this,ln,"f")),An(this,ln,void 0,"f"))}};class En extends At{create(t,e,n){return this._client.post(`/threads/${t}/messages`,{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(t,e,n){return this._client.get(`/threads/${t}/messages/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(t,e,n,r){return this._client.post(`/threads/${t}/messages/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(t,e={},n){return U(e)?this.list(t,{},e):this._client.getAPIList(`/threads/${t}/messages`,On,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(t,e,n){return this._client.delete(`/threads/${t}/messages/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class On extends St{}!function(t){t.MessagesPage=On}(En||(En={}));class jn extends At{retrieve(t,e,n,r={},s){return U(r)?this.retrieve(t,e,n,{},r):this._client.get(`/threads/${t}/runs/${e}/steps/${n}`,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}list(t,e,n={},r){return U(n)?this.list(t,e,{},n):this._client.getAPIList(`/threads/${t}/runs/${e}/steps`,kn,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}}class kn extends St{}!function(t){t.RunStepsPage=kn}(jn||(jn={}));class Rn extends At{constructor(){super(...arguments),this.steps=new jn(this._client)}create(t,e,n){const{include:r,...s}=e;return this._client.post(`/threads/${t}/runs`,{query:{include:r},body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers},stream:e.stream??!1})}retrieve(t,e,n){return this._client.get(`/threads/${t}/runs/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(t,e,n,r){return this._client.post(`/threads/${t}/runs/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(t,e={},n){return U(e)?this.list(t,{},e):this._client.getAPIList(`/threads/${t}/runs`,In,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}cancel(t,e,n){return this._client.post(`/threads/${t}/runs/${e}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(t,e,n){const r=await this.create(t,e,n);return await this.poll(t,r.id,n)}createAndStream(t,e,n){return Pn.createAssistantStream(t,this._client.beta.threads.runs,e,n)}async poll(t,e,n){const r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:s,response:o}=await this.retrieve(t,e,{...n,headers:{...n?.headers,...r}}).withResponse();switch(s.status){case"queued":case"in_progress":case"cancelling":let t=5e3;if(n?.pollIntervalMs)t=n.pollIntervalMs;else{const e=o.headers.get("openai-poll-after-ms");if(e){const n=parseInt(e);isNaN(n)||(t=n)}}await z(t);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return s}}}stream(t,e,n){return Pn.createAssistantStream(t,this._client.beta.threads.runs,e,n)}submitToolOutputs(t,e,n,r){return this._client.post(`/threads/${t}/runs/${e}/submit_tool_outputs`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(t,e,n,r){const s=await this.submitToolOutputs(t,e,n,r);return await this.poll(t,s.id,r)}submitToolOutputsStream(t,e,n,r){return Pn.createToolAssistantStream(t,e,this._client.beta.threads.runs,n,r)}}class In extends St{}!function(t){t.RunsPage=In,t.Steps=jn,t.RunStepsPage=kn}(Rn||(Rn={}));class $n extends At{constructor(){super(...arguments),this.runs=new Rn(this._client),this.messages=new En(this._client)}create(t={},e){return U(t)?this.create({},t):this._client.post("/threads",{body:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}retrieve(t,e){return this._client.get(`/threads/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}update(t,e,n){return this._client.post(`/threads/${t}`,{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(t,e){return this._client.delete(`/threads/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}createAndRun(t,e){return this._client.post("/threads/runs",{body:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers},stream:t.stream??!1})}async createAndRunPoll(t,e){const n=await this.createAndRun(t,e);return await this.runs.poll(n.thread_id,n.id,e)}createAndRunStream(t,e){return Pn.createThreadAssistantStream(t,this._client.beta.threads,e)}}!function(t){t.Runs=Rn,t.RunsPage=In,t.Messages=En,t.MessagesPage=On}($n||($n={}));class Cn extends At{create(t,e,n){return this._client.post(`/vector_stores/${t}/files`,{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(t,e,n){return this._client.get(`/vector_stores/${t}/files/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(t,e={},n){return U(e)?this.list(t,{},e):this._client.getAPIList(`/vector_stores/${t}/files`,Tn,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(t,e,n){return this._client.delete(`/vector_stores/${t}/files/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(t,e,n){const r=await this.create(t,e,n);return await this.poll(t,r.id,n)}async poll(t,e,n){const r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const s=await this.retrieve(t,e,{...n,headers:r}).withResponse(),o=s.data;switch(o.status){case"in_progress":let t=5e3;if(n?.pollIntervalMs)t=n.pollIntervalMs;else{const e=s.response.headers.get("openai-poll-after-ms");if(e){const n=parseInt(e);isNaN(n)||(t=n)}}await z(t);break;case"failed":case"completed":return o}}}async upload(t,e,n){const r=await this._client.files.create({file:e,purpose:"assistants"},n);return this.create(t,{file_id:r.id},n)}async uploadAndPoll(t,e,n){const r=await this.upload(t,e,n);return await this.poll(t,r.id,n)}}class Tn extends St{}!function(t){t.VectorStoreFilesPage=Tn}(Cn||(Cn={}));class Mn extends At{create(t,e,n){return this._client.post(`/vector_stores/${t}/file_batches`,{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(t,e,n){return this._client.get(`/vector_stores/${t}/file_batches/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}cancel(t,e,n){return this._client.post(`/vector_stores/${t}/file_batches/${e}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(t,e,n){const r=await this.create(t,e);return await this.poll(t,r.id,n)}listFiles(t,e,n={},r){return U(n)?this.listFiles(t,e,{},n):this._client.getAPIList(`/vector_stores/${t}/file_batches/${e}/files`,Tn,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async poll(t,e,n){const r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:s,response:o}=await this.retrieve(t,e,{...n,headers:r}).withResponse();switch(s.status){case"in_progress":let t=5e3;if(n?.pollIntervalMs)t=n.pollIntervalMs;else{const e=o.headers.get("openai-poll-after-ms");if(e){const n=parseInt(e);isNaN(n)||(t=n)}}await z(t);break;case"failed":case"cancelled":case"completed":return s}}}async uploadAndPoll(t,{files:e,fileIds:n=[]},r){if(null==e||0==e.length)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const s=r?.maxConcurrency??5,o=Math.min(s,e.length),i=this._client,a=e.values(),c=[...n],l=Array(o).fill(a).map((async function(t){for(let e of t){const t=await i.files.create({file:e,purpose:"assistants"},r);c.push(t.id)}}));return await(async t=>{const e=await Promise.allSettled(t),n=e.filter((t=>"rejected"===t.status));if(n.length){for(const t of n)console.error(t.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const t of e)"fulfilled"===t.status&&r.push(t.value);return r})(l),await this.createAndPoll(t,{file_ids:c})}}Mn||(Mn={});class Nn extends At{constructor(){super(...arguments),this.files=new Cn(this._client),this.fileBatches=new Mn(this._client)}create(t,e){return this._client.post("/vector_stores",{body:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}retrieve(t,e){return this._client.get(`/vector_stores/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}update(t,e,n){return this._client.post(`/vector_stores/${t}`,{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(t={},e){return U(t)?this.list({},t):this._client.getAPIList("/vector_stores",Fn,{query:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}del(t,e){return this._client.delete(`/vector_stores/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}}class Fn extends St{}!function(t){t.VectorStoresPage=Fn,t.Files=Cn,t.VectorStoreFilesPage=Tn,t.FileBatches=Mn}(Nn||(Nn={}));class Bn extends At{constructor(){super(...arguments),this.vectorStores=new Nn(this._client),this.chat=new Ye(this._client),this.assistants=new Ht(this._client),this.threads=new $n(this._client)}}!function(t){t.VectorStores=Nn,t.VectorStoresPage=Fn,t.Chat=Ye,t.Assistants=Ht,t.AssistantsPage=Xt,t.Threads=$n}(Bn||(Bn={}));class Ln extends At{create(t,e){return this._client.post("/batches",{body:t,...e})}retrieve(t,e){return this._client.get(`/batches/${t}`,e)}list(t={},e){return U(t)?this.list({},t):this._client.getAPIList("/batches",Wn,{query:t,...e})}cancel(t,e){return this._client.post(`/batches/${t}/cancel`,e)}}class Wn extends St{}!function(t){t.BatchesPage=Wn}(Ln||(Ln={}));class Dn extends At{create(t,e,n){return this._client.post(`/uploads/${t}/parts`,R({body:e,...n}))}}Dn||(Dn={});class Un extends At{constructor(){super(...arguments),this.parts=new Dn(this._client)}create(t,e){return this._client.post("/uploads",{body:t,...e})}cancel(t,e){return this._client.post(`/uploads/${t}/cancel`,e)}complete(t,e,n){return this._client.post(`/uploads/${t}/complete`,{body:e,...n})}}!function(t){t.Parts=Dn}(Un||(Un={}));class qn extends F{constructor({baseURL:t=Z("OPENAI_BASE_URL"),apiKey:e=Z("OPENAI_API_KEY"),organization:n=Z("OPENAI_ORG_ID")??null,project:r=Z("OPENAI_PROJECT_ID")??null,...s}={}){if(void 0===e)throw new it("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:e,organization:n,project:r,...s,baseURL:t||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator)throw new it("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new Pt(this),this.chat=new Ot(this),this.embeddings=new jt(this),this.files=new kt(this),this.images=new It(this),this.audio=new Mt(this),this.moderations=new Nt(this),this.models=new Ft(this),this.fineTuning=new Jt(this),this.beta=new Bn(this),this.batches=new Ln(this),this.uploads=new Un(this),this._options=o,this.apiKey=e,this.organization=n,this.project=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(t){return{...super.defaultHeaders(t),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(t){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(t){return _t.stringify(t,{arrayFormat:"brackets"})}}xn=qn,qn.OpenAI=xn,qn.DEFAULT_TIMEOUT=6e5,qn.OpenAIError=it,qn.APIError=at,qn.APIConnectionError=lt,qn.APIConnectionTimeoutError=ut,qn.APIUserAbortError=ct,qn.NotFoundError=dt,qn.ConflictError=yt,qn.RateLimitError=gt,qn.BadRequestError=ft,qn.AuthenticationError=ht,qn.InternalServerError=bt,qn.PermissionDeniedError=pt,qn.UnprocessableEntityError=mt,qn.toFile=E,qn.fileFromPath=u;const{vc:Jn,LG:Hn,xX:Xn,qA:Vn,cH:Gn,m_:Kn,fK:zn,OE:Qn,v7:Yn,v3:Zn,PO:tr,Ll:er,Is:nr}=t;var rr;(rr=qn||(qn={})).Page=xt,rr.CursorPage=St,rr.Completions=Pt,rr.Chat=Ot,rr.Embeddings=jt,rr.Files=kt,rr.FileObjectsPage=Rt,rr.Images=It,rr.Audio=Mt,rr.Moderations=Nt,rr.Models=Ft,rr.ModelsPage=Bt,rr.FineTuning=Jt,rr.Beta=Bn,rr.Batches=Ln,rr.BatchesPage=Wn,rr.Uploads=Un,new Set(["/completions","/chat/completions","/embeddings","/audio/transcriptions","/audio/translations","/audio/speech","/images/generations"]);var sr=qn;function or(t){return or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},or(t)}function ir(){ir=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof g?e:g,i=Object.create(o.prototype),a=new R(r||[]);return s(i,"_invoke",{value:E(t,n,a)}),i}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",m={};function g(){}function b(){}function w(){}var v={};l(v,i,(function(){return this}));var _=Object.getPrototypeOf,x=_&&_(_(I([])));x&&x!==n&&r.call(x,i)&&(v=x);var S=w.prototype=g.prototype=Object.create(v);function A(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function n(s,o,i,a){var c=f(t[s],t,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==or(u)&&r.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(u).then((function(t){l.value=t,i(l)}),(function(t){return n("throw",t,i,a)}))}a(c.arg)}var o;s(this,"_invoke",{value:function(t,r){function s(){return new e((function(e,s){n(t,r,e,s)}))}return o=o?o.then(s,s):s()}})}function E(e,n,r){var s=h;return function(o,i){if(s===d)throw Error("Generator is already running");if(s===y){if("throw"===o)throw i;return{value:t,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=O(a,r);if(c){if(c===m)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(s===h)throw s=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);s=d;var l=f(e,n,r);if("normal"===l.type){if(s=r.done?y:p,l.arg===m)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(s=y,r.method="throw",r.arg=l.arg)}}}function O(e,n){var r=n.method,s=e.iterator[r];if(s===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=f(s,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function I(e){if(e||""===e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var s=-1,o=function n(){for(;++s<e.length;)if(r.call(e,s))return n.value=e[s],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(or(e)+" is not iterable")}return b.prototype=w,s(S,"constructor",{value:w,configurable:!0}),s(w,"constructor",{value:b,configurable:!0}),b.displayName=l(w,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,l(t,c,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},A(P.prototype),l(P.prototype,a,(function(){return this})),e.AsyncIterator=P,e.async=function(t,n,r,s,o){void 0===o&&(o=Promise);var i=new P(u(t,n,r,s),o);return e.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},A(S),l(S,c,"Generator"),l(S,i,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=I,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function s(r,s){return a.type="throw",a.arg=e,n.next=r,s&&(n.method="next",n.arg=t),!!s}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return s("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(c&&l){if(this.prev<i.catchLoc)return s(i.catchLoc,!0);if(this.prev<i.finallyLoc)return s(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return s(i.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return s(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n];if(s.tryLoc<=this.prev&&r.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var o=s;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var s=r.arg;k(n)}return s}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:I(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}function ar(t,e,n,r,s,o,i){try{var a=t[o](i),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,s)}function cr(t){return function(){var e=this,n=arguments;return new Promise((function(r,s){var o=t.apply(e,n);function i(t){ar(o,r,s,i,a,"next",t)}function a(t){ar(o,r,s,i,a,"throw",t)}i(void 0)}))}}var lr,ur=n(27852),fr="";function hr(t,e,n){return pr.apply(this,arguments)}function pr(){return(pr=cr(ir().mark((function t(e,n,r){var s,o,i,a,c,l,u,f;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,s=new sr({apiKey:"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",dangerouslyAllowBrowser:!0}),o="asst_BnExFeePPpmWiBzyNfkWrAaP",i="Change Article "+e+' in a way that "'+n+'". Show only revised version of '+e+". Highlight the changes using Italic font.",t.next=6,s.beta.threads.create({messages:[{role:"user",content:String(i)}]});case 6:return a=t.sent,c=a.id,console.log("Created thread with Id: "+c),l=s.beta.threads.runs.stream(c,{assistant_id:o}),t.next=12,l.finalRun();case 12:if("completed"!=t.sent.status){t.next=19;break}return t.next=16,s.beta.threads.messages.list(c);case 16:u=t.sent,fr=u.data[0].content[0].text.value,fr=String(fr).replace("\n",String.fromCharCode(11));case 19:t.next=27;break;case 21:t.prev=21,t.t0=t.catch(0),(f=$("#"+r)).text(t.t0.message),f.show(),console.log(t.t0);case 27:case"end":return t.stop()}}),t,null,[[0,21]])})))).apply(this,arguments)}function dr(){return yr.apply(this,arguments)}function yr(){return(yr=cr(ir().mark((function t(){var e,n;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=document.getElementById("bib-file"),(n=new FileReader).onloadend=function(){lr=n.result,wr(),gr()},n.readAsBinaryString(e.files[0]);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function mr(){return(mr=cr(ir().mark((function t(){var e,n;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=$("#search"),n=$("#radio-buttons"),e.on("search keyup",(function(){var t=$(this).val();t?n.children().each((function(){var e=$(this);e.text().search(new RegExp(t,"i"))<0?e.hide():e.show()})):$("#radio-buttons").children().each((function(){$(this).show()})),n.change()}));case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function gr(){return br.apply(this,arguments)}function br(){return(br=cr(ir().mark((function t(){var e;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(e=$("#references-section")).show(),e.change();case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function wr(){return vr.apply(this,arguments)}function vr(){return(vr=cr(ir().mark((function t(){var e,n,r,s,o;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(s in e=ur.toJSON(lr),console.log(e),n=$("#populate-radio"),(r=$("#radio-buttons")).empty(),e)o='<section><input type="radio" id="'.concat(e[s].citationKey,'" name="citation" value=\'').concat(e[s].entryTags.article,"|").concat(e[s].entryTags.annotation,"'>\n      <label for=\"").concat(e[s].citationKey,'"><b>').concat(e[s].entryTags.annotation,"</b><br>").concat(e[s].entryTags.article,'</label><br><br>\n      <div>\n      <textarea class="input" id="openAIPanel').concat(e[s].citationKey,'" rows="8" cols="80"  style="display: none;"></textarea>\n      <div>\n      <div class="error" id="error').concat(e[s].citationKey,'" style="display: none;">\n      <div>\n      </section>'),r.append(o);r.appendTo(n),$("input[name='citation'][type='radio']").on("click",(function(){if($(this).prop("checked")){var t=String($(this).prop("value")).split("|"),e=t[0],n=t[1];kr(e),Mr();var r="error".concat($(this).prop("id"));Ir(e.replace("Article","").trim(),r),_r("openAIPanel".concat($(this).prop("id")),e,n,r)}else Cr(),Fr()})),n.change();case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function _r(t,e,n,r){return xr.apply(this,arguments)}function xr(){return(xr=cr(ir().mark((function t(e,n,r,s){var o,i;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if($(".input").hide(),o=$("#"+e),0!=String(o.text()).trim().length){t.next=11;break}return(i=$("#radio-buttons")).children("input[type=radio]").prop("disabled",!0),$("#please_wait").show(),t.next=8,hr(n,r,s);case 8:o.text(fr),i.children("input[type=radio]").prop("disabled",!1),$("#please_wait").hide();case 11:o.show();case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Sr(){return Ar.apply(this,arguments)}function Ar(){return Ar=cr(ir().mark((function t(){return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Word.run(function(){var t=cr(ir().mark((function t(e){var n,r,s;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=$("input[name='citation'][type='radio']:checked").attr("id"),r=$("#openAIPanel"+n),s=r.text(),e.document.getSelection().insertText(s,Word.InsertLocation.end),t.next=8,e.sync();case 8:console.log("Inserted suggestion: ".concat(citationsuggestion));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)}))),Ar.apply(this,arguments)}function Pr(){return Er.apply(this,arguments)}function Er(){return Er=cr(ir().mark((function t(){return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Word.run(function(){var t=cr(ir().mark((function t(e){var n,r,s;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=$("input[name='citation'][type='radio']:checked").attr("id"),r=$("#openAIPanel"+n),s=r.text(),e.document.getSelection().insertText(s,Word.InsertLocation.replace),t.next=8,e.sync();case 8:console.log("Replacement suggestion: ".concat(s));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)}))),Er.apply(this,arguments)}function Or(){return jr.apply(this,arguments)}function jr(){return(jr=cr(ir().mark((function t(){return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:$("input[name='citation'][type='radio']:checked").prop("checked",!1),$(".input").hide(),$(".error").hide(),Cr(),Fr();case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function kr(t){return Rr.apply(this,arguments)}function Rr(){return(Rr=cr(ir().mark((function t(e){return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:$("#selected").text(e);case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ir(t,e){return $r.apply(this,arguments)}function $r(){return $r=cr(ir().mark((function t(e,n){return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Word.run(function(){var t=cr(ir().mark((function t(r){var s;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r.document.body.search(e,{ignorePunct:!0}).getFirst().select(),t.next=5,r.sync();case 5:t.next=13;break;case 7:t.prev=7,t.t0=t.catch(0),(s=$("#"+n)).text(t.t0.message),s.show(),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)}))),$r.apply(this,arguments)}function Cr(){return Tr.apply(this,arguments)}function Tr(){return(Tr=cr(ir().mark((function t(){return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:$("#selected").text("");case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Mr(){return Nr.apply(this,arguments)}function Nr(){return(Nr=cr(ir().mark((function t(){return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:$(".ms-Button").removeAttr("disabled");case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Fr(){return Br.apply(this,arguments)}function Br(){return(Br=cr(ir().mark((function t(){return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:$(".ms-Button").attr("disabled","disabled");case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Lr(t){return Wr.apply(this,arguments)}function Wr(){return(Wr=cr(ir().mark((function t(e){return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e();case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.log(t.t0);case 8:case"end":return t.stop()}}),t,null,[[0,5]])})))).apply(this,arguments)}Office.onReady((function(t){$(document).ready((function(){t.host===Office.HostType.Word&&(document.getElementById("app-body").style.display="flex",$("#bib-file").on("change",(function(){return Lr(dr)})),function(){mr.apply(this,arguments)}(),$("#replace-suggestion").on("click",(function(){return Lr(Pr)})),$("#insert-suggestion").on("click",(function(){return Lr(Sr)})),$("#clear").on("click",(function(){return Lr(Or)})))}))}))}(),function(){"use strict";var t=n(14385),e=n.n(t),r=new URL(n(58394),n.b);e()(r)}()}();
=======
!function(){var t={27852:function(t,e){!function(t){function e(){this.months=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],this.notKey=[",","{","}"," ","="],this.pos=0,this.input="",this.entries=new Array,this.currentEntry="",this.setInput=function(t){this.input=t},this.getEntries=function(){return this.entries},this.isWhitespace=function(t){return" "==t||"\r"==t||"\t"==t||"\n"==t},this.match=function(t,e){if(null!=e&&null!=e||(e=!0),this.skipWhitespace(e),this.input.substring(this.pos,this.pos+t.length)!=t)throw TypeError("Token mismatch: match","expected "+t+", found "+this.input.substring(this.pos));this.pos+=t.length,this.skipWhitespace(e)},this.tryMatch=function(t,e){return null!=e&&null!=e||(e=!0),this.skipWhitespace(e),this.input.substring(this.pos,this.pos+t.length)==t},this.matchAt=function(){for(;this.input.length>this.pos&&"@"!=this.input[this.pos];)this.pos++;return"@"==this.input[this.pos]},this.skipWhitespace=function(t){for(;this.isWhitespace(this.input[this.pos]);)this.pos++;if("%"==this.input[this.pos]&&1==t){for(;"\n"!=this.input[this.pos];)this.pos++;this.skipWhitespace(t)}},this.value_braces=function(){var t=0;this.match("{",!1);for(var e=this.pos,n=!1;;){if(!n)if("}"==this.input[this.pos]){if(!(t>0)){var r=this.pos;return this.match("}",!1),this.input.substring(e,r)}t--}else if("{"==this.input[this.pos])t++;else if(this.pos>=this.input.length-1)throw TypeError("Unterminated value: value_braces");n="\\"==this.input[this.pos]&&0==n,this.pos++}},this.value_comment=function(){for(var t="",e=0;!this.tryMatch("}",!1)||0!=e;){if(t+=this.input[this.pos],"{"==this.input[this.pos]&&e++,"}"==this.input[this.pos]&&e--,this.pos>=this.input.length-1)throw TypeError("Unterminated value: value_comment",+this.input.substring(start));this.pos++}return t},this.value_quotes=function(){this.match('"',!1);for(var t=this.pos,e=!1;;){if(!e){if('"'==this.input[this.pos]){var n=this.pos;return this.match('"',!1),this.input.substring(t,n)}if(this.pos>=this.input.length-1)throw TypeError("Unterminated value: value_quotes",this.input.substring(t))}e="\\"==this.input[this.pos]&&0==e,this.pos++}},this.single_value=function(){var t=this.pos;if(this.tryMatch("{"))return this.value_braces();if(this.tryMatch('"'))return this.value_quotes();var e=this.key();if(e.match("^[0-9]+$"))return e;if(this.months.indexOf(e.toLowerCase())>=0)return e.toLowerCase();throw"Value expected: single_value"+this.input.substring(t)+" for key: "+e},this.value=function(){var t=[];for(t.push(this.single_value());this.tryMatch("#");)this.match("#"),t.push(this.single_value());return t.join("")},this.key=function(t){for(var e=this.pos;;){if(this.pos>=this.input.length)throw TypeError("Runaway key: key");if(this.notKey.indexOf(this.input[this.pos])>=0)return t&&","!=this.input[this.pos]?(this.pos=e,null):this.input.substring(e,this.pos);this.pos++}},this.key_equals_value=function(){var t=this.key();if(this.tryMatch("=")){this.match("=");var e=this.value();return[t=t.trim(),e]}throw TypeError("Value expected, equals sign missing: key_equals_value",this.input.substring(this.pos))},this.key_value_list=function(){var t=this.key_equals_value();for(this.currentEntry.entryTags={},this.currentEntry.entryTags[t[0]]=t[1];this.tryMatch(",")&&(this.match(","),!this.tryMatch("}"));)t=this.key_equals_value(),this.currentEntry.entryTags[t[0]]=t[1]},this.entry_body=function(t){this.currentEntry={},this.currentEntry.citationKey=this.key(!0),this.currentEntry.entryType=t.substring(1),null!=this.currentEntry.citationKey&&this.match(","),this.key_value_list(),this.entries.push(this.currentEntry)},this.directive=function(){return this.match("@"),"@"+this.key()},this.preamble=function(){this.currentEntry={},this.currentEntry.entryType="PREAMBLE",this.currentEntry.entry=this.value_comment(),this.entries.push(this.currentEntry)},this.comment=function(){this.currentEntry={},this.currentEntry.entryType="COMMENT",this.currentEntry.entry=this.value_comment(),this.entries.push(this.currentEntry)},this.entry=function(t){this.entry_body(t)},this.alernativeCitationKey=function(){this.entries.forEach((function(t){!t.citationKey&&t.entryTags&&(t.citationKey="",t.entryTags.author&&(t.citationKey+=t.entryTags.author.split(",")[0]+=", "),t.citationKey+=t.entryTags.year)}))},this.bibtex=function(){for(;this.matchAt();){var t=this.directive();this.match("{"),"@STRING"==t.toUpperCase()?this.string():"@PREAMBLE"==t.toUpperCase()?this.preamble():"@COMMENT"==t.toUpperCase()?this.comment():this.entry(t),this.match("}")}this.alernativeCitationKey()}}t.toJSON=function(t){var n=new e;return n.setInput(t),n.bibtex(),n.entries},t.toBibtex=function(t,e){void 0===e&&(e=!0);var n="",r=",",s="";for(var o in e||(r=",\n",s="    "),t){if(n+="@"+t[o].entryType,n+="{",t[o].citationKey&&(n+=t[o].citationKey+r),t[o].entry&&(n+=t[o].entry),t[o].entryTags){var i=s;for(var a in t[o].entryTags)0!=i.trim().length&&(i+=r+s),i+=a+(e?"={":" = {")+t[o].entryTags[a]+"}";n+=i}n+=e?"}\n":"\n}\n\n"}return n}}(e)},38075:function(t,e,n){"use strict";var r=n(70453),s=n(10487),o=s(r("String.prototype.indexOf"));t.exports=function(t,e){var n=r(t,!!e);return"function"==typeof n&&o(t,".prototype.")>-1?s(n):n}},10487:function(t,e,n){"use strict";var r=n(66743),s=n(70453),o=n(96897),i=n(69675),a=s("%Function.prototype.apply%"),c=s("%Function.prototype.call%"),l=s("%Reflect.apply%",!0)||r.call(c,a),u=n(30655),f=s("%Math.max%");t.exports=function(t){if("function"!=typeof t)throw new i("a function is required");var e=l(r,c,arguments);return o(e,1+f(0,t.length-(arguments.length-1)),!0)};var h=function(){return l(r,a,arguments)};u?u(t.exports,"apply",{value:h}):t.exports.apply=h},30041:function(t,e,n){"use strict";var r=n(30655),s=n(58068),o=n(69675),i=n(75795);t.exports=function(t,e,n){if(!t||"object"!=typeof t&&"function"!=typeof t)throw new o("`obj` must be an object or a function`");if("string"!=typeof e&&"symbol"!=typeof e)throw new o("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new o("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new o("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new o("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new o("`loose`, if provided, must be a boolean");var a=arguments.length>3?arguments[3]:null,c=arguments.length>4?arguments[4]:null,l=arguments.length>5?arguments[5]:null,u=arguments.length>6&&arguments[6],f=!!i&&i(t,e);if(r)r(t,e,{configurable:null===l&&f?f.configurable:!l,enumerable:null===a&&f?f.enumerable:!a,value:n,writable:null===c&&f?f.writable:!c});else{if(!u&&(a||c||l))throw new s("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");t[e]=n}}},30655:function(t,e,n){"use strict";var r=n(70453)("%Object.defineProperty%",!0)||!1;if(r)try{r({},"a",{value:1})}catch(t){r=!1}t.exports=r},41237:function(t){"use strict";t.exports=EvalError},69383:function(t){"use strict";t.exports=Error},79290:function(t){"use strict";t.exports=RangeError},79538:function(t){"use strict";t.exports=ReferenceError},58068:function(t){"use strict";t.exports=SyntaxError},69675:function(t){"use strict";t.exports=TypeError},35345:function(t){"use strict";t.exports=URIError},89353:function(t){"use strict";var e=Object.prototype.toString,n=Math.max,r=function(t,e){for(var n=[],r=0;r<t.length;r+=1)n[r]=t[r];for(var s=0;s<e.length;s+=1)n[s+t.length]=e[s];return n};t.exports=function(t){var s=this;if("function"!=typeof s||"[object Function]"!==e.apply(s))throw new TypeError("Function.prototype.bind called on incompatible "+s);for(var o,i=function(t,e){for(var n=[],r=1,s=0;r<t.length;r+=1,s+=1)n[s]=t[r];return n}(arguments),a=n(0,s.length-i.length),c=[],l=0;l<a;l++)c[l]="$"+l;if(o=Function("binder","return function ("+function(t,e){for(var n="",r=0;r<t.length;r+=1)n+=t[r],r+1<t.length&&(n+=",");return n}(c)+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof o){var e=s.apply(this,r(i,arguments));return Object(e)===e?e:this}return s.apply(t,r(i,arguments))})),s.prototype){var u=function(){};u.prototype=s.prototype,o.prototype=new u,u.prototype=null}return o}},66743:function(t,e,n){"use strict";var r=n(89353);t.exports=Function.prototype.bind||r},70453:function(t,e,n){"use strict";var r,s=n(69383),o=n(41237),i=n(79290),a=n(79538),c=n(58068),l=n(69675),u=n(35345),f=Function,h=function(t){try{return f('"use strict"; return ('+t+").constructor;")()}catch(t){}},p=Object.getOwnPropertyDescriptor;if(p)try{p({},"")}catch(t){p=null}var d=function(){throw new l},y=p?function(){try{return d}catch(t){try{return p(arguments,"callee").get}catch(t){return d}}}():d,m=n(64039)(),g=n(80024)(),b=Object.getPrototypeOf||(g?function(t){return t.__proto__}:null),w={},v="undefined"!=typeof Uint8Array&&b?b(Uint8Array):r,_={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?r:ArrayBuffer,"%ArrayIteratorPrototype%":m&&b?b([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":w,"%AsyncGenerator%":w,"%AsyncGeneratorFunction%":w,"%AsyncIteratorPrototype%":w,"%Atomics%":"undefined"==typeof Atomics?r:Atomics,"%BigInt%":"undefined"==typeof BigInt?r:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?r:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":s,"%eval%":eval,"%EvalError%":o,"%Float32Array%":"undefined"==typeof Float32Array?r:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?r:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?r:FinalizationRegistry,"%Function%":f,"%GeneratorFunction%":w,"%Int8Array%":"undefined"==typeof Int8Array?r:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?r:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":m&&b?b(b([][Symbol.iterator]())):r,"%JSON%":"object"==typeof JSON?JSON:r,"%Map%":"undefined"==typeof Map?r:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&m&&b?b((new Map)[Symbol.iterator]()):r,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?r:Promise,"%Proxy%":"undefined"==typeof Proxy?r:Proxy,"%RangeError%":i,"%ReferenceError%":a,"%Reflect%":"undefined"==typeof Reflect?r:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?r:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&m&&b?b((new Set)[Symbol.iterator]()):r,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":m&&b?b(""[Symbol.iterator]()):r,"%Symbol%":m?Symbol:r,"%SyntaxError%":c,"%ThrowTypeError%":y,"%TypedArray%":v,"%TypeError%":l,"%Uint8Array%":"undefined"==typeof Uint8Array?r:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?r:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?r:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?r:Uint32Array,"%URIError%":u,"%WeakMap%":"undefined"==typeof WeakMap?r:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?r:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?r:WeakSet};if(b)try{null.error}catch(t){var x=b(b(t));_["%Error.prototype%"]=x}var S=function t(e){var n;if("%AsyncFunction%"===e)n=h("async function () {}");else if("%GeneratorFunction%"===e)n=h("function* () {}");else if("%AsyncGeneratorFunction%"===e)n=h("async function* () {}");else if("%AsyncGenerator%"===e){var r=t("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if("%AsyncIteratorPrototype%"===e){var s=t("%AsyncGenerator%");s&&b&&(n=b(s.prototype))}return _[e]=n,n},A={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},P=n(66743),E=n(9957),O=P.call(Function.call,Array.prototype.concat),j=P.call(Function.apply,Array.prototype.splice),k=P.call(Function.call,String.prototype.replace),R=P.call(Function.call,String.prototype.slice),I=P.call(Function.call,RegExp.prototype.exec),$=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,C=/\\(\\)?/g,T=function(t,e){var n,r=t;if(E(A,r)&&(r="%"+(n=A[r])[0]+"%"),E(_,r)){var s=_[r];if(s===w&&(s=S(r)),void 0===s&&!e)throw new l("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:n,name:r,value:s}}throw new c("intrinsic "+t+" does not exist!")};t.exports=function(t,e){if("string"!=typeof t||0===t.length)throw new l("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof e)throw new l('"allowMissing" argument must be a boolean');if(null===I(/^%?[^%]*%?$/,t))throw new c("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=function(t){var e=R(t,0,1),n=R(t,-1);if("%"===e&&"%"!==n)throw new c("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==e)throw new c("invalid intrinsic syntax, expected opening `%`");var r=[];return k(t,$,(function(t,e,n,s){r[r.length]=n?k(s,C,"$1"):e||t})),r}(t),r=n.length>0?n[0]:"",s=T("%"+r+"%",e),o=s.name,i=s.value,a=!1,u=s.alias;u&&(r=u[0],j(n,O([0,1],u)));for(var f=1,h=!0;f<n.length;f+=1){var d=n[f],y=R(d,0,1),m=R(d,-1);if(('"'===y||"'"===y||"`"===y||'"'===m||"'"===m||"`"===m)&&y!==m)throw new c("property names with quotes must have matching quotes");if("constructor"!==d&&h||(a=!0),E(_,o="%"+(r+="."+d)+"%"))i=_[o];else if(null!=i){if(!(d in i)){if(!e)throw new l("base intrinsic for "+t+" exists, but the property is not available.");return}if(p&&f+1>=n.length){var g=p(i,d);i=(h=!!g)&&"get"in g&&!("originalValue"in g.get)?g.get:i[d]}else h=E(i,d),i=i[d];h&&!a&&(_[o]=i)}}return i}},75795:function(t,e,n){"use strict";var r=n(70453)("%Object.getOwnPropertyDescriptor%",!0);if(r)try{r([],"length")}catch(t){r=null}t.exports=r},30592:function(t,e,n){"use strict";var r=n(30655),s=function(){return!!r};s.hasArrayLengthDefineBug=function(){if(!r)return null;try{return 1!==r([],"length",{value:1}).length}catch(t){return!0}},t.exports=s},80024:function(t){"use strict";var e={__proto__:null,foo:{}},n=Object;t.exports=function(){return{__proto__:e}.foo===e.foo&&!(e instanceof n)}},64039:function(t,e,n){"use strict";var r="undefined"!=typeof Symbol&&Symbol,s=n(41333);t.exports=function(){return"function"==typeof r&&"function"==typeof Symbol&&"symbol"==typeof r("foo")&&"symbol"==typeof Symbol("bar")&&s()}},41333:function(t){"use strict";t.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),n=Object(e);if("string"==typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(e in t[e]=42,t)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var r=Object.getOwnPropertySymbols(t);if(1!==r.length||r[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var s=Object.getOwnPropertyDescriptor(t,e);if(42!==s.value||!0!==s.enumerable)return!1}return!0}},9957:function(t,e,n){"use strict";var r=Function.prototype.call,s=Object.prototype.hasOwnProperty,o=n(66743);t.exports=o.call(r,s)},14385:function(t){"use strict";t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),e.hash&&(t+=e.hash),e.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(t)?'"'.concat(t,'"'):t):t}},58859:function(t,e,n){var r="function"==typeof Map&&Map.prototype,s=Object.getOwnPropertyDescriptor&&r?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,o=r&&s&&"function"==typeof s.get?s.get:null,i=r&&Map.prototype.forEach,a="function"==typeof Set&&Set.prototype,c=Object.getOwnPropertyDescriptor&&a?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,l=a&&c&&"function"==typeof c.get?c.get:null,u=a&&Set.prototype.forEach,f="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,h="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,p="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,d=Boolean.prototype.valueOf,y=Object.prototype.toString,m=Function.prototype.toString,g=String.prototype.match,b=String.prototype.slice,w=String.prototype.replace,v=String.prototype.toUpperCase,_=String.prototype.toLowerCase,x=RegExp.prototype.test,S=Array.prototype.concat,A=Array.prototype.join,P=Array.prototype.slice,E=Math.floor,O="function"==typeof BigInt?BigInt.prototype.valueOf:null,j=Object.getOwnPropertySymbols,k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,R="function"==typeof Symbol&&"object"==typeof Symbol.iterator,I="function"==typeof Symbol&&Symbol.toStringTag&&(Symbol.toStringTag,1)?Symbol.toStringTag:null,$=Object.prototype.propertyIsEnumerable,C=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function T(t,e){if(t===1/0||t===-1/0||t!=t||t&&t>-1e3&&t<1e3||x.call(/e/,e))return e;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof t){var r=t<0?-E(-t):E(t);if(r!==t){var s=String(r),o=b.call(e,s.length+1);return w.call(s,n,"$&_")+"."+w.call(w.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return w.call(e,n,"$&_")}var M=n(42634),N=M.custom,F=U(N)?N:null;function B(t,e,n){var r="double"===(n.quoteStyle||e)?'"':"'";return r+t+r}function L(t){return w.call(String(t),/"/g,"&quot;")}function W(t){return!("[object Array]"!==H(t)||I&&"object"==typeof t&&I in t)}function D(t){return!("[object RegExp]"!==H(t)||I&&"object"==typeof t&&I in t)}function U(t){if(R)return t&&"object"==typeof t&&t instanceof Symbol;if("symbol"==typeof t)return!0;if(!t||"object"!=typeof t||!k)return!1;try{return k.call(t),!0}catch(t){}return!1}t.exports=function t(e,r,s,a){var c=r||{};if(J(c,"quoteStyle")&&"single"!==c.quoteStyle&&"double"!==c.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(J(c,"maxStringLength")&&("number"==typeof c.maxStringLength?c.maxStringLength<0&&c.maxStringLength!==1/0:null!==c.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var y=!J(c,"customInspect")||c.customInspect;if("boolean"!=typeof y&&"symbol"!==y)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(J(c,"indent")&&null!==c.indent&&"\t"!==c.indent&&!(parseInt(c.indent,10)===c.indent&&c.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(J(c,"numericSeparator")&&"boolean"!=typeof c.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var v=c.numericSeparator;if(void 0===e)return"undefined";if(null===e)return"null";if("boolean"==typeof e)return e?"true":"false";if("string"==typeof e)return V(e,c);if("number"==typeof e){if(0===e)return 1/0/e>0?"0":"-0";var x=String(e);return v?T(e,x):x}if("bigint"==typeof e){var E=String(e)+"n";return v?T(e,E):E}var j=void 0===c.depth?5:c.depth;if(void 0===s&&(s=0),s>=j&&j>0&&"object"==typeof e)return W(e)?"[Array]":"[Object]";var N,q=function(t,e){var n;if("\t"===t.indent)n="\t";else{if(!("number"==typeof t.indent&&t.indent>0))return null;n=A.call(Array(t.indent+1)," ")}return{base:n,prev:A.call(Array(e+1),n)}}(c,s);if(void 0===a)a=[];else if(X(a,e)>=0)return"[Circular]";function G(e,n,r){if(n&&(a=P.call(a)).push(n),r){var o={depth:c.depth};return J(c,"quoteStyle")&&(o.quoteStyle=c.quoteStyle),t(e,o,s+1,a)}return t(e,c,s+1,a)}if("function"==typeof e&&!D(e)){var tt=function(t){if(t.name)return t.name;var e=g.call(m.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}(e),et=Z(e,G);return"[Function"+(tt?": "+tt:" (anonymous)")+"]"+(et.length>0?" { "+A.call(et,", ")+" }":"")}if(U(e)){var nt=R?w.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):k.call(e);return"object"!=typeof e||R?nt:K(nt)}if((N=e)&&"object"==typeof N&&("undefined"!=typeof HTMLElement&&N instanceof HTMLElement||"string"==typeof N.nodeName&&"function"==typeof N.getAttribute)){for(var rt="<"+_.call(String(e.nodeName)),st=e.attributes||[],ot=0;ot<st.length;ot++)rt+=" "+st[ot].name+"="+B(L(st[ot].value),"double",c);return rt+=">",e.childNodes&&e.childNodes.length&&(rt+="..."),rt+"</"+_.call(String(e.nodeName))+">"}if(W(e)){if(0===e.length)return"[]";var it=Z(e,G);return q&&!function(t){for(var e=0;e<t.length;e++)if(X(t[e],"\n")>=0)return!1;return!0}(it)?"["+Y(it,q)+"]":"[ "+A.call(it,", ")+" ]"}if(function(t){return!("[object Error]"!==H(t)||I&&"object"==typeof t&&I in t)}(e)){var at=Z(e,G);return"cause"in Error.prototype||!("cause"in e)||$.call(e,"cause")?0===at.length?"["+String(e)+"]":"{ ["+String(e)+"] "+A.call(at,", ")+" }":"{ ["+String(e)+"] "+A.call(S.call("[cause]: "+G(e.cause),at),", ")+" }"}if("object"==typeof e&&y){if(F&&"function"==typeof e[F]&&M)return M(e,{depth:j-s});if("symbol"!==y&&"function"==typeof e.inspect)return e.inspect()}if(function(t){if(!o||!t||"object"!=typeof t)return!1;try{o.call(t);try{l.call(t)}catch(t){return!0}return t instanceof Map}catch(t){}return!1}(e)){var ct=[];return i&&i.call(e,(function(t,n){ct.push(G(n,e,!0)+" => "+G(t,e))})),Q("Map",o.call(e),ct,q)}if(function(t){if(!l||!t||"object"!=typeof t)return!1;try{l.call(t);try{o.call(t)}catch(t){return!0}return t instanceof Set}catch(t){}return!1}(e)){var lt=[];return u&&u.call(e,(function(t){lt.push(G(t,e))})),Q("Set",l.call(e),lt,q)}if(function(t){if(!f||!t||"object"!=typeof t)return!1;try{f.call(t,f);try{h.call(t,h)}catch(t){return!0}return t instanceof WeakMap}catch(t){}return!1}(e))return z("WeakMap");if(function(t){if(!h||!t||"object"!=typeof t)return!1;try{h.call(t,h);try{f.call(t,f)}catch(t){return!0}return t instanceof WeakSet}catch(t){}return!1}(e))return z("WeakSet");if(function(t){if(!p||!t||"object"!=typeof t)return!1;try{return p.call(t),!0}catch(t){}return!1}(e))return z("WeakRef");if(function(t){return!("[object Number]"!==H(t)||I&&"object"==typeof t&&I in t)}(e))return K(G(Number(e)));if(function(t){if(!t||"object"!=typeof t||!O)return!1;try{return O.call(t),!0}catch(t){}return!1}(e))return K(G(O.call(e)));if(function(t){return!("[object Boolean]"!==H(t)||I&&"object"==typeof t&&I in t)}(e))return K(d.call(e));if(function(t){return!("[object String]"!==H(t)||I&&"object"==typeof t&&I in t)}(e))return K(G(String(e)));if("undefined"!=typeof window&&e===window)return"{ [object Window] }";if(e===n.g)return"{ [object globalThis] }";if(!function(t){return!("[object Date]"!==H(t)||I&&"object"==typeof t&&I in t)}(e)&&!D(e)){var ut=Z(e,G),ft=C?C(e)===Object.prototype:e instanceof Object||e.constructor===Object,ht=e instanceof Object?"":"null prototype",pt=!ft&&I&&Object(e)===e&&I in e?b.call(H(e),8,-1):ht?"Object":"",dt=(ft||"function"!=typeof e.constructor?"":e.constructor.name?e.constructor.name+" ":"")+(pt||ht?"["+A.call(S.call([],pt||[],ht||[]),": ")+"] ":"");return 0===ut.length?dt+"{}":q?dt+"{"+Y(ut,q)+"}":dt+"{ "+A.call(ut,", ")+" }"}return String(e)};var q=Object.prototype.hasOwnProperty||function(t){return t in this};function J(t,e){return q.call(t,e)}function H(t){return y.call(t)}function X(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}function V(t,e){if(t.length>e.maxStringLength){var n=t.length-e.maxStringLength,r="... "+n+" more character"+(n>1?"s":"");return V(b.call(t,0,e.maxStringLength),e)+r}return B(w.call(w.call(t,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,G),"single",e)}function G(t){var e=t.charCodeAt(0),n={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return n?"\\"+n:"\\x"+(e<16?"0":"")+v.call(e.toString(16))}function K(t){return"Object("+t+")"}function z(t){return t+" { ? }"}function Q(t,e,n,r){return t+" ("+e+") {"+(r?Y(n,r):A.call(n,", "))+"}"}function Y(t,e){if(0===t.length)return"";var n="\n"+e.prev+e.base;return n+A.call(t,","+n)+"\n"+e.prev}function Z(t,e){var n=W(t),r=[];if(n){r.length=t.length;for(var s=0;s<t.length;s++)r[s]=J(t,s)?e(t[s],t):""}var o,i="function"==typeof j?j(t):[];if(R){o={};for(var a=0;a<i.length;a++)o["$"+i[a]]=i[a]}for(var c in t)J(t,c)&&(n&&String(Number(c))===c&&c<t.length||R&&o["$"+c]instanceof Symbol||(x.call(/[^\w$]/,c)?r.push(e(c,t)+": "+e(t[c],t)):r.push(c+": "+e(t[c],t))));if("function"==typeof j)for(var l=0;l<i.length;l++)$.call(t,i[l])&&r.push("["+e(i[l])+"]: "+e(t[i[l]],t));return r}},74765:function(t){"use strict";var e=String.prototype.replace,n=/%20/g,r="RFC3986";t.exports={default:r,formatters:{RFC1738:function(t){return e.call(t,n,"+")},RFC3986:function(t){return String(t)}},RFC1738:"RFC1738",RFC3986:r}},55373:function(t,e,n){"use strict";var r=n(98636),s=n(62642),o=n(74765);t.exports={formats:o,parse:s,stringify:r}},62642:function(t,e,n){"use strict";var r=n(37720),s=Object.prototype.hasOwnProperty,o=Array.isArray,i={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:r.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},a=function(t){return t.replace(/&#(\d+);/g,(function(t,e){return String.fromCharCode(parseInt(e,10))}))},c=function(t,e){return t&&"string"==typeof t&&e.comma&&t.indexOf(",")>-1?t.split(","):t},l=function(t,e,n,r){if(t){var o=n.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,i=/(\[[^[\]]*])/g,a=n.depth>0&&/(\[[^[\]]*])/.exec(o),l=a?o.slice(0,a.index):o,u=[];if(l){if(!n.plainObjects&&s.call(Object.prototype,l)&&!n.allowPrototypes)return;u.push(l)}for(var f=0;n.depth>0&&null!==(a=i.exec(o))&&f<n.depth;){if(f+=1,!n.plainObjects&&s.call(Object.prototype,a[1].slice(1,-1))&&!n.allowPrototypes)return;u.push(a[1])}return a&&u.push("["+o.slice(a.index)+"]"),function(t,e,n,r){for(var s=r?e:c(e,n),o=t.length-1;o>=0;--o){var i,a=t[o];if("[]"===a&&n.parseArrays)i=[].concat(s);else{i=n.plainObjects?Object.create(null):{};var l="["===a.charAt(0)&&"]"===a.charAt(a.length-1)?a.slice(1,-1):a,u=parseInt(l,10);n.parseArrays||""!==l?!isNaN(u)&&a!==l&&String(u)===l&&u>=0&&n.parseArrays&&u<=n.arrayLimit?(i=[])[u]=s:"__proto__"!==l&&(i[l]=s):i={0:s}}s=i}return s}(u,e,n,r)}};t.exports=function(t,e){var n=function(t){if(!t)return i;if(null!==t.decoder&&void 0!==t.decoder&&"function"!=typeof t.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var e=void 0===t.charset?i.charset:t.charset;return{allowDots:void 0===t.allowDots?i.allowDots:!!t.allowDots,allowPrototypes:"boolean"==typeof t.allowPrototypes?t.allowPrototypes:i.allowPrototypes,allowSparse:"boolean"==typeof t.allowSparse?t.allowSparse:i.allowSparse,arrayLimit:"number"==typeof t.arrayLimit?t.arrayLimit:i.arrayLimit,charset:e,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:i.charsetSentinel,comma:"boolean"==typeof t.comma?t.comma:i.comma,decoder:"function"==typeof t.decoder?t.decoder:i.decoder,delimiter:"string"==typeof t.delimiter||r.isRegExp(t.delimiter)?t.delimiter:i.delimiter,depth:"number"==typeof t.depth||!1===t.depth?+t.depth:i.depth,ignoreQueryPrefix:!0===t.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof t.interpretNumericEntities?t.interpretNumericEntities:i.interpretNumericEntities,parameterLimit:"number"==typeof t.parameterLimit?t.parameterLimit:i.parameterLimit,parseArrays:!1!==t.parseArrays,plainObjects:"boolean"==typeof t.plainObjects?t.plainObjects:i.plainObjects,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:i.strictNullHandling}}(e);if(""===t||null==t)return n.plainObjects?Object.create(null):{};for(var u="string"==typeof t?function(t,e){var n,l={},u=e.ignoreQueryPrefix?t.replace(/^\?/,""):t,f=e.parameterLimit===1/0?void 0:e.parameterLimit,h=u.split(e.delimiter,f),p=-1,d=e.charset;if(e.charsetSentinel)for(n=0;n<h.length;++n)0===h[n].indexOf("utf8=")&&("utf8=%E2%9C%93"===h[n]?d="utf-8":"utf8=%26%2310003%3B"===h[n]&&(d="iso-8859-1"),p=n,n=h.length);for(n=0;n<h.length;++n)if(n!==p){var y,m,g=h[n],b=g.indexOf("]="),w=-1===b?g.indexOf("="):b+1;-1===w?(y=e.decoder(g,i.decoder,d,"key"),m=e.strictNullHandling?null:""):(y=e.decoder(g.slice(0,w),i.decoder,d,"key"),m=r.maybeMap(c(g.slice(w+1),e),(function(t){return e.decoder(t,i.decoder,d,"value")}))),m&&e.interpretNumericEntities&&"iso-8859-1"===d&&(m=a(m)),g.indexOf("[]=")>-1&&(m=o(m)?[m]:m),s.call(l,y)?l[y]=r.combine(l[y],m):l[y]=m}return l}(t,n):t,f=n.plainObjects?Object.create(null):{},h=Object.keys(u),p=0;p<h.length;++p){var d=h[p],y=l(d,u[d],n,"string"==typeof t);f=r.merge(f,y,n)}return!0===n.allowSparse?f:r.compact(f)}},98636:function(t,e,n){"use strict";var r=n(920),s=n(37720),o=n(74765),i=Object.prototype.hasOwnProperty,a={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},c=Array.isArray,l=String.prototype.split,u=Array.prototype.push,f=function(t,e){u.apply(t,c(e)?e:[e])},h=Date.prototype.toISOString,p=o.default,d={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:s.encode,encodeValuesOnly:!1,format:p,formatter:o.formatters[p],indices:!1,serializeDate:function(t){return h.call(t)},skipNulls:!1,strictNullHandling:!1},y={},m=function t(e,n,o,i,a,u,h,p,m,g,b,w,v,_,x,S){for(var A,P=e,E=S,O=0,j=!1;void 0!==(E=E.get(y))&&!j;){var k=E.get(e);if(O+=1,void 0!==k){if(k===O)throw new RangeError("Cyclic object value");j=!0}void 0===E.get(y)&&(O=0)}if("function"==typeof p?P=p(n,P):P instanceof Date?P=b(P):"comma"===o&&c(P)&&(P=s.maybeMap(P,(function(t){return t instanceof Date?b(t):t}))),null===P){if(a)return h&&!_?h(n,d.encoder,x,"key",w):n;P=""}if("string"==typeof(A=P)||"number"==typeof A||"boolean"==typeof A||"symbol"==typeof A||"bigint"==typeof A||s.isBuffer(P)){if(h){var R=_?n:h(n,d.encoder,x,"key",w);if("comma"===o&&_){for(var I=l.call(String(P),","),$="",C=0;C<I.length;++C)$+=(0===C?"":",")+v(h(I[C],d.encoder,x,"value",w));return[v(R)+(i&&c(P)&&1===I.length?"[]":"")+"="+$]}return[v(R)+"="+v(h(P,d.encoder,x,"value",w))]}return[v(n)+"="+v(String(P))]}var T,M=[];if(void 0===P)return M;if("comma"===o&&c(P))T=[{value:P.length>0?P.join(",")||null:void 0}];else if(c(p))T=p;else{var N=Object.keys(P);T=m?N.sort(m):N}for(var F=i&&c(P)&&1===P.length?n+"[]":n,B=0;B<T.length;++B){var L=T[B],W="object"==typeof L&&void 0!==L.value?L.value:P[L];if(!u||null!==W){var D=c(P)?"function"==typeof o?o(F,L):F:F+(g?"."+L:"["+L+"]");S.set(e,O);var U=r();U.set(y,S),f(M,t(W,D,o,i,a,u,h,p,m,g,b,w,v,_,x,U))}}return M};t.exports=function(t,e){var n,s=t,l=function(t){if(!t)return d;if(null!==t.encoder&&void 0!==t.encoder&&"function"!=typeof t.encoder)throw new TypeError("Encoder has to be a function.");var e=t.charset||d.charset;if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=o.default;if(void 0!==t.format){if(!i.call(o.formatters,t.format))throw new TypeError("Unknown format option provided.");n=t.format}var r=o.formatters[n],s=d.filter;return("function"==typeof t.filter||c(t.filter))&&(s=t.filter),{addQueryPrefix:"boolean"==typeof t.addQueryPrefix?t.addQueryPrefix:d.addQueryPrefix,allowDots:void 0===t.allowDots?d.allowDots:!!t.allowDots,charset:e,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:d.charsetSentinel,delimiter:void 0===t.delimiter?d.delimiter:t.delimiter,encode:"boolean"==typeof t.encode?t.encode:d.encode,encoder:"function"==typeof t.encoder?t.encoder:d.encoder,encodeValuesOnly:"boolean"==typeof t.encodeValuesOnly?t.encodeValuesOnly:d.encodeValuesOnly,filter:s,format:n,formatter:r,serializeDate:"function"==typeof t.serializeDate?t.serializeDate:d.serializeDate,skipNulls:"boolean"==typeof t.skipNulls?t.skipNulls:d.skipNulls,sort:"function"==typeof t.sort?t.sort:null,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:d.strictNullHandling}}(e);"function"==typeof l.filter?s=(0,l.filter)("",s):c(l.filter)&&(n=l.filter);var u,h=[];if("object"!=typeof s||null===s)return"";u=e&&e.arrayFormat in a?e.arrayFormat:e&&"indices"in e?e.indices?"indices":"repeat":"indices";var p=a[u];if(e&&"commaRoundTrip"in e&&"boolean"!=typeof e.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var y="comma"===p&&e&&e.commaRoundTrip;n||(n=Object.keys(s)),l.sort&&n.sort(l.sort);for(var g=r(),b=0;b<n.length;++b){var w=n[b];l.skipNulls&&null===s[w]||f(h,m(s[w],w,p,y,l.strictNullHandling,l.skipNulls,l.encode?l.encoder:null,l.filter,l.sort,l.allowDots,l.serializeDate,l.format,l.formatter,l.encodeValuesOnly,l.charset,g))}var v=h.join(l.delimiter),_=!0===l.addQueryPrefix?"?":"";return l.charsetSentinel&&("iso-8859-1"===l.charset?_+="utf8=%26%2310003%3B&":_+="utf8=%E2%9C%93&"),v.length>0?_+v:""}},37720:function(t,e,n){"use strict";var r=n(74765),s=Object.prototype.hasOwnProperty,o=Array.isArray,i=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),a=function(t,e){for(var n=e&&e.plainObjects?Object.create(null):{},r=0;r<t.length;++r)void 0!==t[r]&&(n[r]=t[r]);return n};t.exports={arrayToObject:a,assign:function(t,e){return Object.keys(e).reduce((function(t,n){return t[n]=e[n],t}),t)},combine:function(t,e){return[].concat(t,e)},compact:function(t){for(var e=[{obj:{o:t},prop:"o"}],n=[],r=0;r<e.length;++r)for(var s=e[r],i=s.obj[s.prop],a=Object.keys(i),c=0;c<a.length;++c){var l=a[c],u=i[l];"object"==typeof u&&null!==u&&-1===n.indexOf(u)&&(e.push({obj:i,prop:l}),n.push(u))}return function(t){for(;t.length>1;){var e=t.pop(),n=e.obj[e.prop];if(o(n)){for(var r=[],s=0;s<n.length;++s)void 0!==n[s]&&r.push(n[s]);e.obj[e.prop]=r}}}(e),t},decode:function(t,e,n){var r=t.replace(/\+/g," ");if("iso-8859-1"===n)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(t){return r}},encode:function(t,e,n,s,o){if(0===t.length)return t;var a=t;if("symbol"==typeof t?a=Symbol.prototype.toString.call(t):"string"!=typeof t&&(a=String(t)),"iso-8859-1"===n)return escape(a).replace(/%u[0-9a-f]{4}/gi,(function(t){return"%26%23"+parseInt(t.slice(2),16)+"%3B"}));for(var c="",l=0;l<a.length;++l){var u=a.charCodeAt(l);45===u||46===u||95===u||126===u||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||o===r.RFC1738&&(40===u||41===u)?c+=a.charAt(l):u<128?c+=i[u]:u<2048?c+=i[192|u>>6]+i[128|63&u]:u<55296||u>=57344?c+=i[224|u>>12]+i[128|u>>6&63]+i[128|63&u]:(l+=1,u=65536+((1023&u)<<10|1023&a.charCodeAt(l)),c+=i[240|u>>18]+i[128|u>>12&63]+i[128|u>>6&63]+i[128|63&u])}return c},isBuffer:function(t){return!(!t||"object"!=typeof t||!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t)))},isRegExp:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},maybeMap:function(t,e){if(o(t)){for(var n=[],r=0;r<t.length;r+=1)n.push(e(t[r]));return n}return e(t)},merge:function t(e,n,r){if(!n)return e;if("object"!=typeof n){if(o(e))e.push(n);else{if(!e||"object"!=typeof e)return[e,n];(r&&(r.plainObjects||r.allowPrototypes)||!s.call(Object.prototype,n))&&(e[n]=!0)}return e}if(!e||"object"!=typeof e)return[e].concat(n);var i=e;return o(e)&&!o(n)&&(i=a(e,r)),o(e)&&o(n)?(n.forEach((function(n,o){if(s.call(e,o)){var i=e[o];i&&"object"==typeof i&&n&&"object"==typeof n?e[o]=t(i,n,r):e.push(n)}else e[o]=n})),e):Object.keys(n).reduce((function(e,o){var i=n[o];return s.call(e,o)?e[o]=t(e[o],i,r):e[o]=i,e}),i)}}},96897:function(t,e,n){"use strict";var r=n(70453),s=n(30041),o=n(30592)(),i=n(75795),a=n(69675),c=r("%Math.floor%");t.exports=function(t,e){if("function"!=typeof t)throw new a("`fn` is not a function");if("number"!=typeof e||e<0||e>4294967295||c(e)!==e)throw new a("`length` must be a positive 32-bit integer");var n=arguments.length>2&&!!arguments[2],r=!0,l=!0;if("length"in t&&i){var u=i(t,"length");u&&!u.configurable&&(r=!1),u&&!u.writable&&(l=!1)}return(r||l||!n)&&(o?s(t,"length",e,!0,!0):s(t,"length",e)),t}},920:function(t,e,n){"use strict";var r=n(70453),s=n(38075),o=n(58859),i=n(69675),a=r("%WeakMap%",!0),c=r("%Map%",!0),l=s("WeakMap.prototype.get",!0),u=s("WeakMap.prototype.set",!0),f=s("WeakMap.prototype.has",!0),h=s("Map.prototype.get",!0),p=s("Map.prototype.set",!0),d=s("Map.prototype.has",!0),y=function(t,e){for(var n,r=t;null!==(n=r.next);r=n)if(n.key===e)return r.next=n.next,n.next=t.next,t.next=n,n};t.exports=function(){var t,e,n,r={assert:function(t){if(!r.has(t))throw new i("Side channel does not contain "+o(t))},get:function(r){if(a&&r&&("object"==typeof r||"function"==typeof r)){if(t)return l(t,r)}else if(c){if(e)return h(e,r)}else if(n)return function(t,e){var n=y(t,e);return n&&n.value}(n,r)},has:function(r){if(a&&r&&("object"==typeof r||"function"==typeof r)){if(t)return f(t,r)}else if(c){if(e)return d(e,r)}else if(n)return function(t,e){return!!y(t,e)}(n,r);return!1},set:function(r,s){a&&r&&("object"==typeof r||"function"==typeof r)?(t||(t=new a),u(t,r,s)):c?(e||(e=new c),p(e,r,s)):(n||(n={key:{},next:null}),function(t,e,n){var r=y(t,e);r?r.value=n:t.next={key:e,next:t.next,value:n}}(n,r,s))}};return r}},58394:function(t,e,n){"use strict";t.exports=n.p+"f82dd42b3f932dd1d62e.css"},42634:function(){}},e={};function n(r){var s=e[r];if(void 0!==s)return s.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}n.m=t,n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},function(){var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var s=r.length-1;s>-1&&(!t||!/^http(s?):/.test(t));)t=r[s--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t}(),n.b=document.baseURI||self.location.href,function(){"use strict";var t={};n.r(t),n.d(t,{xX:function(){return lt},qA:function(){return ut},LG:function(){return at},cH:function(){return ct},v3:function(){return ht},v7:function(){return ft},fK:function(){return yt},pf:function(){return vt},PO:function(){return bt},k5:function(){return wt},m_:function(){return dt},vc:function(){return it},Ll:function(){return pt},OE:function(){return gt},Is:function(){return mt}});const e="4.61.0";let r,s,o,i,a,c,l,u,f,h=!1,p=null,d=null,y=null,m=null;class g{constructor(t){this.body=t}get[Symbol.toStringTag](){return"MultipartBody"}}r||function(t,e={auto:!1}){if(h)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(r)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${r}'\``);h=e.auto,r=t.kind,s=t.fetch,p=t.Request,d=t.Response,y=t.Headers,o=t.FormData,m=t.Blob,i=t.File,a=t.ReadableStream,c=t.getMultipartRequestOptions,l=t.getDefaultAgent,u=t.fileFromPath,f=t.isFsReadStream}(function({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,s,o;try{n=fetch,r=Request,s=Response,o=Headers}catch(t){throw new Error(`this environment is missing the following Web Fetch API type: ${t.message}. ${e}`)}return{kind:"web",fetch:n,Request:r,Response:s,Headers:o,FormData:"undefined"!=typeof FormData?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:"undefined"!=typeof Blob?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:"undefined"!=typeof File?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:"undefined"!=typeof ReadableStream?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(t,e)=>({...e,body:new g(t)}),getDefaultAgent:t=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:t=>!1}}(),{auto:!0});class b{constructor(t,e){this.iterator=t,this.controller=e}static fromSSEResponse(t,e){let n=!1;return new b((async function*(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let r=!1;try{for await(const n of async function*(t,e){if(!t.body)throw e.abort(),new it("Attempted to iterate over a response with no body");const n=new v,r=new _,s=x(t.body);for await(const t of async function*(t){let e=new Uint8Array;for await(const n of t){if(null==n)continue;const t=n instanceof ArrayBuffer?new Uint8Array(n):"string"==typeof n?(new TextEncoder).encode(n):n;let r,s=new Uint8Array(e.length+t.length);for(s.set(e),s.set(t,e.length),e=s;-1!==(r=w(e));)yield e.slice(0,r),e=e.slice(r)}e.length>0&&(yield e)}(s))for(const e of r.decode(t)){const t=n.decode(e);t&&(yield t)}for(const t of r.flush()){const e=n.decode(t);e&&(yield e)}}(t,e))if(!r)if(n.data.startsWith("[DONE]"))r=!0;else if(null===n.event){let t;try{t=JSON.parse(n.data)}catch(t){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),t}if(t&&t.error)throw new at(void 0,t.error,void 0,void 0);yield t}else{let t;try{t=JSON.parse(n.data)}catch(t){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),t}if("error"==n.event)throw new at(void 0,t.error,t.message,void 0);yield{event:n.event,data:t}}r=!0}catch(t){if(t instanceof Error&&"AbortError"===t.name)return;throw t}finally{r||e.abort()}}),e)}static fromReadableStream(t,e){let n=!1;return new b((async function*(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let r=!1;try{for await(const e of async function*(){const e=new _,n=x(t);for await(const t of n)for(const n of e.decode(t))yield n;for(const t of e.flush())yield t}())r||e&&(yield JSON.parse(e));r=!0}catch(t){if(t instanceof Error&&"AbortError"===t.name)return;throw t}finally{r||e.abort()}}),e)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],e=[],n=this.iterator(),r=r=>({next:()=>{if(0===r.length){const r=n.next();t.push(r),e.push(r)}return r.shift()}});return[new b((()=>r(t)),this.controller),new b((()=>r(e)),this.controller)]}toReadableStream(){const t=this;let e;const n=new TextEncoder;return new a({async start(){e=t[Symbol.asyncIterator]()},async pull(t){try{const{value:r,done:s}=await e.next();if(s)return t.close();const o=n.encode(JSON.stringify(r)+"\n");t.enqueue(o)}catch(e){t.error(e)}},async cancel(){await(e.return?.())}})}}function w(t){for(let e=0;e<t.length-2;e++){if(10===t[e]&&10===t[e+1])return e+2;if(13===t[e]&&13===t[e+1])return e+2;if(13===t[e]&&10===t[e+1]&&e+3<t.length&&13===t[e+2]&&10===t[e+3])return e+4}return-1}class v{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const t={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],t}if(this.chunks.push(t),t.startsWith(":"))return null;let[e,n,r]=function(t,e){const n=t.indexOf(":");return-1!==n?[t.substring(0,n),":",t.substring(n+1)]:[t,"",""]}(t);return r.startsWith(" ")&&(r=r.substring(1)),"event"===e?this.event=r:"data"===e&&this.data.push(r),null}}class _{constructor(){this.buffer=[],this.trailingCR=!1}decode(t){let e=this.decodeText(t);if(this.trailingCR&&(e="\r"+e,this.trailingCR=!1),e.endsWith("\r")&&(this.trailingCR=!0,e=e.slice(0,-1)),!e)return[];const n=_.NEWLINE_CHARS.has(e[e.length-1]||"");let r=e.split(_.NEWLINE_REGEXP);return n&&r.pop(),1!==r.length||n?(this.buffer.length>0&&(r=[this.buffer.join("")+r[0],...r.slice(1)],this.buffer=[]),n||(this.buffer=[r.pop()||""]),r):(this.buffer.push(r[0]),[])}decodeText(t){if(null==t)return"";if("string"==typeof t)return t;if("undefined"!=typeof Buffer){if(t instanceof Buffer)return t.toString();if(t instanceof Uint8Array)return Buffer.from(t).toString();throw new it(`Unexpected: received non-Uint8Array (${t.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"!=typeof TextDecoder){if(t instanceof Uint8Array||t instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(t);throw new it(`Unexpected: received non-Uint8Array/ArrayBuffer (${t.constructor.name}) in a web platform. Please report this error.`)}throw new it("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const t=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,t}}function x(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const t=await e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}_.NEWLINE_CHARS=new Set(["\n","\r"]),_.NEWLINE_REGEXP=/\r\n|[\n\r]/g;const S=t=>null!=t&&"object"==typeof t&&"string"==typeof t.url&&"function"==typeof t.blob,A=t=>null!=t&&"object"==typeof t&&"string"==typeof t.name&&"number"==typeof t.lastModified&&P(t),P=t=>null!=t&&"object"==typeof t&&"number"==typeof t.size&&"string"==typeof t.type&&"function"==typeof t.text&&"function"==typeof t.slice&&"function"==typeof t.arrayBuffer;async function E(t,e,n){if(t=await t,A(t))return t;if(S(t)){const r=await t.blob();e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file");const s=P(r)?[await r.arrayBuffer()]:[r];return new i(s,e,n)}const r=await async function(t){let e=[];if("string"==typeof t||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(P(t))e.push(await t.arrayBuffer());else{if(!j(t))throw new Error(`Unexpected data type: ${typeof t}; constructor: ${t?.constructor?.name}; props: ${function(t){return`[${Object.getOwnPropertyNames(t).map((t=>`"${t}"`)).join(", ")}]`}(t)}`);for await(const n of t)e.push(n)}return e}(t);if(e||(e=function(t){return O(t.name)||O(t.filename)||O(t.path)?.split(/[\\/]/).pop()}(t)??"unknown_file"),!n?.type){const t=r[0]?.type;"string"==typeof t&&(n={...n,type:t})}return new i(r,e,n)}const O=t=>"string"==typeof t?t:"undefined"!=typeof Buffer&&t instanceof Buffer?String(t):void 0,j=t=>null!=t&&"object"==typeof t&&"function"==typeof t[Symbol.asyncIterator],k=t=>t&&"object"==typeof t&&t.body&&"MultipartBody"===t[Symbol.toStringTag],R=async t=>{const e=await I(t.body);return c(e,t)},I=async t=>{const e=new o;return await Promise.all(Object.entries(t||{}).map((([t,n])=>C(e,t,n)))),e},C=async(t,e,n)=>{if(void 0!==n){if(null==n)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)t.append(e,String(n));else if((t=>A(t)||S(t)||f(t))(n)){const r=await E(n);t.append(e,r)}else if(Array.isArray(n))await Promise.all(n.map((n=>C(t,e+"[]",n))));else{if("object"!=typeof n)throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`);await Promise.all(Object.entries(n).map((([n,r])=>C(t,`${e}[${n}]`,r))))}}};var T;async function M(t){const{response:e}=t;if(t.options.stream)return rt("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):b.fromSSEResponse(e,t.controller);if(204===e.status)return null;if(t.options.__binaryResponse)return e;const n=e.headers.get("content-type");if(n?.includes("application/json")||n?.includes("application/vnd.api+json")){const t=await e.json();return rt("response",e.status,e.url,e.headers,t),t}const r=await e.text();return rt("response",e.status,e.url,e.headers,r),r}class N extends Promise{constructor(t,e=M){super((t=>{t(null)})),this.responsePromise=t,this.parseResponse=e}_thenUnwrap(t){return new N(this.responsePromise,(async e=>t(await this.parseResponse(e))))}asResponse(){return this.responsePromise.then((t=>t.response))}async withResponse(){const[t,e]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:e}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(t,e){return this.parse().then(t,e)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}class F{constructor({baseURL:t,maxRetries:e=2,timeout:n=6e5,httpAgent:r,fetch:o}){this.baseURL=t,this.maxRetries=Q("maxRetries",e),this.timeout=Q("timeout",n),this.httpAgent=r,this.fetch=o??s}authHeaders(t){return{}}defaultHeaders(t){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...X(),...this.authHeaders(t)}}validateHeaders(t,e){}defaultIdempotencyKey(){return`stainless-node-retry-${st()}`}get(t,e){return this.methodRequest("get",t,e)}post(t,e){return this.methodRequest("post",t,e)}patch(t,e){return this.methodRequest("patch",t,e)}put(t,e){return this.methodRequest("put",t,e)}delete(t,e){return this.methodRequest("delete",t,e)}methodRequest(t,e,n){return this.request(Promise.resolve(n).then((async n=>{const r=n&&P(n?.body)?new DataView(await n.body.arrayBuffer()):n?.body instanceof DataView?n.body:n?.body instanceof ArrayBuffer?new DataView(n.body):n&&ArrayBuffer.isView(n?.body)?new DataView(n.body.buffer):n?.body;return{method:t,path:e,...n,body:r}})))}getAPIList(t,e,n){return this.requestAPIList(e,{method:"get",path:t,...n})}calculateContentLength(t){if("string"==typeof t){if("undefined"!=typeof Buffer)return Buffer.byteLength(t,"utf8").toString();if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(t).length.toString()}else if(ArrayBuffer.isView(t))return t.byteLength.toString();return null}buildRequest(t){const{method:e,path:n,query:r,headers:s={}}=t,o=ArrayBuffer.isView(t.body)||t.__binaryRequest&&"string"==typeof t.body?t.body:k(t.body)?t.body.body:t.body?JSON.stringify(t.body,null,2):null,i=this.calculateContentLength(o),a=this.buildURL(n,r);"timeout"in t&&Q("timeout",t.timeout);const c=t.timeout??this.timeout,u=t.httpAgent??this.httpAgent??l(a),f=c+1e3;return"number"==typeof u?.options?.timeout&&f>(u.options.timeout??0)&&(u.options.timeout=f),this.idempotencyHeader&&"get"!==e&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=t.idempotencyKey),{req:{method:e,...o&&{body:o},headers:this.buildHeaders({options:t,headers:s,contentLength:i}),...u&&{agent:u},signal:t.signal??null},url:a,timeout:c}}buildHeaders({options:t,headers:e,contentLength:n}){const s={};return n&&(s["content-length"]=n),nt(s,this.defaultHeaders(t)),nt(s,e),k(t.body)&&"node"!==r&&delete s["content-type"],this.validateHeaders(s,e),s}async prepareOptions(t){}async prepareRequest(t,{url:e,options:n}){}parseHeaders(t){return t?Symbol.iterator in t?Object.fromEntries(Array.from(t).map((t=>[...t]))):{...t}:{}}makeStatusError(t,e,n,r){return at.generate(t,e,n,r)}request(t,e=null){return new N(this.makeRequest(t,e))}async makeRequest(t,e){const n=await t;null==e&&(e=n.maxRetries??this.maxRetries),await this.prepareOptions(n);const{req:r,url:s,timeout:o}=this.buildRequest(n);if(await this.prepareRequest(r,{url:s,options:n}),rt("request",s,n,r.headers),n.signal?.aborted)throw new ct;const i=new AbortController,a=await this.fetchWithTimeout(s,r,o,i).catch(Y);if(a instanceof Error){if(n.signal?.aborted)throw new ct;if(e)return this.retryRequest(n,e);if("AbortError"===a.name)throw new ut;throw new lt({cause:a})}const c=W(a.headers);if(!a.ok){if(e&&this.shouldRetry(a))return rt(`response (error; retrying, ${e} attempts remaining)`,a.status,s,c),this.retryRequest(n,e,c);const t=await a.text().catch((t=>Y(t).message)),r=V(t),o=r?void 0:t;throw rt(`response (error; ${e?"(error; no more retries left)":"(error; not retryable)"})`,a.status,s,c,o),this.makeStatusError(a.status,r,o,c)}return{response:a,options:n,controller:i}}requestAPIList(t,e){const n=this.makeRequest(e,null);return new L(this,n,t)}buildURL(t,e){const n=K(t)?new URL(t):new URL(this.baseURL+(this.baseURL.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),r=this.defaultQuery();return tt(r)||(e={...r,...e}),"object"==typeof e&&e&&!Array.isArray(e)&&(n.search=this.stringifyQuery(e)),n.toString()}stringifyQuery(t){return Object.entries(t).filter((([t,e])=>void 0!==e)).map((([t,e])=>{if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return`${encodeURIComponent(t)}=${encodeURIComponent(e)}`;if(null===e)return`${encodeURIComponent(t)}=`;throw new it(`Cannot stringify type ${typeof e}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)})).join("&")}async fetchWithTimeout(t,e,n,r){const{signal:s,...o}=e||{};s&&s.addEventListener("abort",(()=>r.abort()));const i=setTimeout((()=>r.abort()),n);return this.getRequestClient().fetch.call(void 0,t,{signal:r.signal,...o}).finally((()=>{clearTimeout(i)}))}getRequestClient(){return{fetch:this.fetch}}shouldRetry(t){const e=t.headers.get("x-should-retry");return"true"===e||"false"!==e&&(408===t.status||409===t.status||429===t.status||t.status>=500)}async retryRequest(t,e,n){let r;const s=n?.["retry-after-ms"];if(s){const t=parseFloat(s);Number.isNaN(t)||(r=t)}const o=n?.["retry-after"];if(o&&!r){const t=parseFloat(o);r=Number.isNaN(t)?Date.parse(o)-Date.now():1e3*t}if(!(r&&0<=r&&r<6e4)){const n=t.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(e,n)}return await z(r),this.makeRequest(t,e-1)}calculateDefaultRetryTimeoutMillis(t,e){const n=e-t;return Math.min(.5*Math.pow(2,n),8)*(1-.25*Math.random())*1e3}getUserAgent(){return`${this.constructor.name}/JS ${e}`}}class B{constructor(t,e,n,r){T.set(this,void 0),function(t,e,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===r?s.call(t,n):s?s.value=n:e.set(t,n)}(this,T,t,"f"),this.options=r,this.response=e,this.body=n}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageInfo()}async getNextPage(){const t=this.nextPageInfo();if(!t)throw new it("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const e={...this.options};if("params"in t&&"object"==typeof e.query)e.query={...e.query,...t.params};else if("url"in t){const n=[...Object.entries(e.query||{}),...t.url.searchParams.entries()];for(const[e,r]of n)t.url.searchParams.set(e,r);e.query=void 0,e.path=t.url.toString()}return await function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)}(this,T,"f").requestAPIList(this.constructor,e)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[(T=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const e of t.getPaginatedItems())yield e}}class L extends N{constructor(t,e,n){super(e,(async e=>new n(t,e.response,await M(e),e.options)))}async*[Symbol.asyncIterator](){const t=await(this);for await(const e of t)yield e}}const W=t=>new Proxy(Object.fromEntries(t.entries()),{get(t,e){const n=e.toString();return t[n.toLowerCase()]||t[n]}}),D={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},U=t=>"object"==typeof t&&null!==t&&!tt(t)&&Object.keys(t).every((t=>et(D,t))),q=t=>"x32"===t?"x32":"x86_64"===t||"x64"===t?"x64":"arm"===t?"arm":"aarch64"===t||"arm64"===t?"arm64":t?`other:${t}`:"unknown",J=t=>(t=t.toLowerCase()).includes("ios")?"iOS":"android"===t?"Android":"darwin"===t?"MacOS":"win32"===t?"Windows":"freebsd"===t?"FreeBSD":"openbsd"===t?"OpenBSD":"linux"===t?"Linux":t?`Other:${t}`:"Unknown";let H;const X=()=>H??(H=(()=>{if("undefined"!=typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e,"X-Stainless-OS":J(Deno.build.os),"X-Stainless-Arch":q(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if("[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e,"X-Stainless-OS":J(process.platform),"X-Stainless-Arch":q(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=function(){if("undefined"==typeof navigator||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const t=n.exec(navigator.userAgent);if(t)return{browser:e,version:`${t[1]||0}.${t[2]||0}.${t[3]||0}`}}return null}();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}})()),V=t=>{try{return JSON.parse(t)}catch(t){return}},G=new RegExp("^(?:[a-z]+:)?//","i"),K=t=>G.test(t),z=t=>new Promise((e=>setTimeout(e,t))),Q=(t,e)=>{if("number"!=typeof e||!Number.isInteger(e))throw new it(`${t} must be an integer`);if(e<0)throw new it(`${t} must be a positive integer`);return e},Y=t=>{if(t instanceof Error)return t;if("object"==typeof t&&null!==t)try{return new Error(JSON.stringify(t))}catch{}return new Error(t)},Z=t=>"undefined"!=typeof process?process.env?.[t]?.trim()??void 0:"undefined"!=typeof Deno?Deno.env?.get?.(t)?.trim():void 0;function tt(t){if(!t)return!0;for(const e in t)return!1;return!0}function et(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function nt(t,e){for(const n in e){if(!et(e,n))continue;const r=n.toLowerCase();if(!r)continue;const s=e[n];null===s?delete t[r]:void 0!==s&&(t[r]=s)}}function rt(t,...e){"undefined"!=typeof process&&"true"===process?.env?.DEBUG&&console.log(`OpenAI:DEBUG:${t}`,...e)}const st=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}));function ot(t){return null!=t&&"object"==typeof t&&!Array.isArray(t)}class it extends Error{}class at extends it{constructor(t,e,n,r){super(`${at.makeMessage(t,e,n)}`),this.status=t,this.headers=r,this.request_id=r?.["x-request-id"];const s=e;this.error=s,this.code=s?.code,this.param=s?.param,this.type=s?.type}static makeMessage(t,e,n){const r=e?.message?"string"==typeof e.message?e.message:JSON.stringify(e.message):e?JSON.stringify(e):n;return t&&r?`${t} ${r}`:t?`${t} status code (no body)`:r||"(no status code or body)"}static generate(t,e,n,r){if(!t)return new lt({message:n,cause:Y(e)});const s=e?.error;return 400===t?new ft(t,s,n,r):401===t?new ht(t,s,n,r):403===t?new pt(t,s,n,r):404===t?new dt(t,s,n,r):409===t?new yt(t,s,n,r):422===t?new mt(t,s,n,r):429===t?new gt(t,s,n,r):t>=500?new bt(t,s,n,r):new at(t,s,n,r)}}class ct extends at{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0),this.status=void 0}}class lt extends at{constructor({message:t,cause:e}){super(void 0,void 0,t||"Connection error.",void 0),this.status=void 0,e&&(this.cause=e)}}class ut extends lt{constructor({message:t}={}){super({message:t??"Request timed out."})}}class ft extends at{constructor(){super(...arguments),this.status=400}}class ht extends at{constructor(){super(...arguments),this.status=401}}class pt extends at{constructor(){super(...arguments),this.status=403}}class dt extends at{constructor(){super(...arguments),this.status=404}}class yt extends at{constructor(){super(...arguments),this.status=409}}class mt extends at{constructor(){super(...arguments),this.status=422}}class gt extends at{constructor(){super(...arguments),this.status=429}}class bt extends at{}class wt extends it{constructor(){super("Could not parse response content as the length limit was reached")}}class vt extends it{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var _t=n(55373);class xt extends B{constructor(t,e,n,r){super(t,e,n,r),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class St extends B{constructor(t,e,n,r){super(t,e,n,r),this.data=n.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const t=this.nextPageInfo();if(!t)return null;if("params"in t)return t.params;const e=Object.fromEntries(t.url.searchParams);return Object.keys(e).length?e:null}nextPageInfo(){const t=this.getPaginatedItems();if(!t.length)return null;const e=t[t.length-1]?.id;return e?{params:{after:e}}:null}}class At{constructor(t){this._client=t}}class Pt extends At{create(t,e){return this._client.post("/completions",{body:t,...e,stream:t.stream??!1})}}Pt||(Pt={});class Et extends At{create(t,e){return this._client.post("/chat/completions",{body:t,...e,stream:t.stream??!1})}}Et||(Et={});class Ot extends At{constructor(){super(...arguments),this.completions=new Et(this._client)}}!function(t){t.Completions=Et}(Ot||(Ot={}));class jt extends At{create(t,e){return this._client.post("/embeddings",{body:t,...e})}}jt||(jt={});class kt extends At{create(t,e){return this._client.post("/files",R({body:t,...e}))}retrieve(t,e){return this._client.get(`/files/${t}`,e)}list(t={},e){return U(t)?this.list({},t):this._client.getAPIList("/files",Rt,{query:t,...e})}del(t,e){return this._client.delete(`/files/${t}`,e)}content(t,e){return this._client.get(`/files/${t}/content`,{...e,__binaryResponse:!0})}retrieveContent(t,e){return this._client.get(`/files/${t}/content`,{...e,headers:{Accept:"application/json",...e?.headers}})}async waitForProcessing(t,{pollInterval:e=5e3,maxWait:n=18e5}={}){const r=new Set(["processed","error","deleted"]),s=Date.now();let o=await this.retrieve(t);for(;!o.status||!r.has(o.status);)if(await z(e),o=await this.retrieve(t),Date.now()-s>n)throw new ut({message:`Giving up on waiting for file ${t} to finish processing after ${n} milliseconds.`});return o}}class Rt extends xt{}!function(t){t.FileObjectsPage=Rt}(kt||(kt={}));class It extends At{createVariation(t,e){return this._client.post("/images/variations",R({body:t,...e}))}edit(t,e){return this._client.post("/images/edits",R({body:t,...e}))}generate(t,e){return this._client.post("/images/generations",{body:t,...e})}}It||(It={});class $t extends At{create(t,e){return this._client.post("/audio/speech",{body:t,...e,__binaryResponse:!0})}}$t||($t={});class Ct extends At{create(t,e){return this._client.post("/audio/transcriptions",R({body:t,...e}))}}Ct||(Ct={});class Tt extends At{create(t,e){return this._client.post("/audio/translations",R({body:t,...e}))}}Tt||(Tt={});class Mt extends At{constructor(){super(...arguments),this.transcriptions=new Ct(this._client),this.translations=new Tt(this._client),this.speech=new $t(this._client)}}!function(t){t.Transcriptions=Ct,t.Translations=Tt,t.Speech=$t}(Mt||(Mt={}));class Nt extends At{create(t,e){return this._client.post("/moderations",{body:t,...e})}}Nt||(Nt={});class Ft extends At{retrieve(t,e){return this._client.get(`/models/${t}`,e)}list(t){return this._client.getAPIList("/models",Bt,t)}del(t,e){return this._client.delete(`/models/${t}`,e)}}class Bt extends xt{}!function(t){t.ModelsPage=Bt}(Ft||(Ft={}));class Lt extends At{list(t,e={},n){return U(e)?this.list(t,{},e):this._client.getAPIList(`/fine_tuning/jobs/${t}/checkpoints`,Wt,{query:e,...n})}}class Wt extends St{}!function(t){t.FineTuningJobCheckpointsPage=Wt}(Lt||(Lt={}));class Dt extends At{constructor(){super(...arguments),this.checkpoints=new Lt(this._client)}create(t,e){return this._client.post("/fine_tuning/jobs",{body:t,...e})}retrieve(t,e){return this._client.get(`/fine_tuning/jobs/${t}`,e)}list(t={},e){return U(t)?this.list({},t):this._client.getAPIList("/fine_tuning/jobs",Ut,{query:t,...e})}cancel(t,e){return this._client.post(`/fine_tuning/jobs/${t}/cancel`,e)}listEvents(t,e={},n){return U(e)?this.listEvents(t,{},e):this._client.getAPIList(`/fine_tuning/jobs/${t}/events`,qt,{query:e,...n})}}class Ut extends St{}class qt extends St{}!function(t){t.FineTuningJobsPage=Ut,t.FineTuningJobEventsPage=qt,t.Checkpoints=Lt,t.FineTuningJobCheckpointsPage=Wt}(Dt||(Dt={}));class Jt extends At{constructor(){super(...arguments),this.jobs=new Dt(this._client)}}!function(t){t.Jobs=Dt,t.FineTuningJobsPage=Ut,t.FineTuningJobEventsPage=qt}(Jt||(Jt={}));class Ht extends At{create(t,e){return this._client.post("/assistants",{body:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}retrieve(t,e){return this._client.get(`/assistants/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}update(t,e,n){return this._client.post(`/assistants/${t}`,{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(t={},e){return U(t)?this.list({},t):this._client.getAPIList("/assistants",Xt,{query:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}del(t,e){return this._client.delete(`/assistants/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}}class Xt extends St{}function Vt(t){return"function"==typeof t.parse}!function(t){t.AssistantsPage=Xt}(Ht||(Ht={}));const Gt=t=>"assistant"===t?.role,Kt=t=>"function"===t?.role,zt=t=>"tool"===t?.role;var Qt,Yt,Zt,te,ee,ne,re,se,oe,ie,ae,ce,le,ue=function(t,e,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(t,n):s?s.value=n:e.set(t,n),n},fe=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};class he{constructor(){Qt.add(this),this.controller=new AbortController,Yt.set(this,void 0),Zt.set(this,(()=>{})),te.set(this,(()=>{})),ee.set(this,void 0),ne.set(this,(()=>{})),re.set(this,(()=>{})),se.set(this,{}),oe.set(this,!1),ie.set(this,!1),ae.set(this,!1),ce.set(this,!1),ue(this,Yt,new Promise(((t,e)=>{ue(this,Zt,t,"f"),ue(this,te,e,"f")})),"f"),ue(this,ee,new Promise(((t,e)=>{ue(this,ne,t,"f"),ue(this,re,e,"f")})),"f"),fe(this,Yt,"f").catch((()=>{})),fe(this,ee,"f").catch((()=>{}))}_run(t){setTimeout((()=>{t().then((()=>{this._emitFinal(),this._emit("end")}),fe(this,Qt,"m",le).bind(this))}),0)}_connected(){this.ended||(fe(this,Zt,"f").call(this),this._emit("connect"))}get ended(){return fe(this,oe,"f")}get errored(){return fe(this,ie,"f")}get aborted(){return fe(this,ae,"f")}abort(){this.controller.abort()}on(t,e){return(fe(this,se,"f")[t]||(fe(this,se,"f")[t]=[])).push({listener:e}),this}off(t,e){const n=fe(this,se,"f")[t];if(!n)return this;const r=n.findIndex((t=>t.listener===e));return r>=0&&n.splice(r,1),this}once(t,e){return(fe(this,se,"f")[t]||(fe(this,se,"f")[t]=[])).push({listener:e,once:!0}),this}emitted(t){return new Promise(((e,n)=>{ue(this,ce,!0,"f"),"error"!==t&&this.once("error",n),this.once(t,e)}))}async done(){ue(this,ce,!0,"f"),await fe(this,ee,"f")}_emit(t,...e){if(fe(this,oe,"f"))return;"end"===t&&(ue(this,oe,!0,"f"),fe(this,ne,"f").call(this));const n=fe(this,se,"f")[t];if(n&&(fe(this,se,"f")[t]=n.filter((t=>!t.once)),n.forEach((({listener:t})=>t(...e)))),"abort"===t){const t=e[0];return fe(this,ce,"f")||n?.length||Promise.reject(t),fe(this,te,"f").call(this,t),fe(this,re,"f").call(this,t),void this._emit("end")}if("error"===t){const t=e[0];fe(this,ce,"f")||n?.length||Promise.reject(t),fe(this,te,"f").call(this,t),fe(this,re,"f").call(this,t),this._emit("end")}}_emitFinal(){}}function pe(t){return"auto-parseable-response-format"===t?.$brand}function de(t){return"auto-parseable-tool"===t?.$brand}function ye(t,e){const n=t.choices.map((t=>{if("length"===t.finish_reason)throw new wt;if("content_filter"===t.finish_reason)throw new vt;return{...t,message:{...t.message,tool_calls:t.message.tool_calls?.map((t=>function(t,e){const n=t.tools?.find((t=>t.function?.name===e.function.name));return{...e,function:{...e.function,parsed_arguments:de(n)?n.$parseRaw(e.function.arguments):n?.function.strict?JSON.parse(e.function.arguments):null}}}(e,t)))??[],parsed:t.message.content&&!t.message.refusal?me(e,t.message.content):null}}}));return{...t,choices:n}}function me(t,e){return"json_schema"!==t.response_format?.type?null:"json_schema"===t.response_format?.type?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function ge(t,e){if(!t)return!1;const n=t.tools?.find((t=>t.function?.name===e.function.name));return de(n)||n?.function.strict||!1}function be(t){return!!pe(t.response_format)||(t.tools?.some((t=>de(t)||"function"===t.type&&!0===t.function.strict))??!1)}Yt=new WeakMap,Zt=new WeakMap,te=new WeakMap,ee=new WeakMap,ne=new WeakMap,re=new WeakMap,se=new WeakMap,oe=new WeakMap,ie=new WeakMap,ae=new WeakMap,ce=new WeakMap,Qt=new WeakSet,le=function(t){if(ue(this,ie,!0,"f"),t instanceof Error&&"AbortError"===t.name&&(t=new ct),t instanceof ct)return ue(this,ae,!0,"f"),this._emit("abort",t);if(t instanceof it)return this._emit("error",t);if(t instanceof Error){const e=new it(t.message);return e.cause=t,this._emit("error",e)}return this._emit("error",new it(String(t)))};var we,ve,_e,xe,Se,Ae,Pe,Ee,Oe=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};const je=10;class ke extends he{constructor(){super(...arguments),we.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(t){this._chatCompletions.push(t),this._emit("chatCompletion",t);const e=t.choices[0]?.message;return e&&this._addMessage(e),t}_addMessage(t,e=!0){if("content"in t||(t.content=null),this.messages.push(t),e)if(this._emit("message",t),(Kt(t)||zt(t))&&t.content)this._emit("functionCallResult",t.content);else if(Gt(t)&&t.function_call)this._emit("functionCall",t.function_call);else if(Gt(t)&&t.tool_calls)for(const e of t.tool_calls)"function"===e.type&&this._emit("functionCall",e.function)}async finalChatCompletion(){await this.done();const t=this._chatCompletions[this._chatCompletions.length-1];if(!t)throw new it("stream ended without producing a ChatCompletion");return t}async finalContent(){return await this.done(),Oe(this,we,"m",ve).call(this)}async finalMessage(){return await this.done(),Oe(this,we,"m",_e).call(this)}async finalFunctionCall(){return await this.done(),Oe(this,we,"m",xe).call(this)}async finalFunctionCallResult(){return await this.done(),Oe(this,we,"m",Se).call(this)}async totalUsage(){return await this.done(),Oe(this,we,"m",Ae).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const t=this._chatCompletions[this._chatCompletions.length-1];t&&this._emit("finalChatCompletion",t);const e=Oe(this,we,"m",_e).call(this);e&&this._emit("finalMessage",e);const n=Oe(this,we,"m",ve).call(this);n&&this._emit("finalContent",n);const r=Oe(this,we,"m",xe).call(this);r&&this._emit("finalFunctionCall",r);const s=Oe(this,we,"m",Se).call(this);null!=s&&this._emit("finalFunctionCallResult",s),this._chatCompletions.some((t=>t.usage))&&this._emit("totalUsage",Oe(this,we,"m",Ae).call(this))}async _createChatCompletion(t,e,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),Oe(this,we,"m",Pe).call(this,e);const s=await t.chat.completions.create({...e,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(ye(s,e))}async _runChatCompletion(t,e,n){for(const t of e.messages)this._addMessage(t,!1);return await this._createChatCompletion(t,e,n)}async _runFunctions(t,e,n){const r="function",{function_call:s="auto",stream:o,...i}=e,a="string"!=typeof s&&s?.name,{maxChatCompletions:c=je}=n||{},l={};for(const t of e.functions)l[t.name||t.function.name]=t;const u=e.functions.map((t=>({name:t.name||t.function.name,parameters:t.parameters,description:t.description})));for(const t of e.messages)this._addMessage(t,!1);for(let e=0;e<c;++e){const e=await this._createChatCompletion(t,{...i,function_call:s,functions:u,messages:[...this.messages]},n),o=e.choices[0]?.message;if(!o)throw new it("missing message in ChatCompletion response");if(!o.function_call)return;const{name:c,arguments:f}=o.function_call,h=l[c];if(!h){const t=`Invalid function_call: ${JSON.stringify(c)}. Available options are: ${u.map((t=>JSON.stringify(t.name))).join(", ")}. Please try again`;this._addMessage({role:r,name:c,content:t});continue}if(a&&a!==c){const t=`Invalid function_call: ${JSON.stringify(c)}. ${JSON.stringify(a)} requested. Please try again`;this._addMessage({role:r,name:c,content:t});continue}let p;try{p=Vt(h)?await h.parse(f):f}catch(t){this._addMessage({role:r,name:c,content:t instanceof Error?t.message:String(t)});continue}const d=await h.function(p,this),y=Oe(this,we,"m",Ee).call(this,d);if(this._addMessage({role:r,name:c,content:y}),a)return}}async _runTools(t,e,n){const r="tool",{tool_choice:s="auto",stream:o,...i}=e,a="string"!=typeof s&&s?.function?.name,{maxChatCompletions:c=je}=n||{},l=e.tools.map((t=>{if(de(t)){if(!t.$callback)throw new it("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:t.$callback,name:t.function.name,description:t.function.description||"",parameters:t.function.parameters,parse:t.$parseRaw,strict:!0}}}return t})),u={};for(const t of l)"function"===t.type&&(u[t.function.name||t.function.function.name]=t.function);const f="tools"in e?l.map((t=>"function"===t.type?{type:"function",function:{name:t.function.name||t.function.function.name,parameters:t.function.parameters,description:t.function.description,strict:t.function.strict}}:t)):void 0;for(const t of e.messages)this._addMessage(t,!1);for(let e=0;e<c;++e){const e=await this._createChatCompletion(t,{...i,tool_choice:s,tools:f,messages:[...this.messages]},n),o=e.choices[0]?.message;if(!o)throw new it("missing message in ChatCompletion response");if(!o.tool_calls?.length)return;for(const t of o.tool_calls){if("function"!==t.type)continue;const e=t.id,{name:n,arguments:s}=t.function,o=u[n];if(!o){const t=`Invalid tool_call: ${JSON.stringify(n)}. Available options are: ${Object.keys(u).map((t=>JSON.stringify(t))).join(", ")}. Please try again`;this._addMessage({role:r,tool_call_id:e,content:t});continue}if(a&&a!==n){const t=`Invalid tool_call: ${JSON.stringify(n)}. ${JSON.stringify(a)} requested. Please try again`;this._addMessage({role:r,tool_call_id:e,content:t});continue}let i;try{i=Vt(o)?await o.parse(s):s}catch(t){const n=t instanceof Error?t.message:String(t);this._addMessage({role:r,tool_call_id:e,content:n});continue}const c=await o.function(i,this),l=Oe(this,we,"m",Ee).call(this,c);if(this._addMessage({role:r,tool_call_id:e,content:l}),a)return}}}}we=new WeakSet,ve=function(){return Oe(this,we,"m",_e).call(this).content??null},_e=function(){let t=this.messages.length;for(;t-- >0;){const e=this.messages[t];if(Gt(e)){const{function_call:t,...n}=e,r={...n,content:e.content??null,refusal:e.refusal??null};return t&&(r.function_call=t),r}}throw new it("stream ended without producing a ChatCompletionMessage with role=assistant")},xe=function(){for(let t=this.messages.length-1;t>=0;t--){const e=this.messages[t];if(Gt(e)&&e?.function_call)return e.function_call;if(Gt(e)&&e?.tool_calls?.length)return e.tool_calls.at(-1)?.function}},Se=function(){for(let t=this.messages.length-1;t>=0;t--){const e=this.messages[t];if(Kt(e)&&null!=e.content)return e.content;if(zt(e)&&null!=e.content&&"string"==typeof e.content&&this.messages.some((t=>"assistant"===t.role&&t.tool_calls?.some((t=>"function"===t.type&&t.id===e.tool_call_id)))))return e.content}},Ae=function(){const t={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:e}of this._chatCompletions)e&&(t.completion_tokens+=e.completion_tokens,t.prompt_tokens+=e.prompt_tokens,t.total_tokens+=e.total_tokens);return t},Pe=function(t){if(null!=t.n&&t.n>1)throw new it("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Ee=function(t){return"string"==typeof t?t:void 0===t?"undefined":JSON.stringify(t)};class Re extends ke{static runFunctions(t,e,n){const r=new Re,s={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run((()=>r._runFunctions(t,e,s))),r}static runTools(t,e,n){const r=new Re,s={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run((()=>r._runTools(t,e,s))),r}_addMessage(t,e=!0){super._addMessage(t,e),Gt(t)&&t.content&&this._emit("content",t.content)}}class Ie extends Error{}class $e extends Error{}const Ce=t=>function(t,e=511){if("string"!=typeof t)throw new TypeError("expecting str, got "+typeof t);if(!t.trim())throw new Error(`${t} is empty`);return((t,e)=>{const n=t.length;let r=0;const s=t=>{throw new Ie(`${t} at position ${r}`)},o=t=>{throw new $e(`${t} at position ${r}`)},i=()=>(f(),r>=n&&s("Unexpected end of input"),'"'===t[r]?a():"{"===t[r]?c():"["===t[r]?l():"null"===t.substring(r,r+4)||16&e&&n-r<4&&"null".startsWith(t.substring(r))?(r+=4,null):"true"===t.substring(r,r+4)||32&e&&n-r<4&&"true".startsWith(t.substring(r))?(r+=4,!0):"false"===t.substring(r,r+5)||32&e&&n-r<5&&"false".startsWith(t.substring(r))?(r+=5,!1):"Infinity"===t.substring(r,r+8)||128&e&&n-r<8&&"Infinity".startsWith(t.substring(r))?(r+=8,1/0):"-Infinity"===t.substring(r,r+9)||256&e&&1<n-r&&n-r<9&&"-Infinity".startsWith(t.substring(r))?(r+=9,-1/0):"NaN"===t.substring(r,r+3)||64&e&&n-r<3&&"NaN".startsWith(t.substring(r))?(r+=3,NaN):u()),a=()=>{const i=r;let a=!1;for(r++;r<n&&('"'!==t[r]||a&&"\\"===t[r-1]);)a="\\"===t[r]&&!a,r++;if('"'==t.charAt(r))try{return JSON.parse(t.substring(i,++r-Number(a)))}catch(t){o(String(t))}else if(1&e)try{return JSON.parse(t.substring(i,r-Number(a))+'"')}catch(e){return JSON.parse(t.substring(i,t.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},c=()=>{r++,f();const o={};try{for(;"}"!==t[r];){if(f(),r>=n&&8&e)return o;const s=a();f(),r++;try{const t=i();Object.defineProperty(o,s,{value:t,writable:!0,enumerable:!0,configurable:!0})}catch(t){if(8&e)return o;throw t}f(),","===t[r]&&r++}}catch(t){if(8&e)return o;s("Expected '}' at end of object")}return r++,o},l=()=>{r++;const n=[];try{for(;"]"!==t[r];)n.push(i()),f(),","===t[r]&&r++}catch(t){if(4&e)return n;s("Expected ']' at end of array")}return r++,n},u=()=>{if(0===r){"-"===t&&2&e&&s("Not sure what '-' is");try{return JSON.parse(t)}catch(n){if(2&e)try{return"."===t[t.length-1]?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch(t){}o(String(n))}}const i=r;for("-"===t[r]&&r++;t[r]&&!",]}".includes(t[r]);)r++;r!=n||2&e||s("Unterminated number literal");try{return JSON.parse(t.substring(i,r))}catch(n){"-"===t.substring(i,r)&&2&e&&s("Not sure what '-' is");try{return JSON.parse(t.substring(i,t.lastIndexOf("e")))}catch(t){o(String(t))}}},f=()=>{for(;r<n&&" \n\r\t".includes(t[r]);)r++};return i()})(t.trim(),e)}(t,509);var Te,Me,Ne,Fe,Be,Le,We,De,Ue,qe,Je,He,Xe=function(t,e,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(t,n):s?s.value=n:e.set(t,n),n},Ve=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};class Ge extends ke{constructor(t){super(),Te.add(this),Me.set(this,void 0),Ne.set(this,void 0),Fe.set(this,void 0),Xe(this,Me,t,"f"),Xe(this,Ne,[],"f")}get currentChatCompletionSnapshot(){return Ve(this,Fe,"f")}static fromReadableStream(t){const e=new Ge(null);return e._run((()=>e._fromReadableStream(t))),e}static createChatCompletion(t,e,n){const r=new Ge(e);return r._run((()=>r._runChatCompletion(t,{...e,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}}))),r}async _createChatCompletion(t,e,n){super._createChatCompletion;const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),Ve(this,Te,"m",Be).call(this);const s=await t.chat.completions.create({...e,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const t of s)Ve(this,Te,"m",We).call(this,t);if(s.controller.signal?.aborted)throw new ct;return this._addChatCompletion(Ve(this,Te,"m",qe).call(this))}async _fromReadableStream(t,e){const n=e?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),Ve(this,Te,"m",Be).call(this),this._connected();const r=b.fromReadableStream(t,this.controller);let s;for await(const t of r)s&&s!==t.id&&this._addChatCompletion(Ve(this,Te,"m",qe).call(this)),Ve(this,Te,"m",We).call(this,t),s=t.id;if(r.controller.signal?.aborted)throw new ct;return this._addChatCompletion(Ve(this,Te,"m",qe).call(this))}[(Me=new WeakMap,Ne=new WeakMap,Fe=new WeakMap,Te=new WeakSet,Be=function(){this.ended||Xe(this,Fe,void 0,"f")},Le=function(t){let e=Ve(this,Ne,"f")[t.index];return e||(e={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Ve(this,Ne,"f")[t.index]=e,e)},We=function(t){if(this.ended)return;const e=Ve(this,Te,"m",He).call(this,t);this._emit("chunk",t,e);for(const n of t.choices){const t=e.choices[n.index];null!=n.delta.content&&"assistant"===t.message?.role&&t.message?.content&&(this._emit("content",n.delta.content,t.message.content),this._emit("content.delta",{delta:n.delta.content,snapshot:t.message.content,parsed:t.message.parsed})),null!=n.delta.refusal&&"assistant"===t.message?.role&&t.message?.refusal&&this._emit("refusal.delta",{delta:n.delta.refusal,snapshot:t.message.refusal}),null!=n.logprobs?.content&&"assistant"===t.message?.role&&this._emit("logprobs.content.delta",{content:n.logprobs?.content,snapshot:t.logprobs?.content??[]}),null!=n.logprobs?.refusal&&"assistant"===t.message?.role&&this._emit("logprobs.refusal.delta",{refusal:n.logprobs?.refusal,snapshot:t.logprobs?.refusal??[]});const r=Ve(this,Te,"m",Le).call(this,t);t.finish_reason&&(Ve(this,Te,"m",Ue).call(this,t),null!=r.current_tool_call_index&&Ve(this,Te,"m",De).call(this,t,r.current_tool_call_index));for(const e of n.delta.tool_calls??[])r.current_tool_call_index!==e.index&&(Ve(this,Te,"m",Ue).call(this,t),null!=r.current_tool_call_index&&Ve(this,Te,"m",De).call(this,t,r.current_tool_call_index)),r.current_tool_call_index=e.index;for(const e of n.delta.tool_calls??[]){const n=t.message.tool_calls?.[e.index];n?.type&&"function"===n?.type&&this._emit("tool_calls.function.arguments.delta",{name:n.function?.name,index:e.index,arguments:n.function.arguments,parsed_arguments:n.function.parsed_arguments,arguments_delta:e.function?.arguments??""})}}},De=function(t,e){if(Ve(this,Te,"m",Le).call(this,t).done_tool_calls.has(e))return;const n=t.message.tool_calls?.[e];if(!n)throw new Error("no tool call snapshot");if(!n.type)throw new Error("tool call snapshot missing `type`");if("function"===n.type){const t=Ve(this,Me,"f")?.tools?.find((t=>"function"===t.type&&t.function.name===n.function.name));this._emit("tool_calls.function.arguments.done",{name:n.function.name,index:e,arguments:n.function.arguments,parsed_arguments:de(t)?t.$parseRaw(n.function.arguments):t?.function.strict?JSON.parse(n.function.arguments):null})}else n.type},Ue=function(t){const e=Ve(this,Te,"m",Le).call(this,t);if(t.message.content&&!e.content_done){e.content_done=!0;const n=Ve(this,Te,"m",Je).call(this);this._emit("content.done",{content:t.message.content,parsed:n?n.$parseRaw(t.message.content):null})}t.message.refusal&&!e.refusal_done&&(e.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),t.logprobs?.content&&!e.logprobs_content_done&&(e.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),t.logprobs?.refusal&&!e.logprobs_refusal_done&&(e.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},qe=function(){if(this.ended)throw new it("stream has ended, this shouldn't happen");const t=Ve(this,Fe,"f");if(!t)throw new it("request ended without sending any chunks");return Xe(this,Fe,void 0,"f"),Xe(this,Ne,[],"f"),function(t,e){const{id:n,choices:r,created:s,model:o,system_fingerprint:i,...a}=t,c={...a,id:n,choices:r.map((({message:e,finish_reason:n,index:r,logprobs:s,...o})=>{if(!n)throw new it(`missing finish_reason for choice ${r}`);const{content:i=null,function_call:a,tool_calls:c,...l}=e,u=e.role;if(!u)throw new it(`missing role for choice ${r}`);if(a){const{arguments:t,name:c}=a;if(null==t)throw new it(`missing function_call.arguments for choice ${r}`);if(!c)throw new it(`missing function_call.name for choice ${r}`);return{...o,message:{content:i,function_call:{arguments:t,name:c},role:u,refusal:e.refusal??null},finish_reason:n,index:r,logprobs:s}}return c?{...o,index:r,finish_reason:n,logprobs:s,message:{...l,role:u,content:i,refusal:e.refusal??null,tool_calls:c.map(((e,n)=>{const{function:s,type:o,id:i,...a}=e,{arguments:c,name:l,...u}=s||{};if(null==i)throw new it(`missing choices[${r}].tool_calls[${n}].id\n${Ke(t)}`);if(null==o)throw new it(`missing choices[${r}].tool_calls[${n}].type\n${Ke(t)}`);if(null==l)throw new it(`missing choices[${r}].tool_calls[${n}].function.name\n${Ke(t)}`);if(null==c)throw new it(`missing choices[${r}].tool_calls[${n}].function.arguments\n${Ke(t)}`);return{...a,id:i,type:o,function:{...u,name:l,arguments:c}}}))}}:{...o,message:{...l,content:i,role:u,refusal:e.refusal??null},finish_reason:n,index:r,logprobs:s}})),created:s,model:o,object:"chat.completion",...i?{system_fingerprint:i}:{}};return function(t,e){return e&&be(e)?ye(t,e):{...t,choices:t.choices.map((t=>({...t,message:{...t.message,parsed:null,tool_calls:t.message.tool_calls??[]}})))}}(c,e)}(t,Ve(this,Me,"f"))},Je=function(){const t=Ve(this,Me,"f")?.response_format;return pe(t)?t:null},He=function(t){var e,n,r,s;let o=Ve(this,Fe,"f");const{choices:i,...a}=t;o?Object.assign(o,a):o=Xe(this,Fe,{...a,choices:[]},"f");for(const{delta:i,finish_reason:a,index:c,logprobs:l=null,...u}of t.choices){let t=o.choices[c];if(t||(t=o.choices[c]={finish_reason:a,index:c,message:{},logprobs:l,...u}),l)if(t.logprobs){const{content:r,refusal:s,...o}=l;Object.assign(t.logprobs,o),r&&((e=t.logprobs).content??(e.content=[]),t.logprobs.content.push(...r)),s&&((n=t.logprobs).refusal??(n.refusal=[]),t.logprobs.refusal.push(...s))}else t.logprobs=Object.assign({},l);if(a&&(t.finish_reason=a,Ve(this,Me,"f")&&be(Ve(this,Me,"f")))){if("length"===a)throw new wt;if("content_filter"===a)throw new vt}if(Object.assign(t,u),!i)continue;const{content:f,refusal:h,function_call:p,role:d,tool_calls:y,...m}=i;if(Object.assign(t.message,m),h&&(t.message.refusal=(t.message.refusal||"")+h),d&&(t.message.role=d),p&&(t.message.function_call?(p.name&&(t.message.function_call.name=p.name),p.arguments&&((r=t.message.function_call).arguments??(r.arguments=""),t.message.function_call.arguments+=p.arguments)):t.message.function_call=p),f&&(t.message.content=(t.message.content||"")+f,!t.message.refusal&&Ve(this,Te,"m",Je).call(this)&&(t.message.parsed=Ce(t.message.content))),y){t.message.tool_calls||(t.message.tool_calls=[]);for(const{index:e,id:n,type:r,function:o,...i}of y){const a=(s=t.message.tool_calls)[e]??(s[e]={});Object.assign(a,i),n&&(a.id=n),r&&(a.type=r),o&&(a.function??(a.function={name:o.name??"",arguments:""})),o?.name&&(a.function.name=o.name),o?.arguments&&(a.function.arguments+=o.arguments,ge(Ve(this,Me,"f"),a)&&(a.function.parsed_arguments=Ce(a.function.arguments)))}}}return o},Symbol.asyncIterator)](){const t=[],e=[];let n=!1;return this.on("chunk",(n=>{const r=e.shift();r?r.resolve(n):t.push(n)})),this.on("end",(()=>{n=!0;for(const t of e)t.resolve(void 0);e.length=0})),this.on("abort",(t=>{n=!0;for(const n of e)n.reject(t);e.length=0})),this.on("error",(t=>{n=!0;for(const n of e)n.reject(t);e.length=0})),{next:async()=>t.length?{value:t.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise(((t,n)=>e.push({resolve:t,reject:n}))).then((t=>t?{value:t,done:!1}:{value:void 0,done:!0})),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new b(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Ke(t){return JSON.stringify(t)}class ze extends Ge{static fromReadableStream(t){const e=new ze(null);return e._run((()=>e._fromReadableStream(t))),e}static runFunctions(t,e,n){const r=new ze(null),s={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run((()=>r._runFunctions(t,e,s))),r}static runTools(t,e,n){const r=new ze(e),s={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run((()=>r._runTools(t,e,s))),r}}class Qe extends At{parse(t,e){return function(t){for(const e of t??[]){if("function"!==e.type)throw new it(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(!0!==e.function.strict)throw new it(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}(t.tools),this._client.chat.completions.create(t,{...e,headers:{...e?.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap((e=>ye(e,t)))}runFunctions(t,e){return t.stream?ze.runFunctions(this._client,t,e):Re.runFunctions(this._client,t,e)}runTools(t,e){return t.stream?ze.runTools(this._client,t,e):Re.runTools(this._client,t,e)}stream(t,e){return Ge.createChatCompletion(this._client,t,e)}}class Ye extends At{constructor(){super(...arguments),this.completions=new Qe(this._client)}}!function(t){t.Completions=Qe}(Ye||(Ye={}));var Ze,tn,en,nn,rn,sn,on,an,cn,ln,un,fn,hn,pn,dn,yn,mn,gn,bn,wn,vn,_n,xn,Sn=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)},An=function(t,e,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(t,n):s?s.value=n:e.set(t,n),n};class Pn extends he{constructor(){super(...arguments),Ze.add(this),tn.set(this,[]),en.set(this,{}),nn.set(this,{}),rn.set(this,void 0),sn.set(this,void 0),on.set(this,void 0),an.set(this,void 0),cn.set(this,void 0),ln.set(this,void 0),un.set(this,void 0),fn.set(this,void 0),hn.set(this,void 0)}[(tn=new WeakMap,en=new WeakMap,nn=new WeakMap,rn=new WeakMap,sn=new WeakMap,on=new WeakMap,an=new WeakMap,cn=new WeakMap,ln=new WeakMap,un=new WeakMap,fn=new WeakMap,hn=new WeakMap,Ze=new WeakSet,Symbol.asyncIterator)](){const t=[],e=[];let n=!1;return this.on("event",(n=>{const r=e.shift();r?r.resolve(n):t.push(n)})),this.on("end",(()=>{n=!0;for(const t of e)t.resolve(void 0);e.length=0})),this.on("abort",(t=>{n=!0;for(const n of e)n.reject(t);e.length=0})),this.on("error",(t=>{n=!0;for(const n of e)n.reject(t);e.length=0})),{next:async()=>t.length?{value:t.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise(((t,n)=>e.push({resolve:t,reject:n}))).then((t=>t?{value:t,done:!1}:{value:void 0,done:!0})),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(t){const e=new Pn;return e._run((()=>e._fromReadableStream(t))),e}async _fromReadableStream(t,e){const n=e?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),this._connected();const r=b.fromReadableStream(t,this.controller);for await(const t of r)Sn(this,Ze,"m",pn).call(this,t);if(r.controller.signal?.aborted)throw new ct;return this._addRun(Sn(this,Ze,"m",dn).call(this))}toReadableStream(){return new b(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(t,e,n,r,s){const o=new Pn;return o._run((()=>o._runToolAssistantStream(t,e,n,r,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}}))),o}async _createToolAssistantStream(t,e,n,r,s){const o=s?.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",(()=>this.controller.abort())));const i={...r,stream:!0},a=await t.submitToolOutputs(e,n,i,{...s,signal:this.controller.signal});this._connected();for await(const t of a)Sn(this,Ze,"m",pn).call(this,t);if(a.controller.signal?.aborted)throw new ct;return this._addRun(Sn(this,Ze,"m",dn).call(this))}static createThreadAssistantStream(t,e,n){const r=new Pn;return r._run((()=>r._threadAssistantStream(t,e,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}}))),r}static createAssistantStream(t,e,n,r){const s=new Pn;return s._run((()=>s._runAssistantStream(t,e,n,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}}))),s}currentEvent(){return Sn(this,un,"f")}currentRun(){return Sn(this,fn,"f")}currentMessageSnapshot(){return Sn(this,rn,"f")}currentRunStepSnapshot(){return Sn(this,hn,"f")}async finalRunSteps(){return await this.done(),Object.values(Sn(this,en,"f"))}async finalMessages(){return await this.done(),Object.values(Sn(this,nn,"f"))}async finalRun(){if(await this.done(),!Sn(this,sn,"f"))throw Error("Final run was not received.");return Sn(this,sn,"f")}async _createThreadAssistantStream(t,e,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort())));const s={...e,stream:!0},o=await t.createAndRun(s,{...n,signal:this.controller.signal});this._connected();for await(const t of o)Sn(this,Ze,"m",pn).call(this,t);if(o.controller.signal?.aborted)throw new ct;return this._addRun(Sn(this,Ze,"m",dn).call(this))}async _createAssistantStream(t,e,n,r){const s=r?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",(()=>this.controller.abort())));const o={...n,stream:!0},i=await t.create(e,o,{...r,signal:this.controller.signal});this._connected();for await(const t of i)Sn(this,Ze,"m",pn).call(this,t);if(i.controller.signal?.aborted)throw new ct;return this._addRun(Sn(this,Ze,"m",dn).call(this))}static accumulateDelta(t,e){for(const[n,r]of Object.entries(e)){if(!t.hasOwnProperty(n)){t[n]=r;continue}let e=t[n];if(null!=e)if("index"!==n&&"type"!==n){if("string"==typeof e&&"string"==typeof r)e+=r;else if("number"==typeof e&&"number"==typeof r)e+=r;else{if(!ot(e)||!ot(r)){if(Array.isArray(e)&&Array.isArray(r)){if(e.every((t=>"string"==typeof t||"number"==typeof t))){e.push(...r);continue}for(const t of r){if(!ot(t))throw new Error(`Expected array delta entry to be an object but got: ${t}`);const n=t.index;if(null==n)throw console.error(t),new Error("Expected array delta entry to have an `index` property");if("number"!=typeof n)throw new Error(`Expected array delta entry \`index\` property to be a number but got ${n}`);const r=e[n];null==r?e.push(t):e[n]=this.accumulateDelta(r,t)}continue}throw Error(`Unhandled record type: ${n}, deltaValue: ${r}, accValue: ${e}`)}e=this.accumulateDelta(e,r)}t[n]=e}else t[n]=r;else t[n]=r}return t}_addRun(t){return t}async _threadAssistantStream(t,e,n){return await this._createThreadAssistantStream(e,t,n)}async _runAssistantStream(t,e,n,r){return await this._createAssistantStream(e,t,n,r)}async _runToolAssistantStream(t,e,n,r,s){return await this._createToolAssistantStream(n,t,e,r,s)}}pn=function(t){if(!this.ended)switch(An(this,un,t,"f"),Sn(this,Ze,"m",gn).call(this,t),t.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":Sn(this,Ze,"m",_n).call(this,t);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Sn(this,Ze,"m",mn).call(this,t);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":Sn(this,Ze,"m",yn).call(this,t);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},dn=function(){if(this.ended)throw new it("stream has ended, this shouldn't happen");if(!Sn(this,sn,"f"))throw Error("Final run has not been received");return Sn(this,sn,"f")},yn=function(t){const[e,n]=Sn(this,Ze,"m",wn).call(this,t,Sn(this,rn,"f"));An(this,rn,e,"f"),Sn(this,nn,"f")[e.id]=e;for(const t of n){const n=e.content[t.index];"text"==n?.type&&this._emit("textCreated",n.text)}switch(t.event){case"thread.message.created":this._emit("messageCreated",t.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",t.data.delta,e),t.data.delta.content)for(const n of t.data.delta.content){if("text"==n.type&&n.text){let t=n.text,r=e.content[n.index];if(!r||"text"!=r.type)throw Error("The snapshot associated with this text delta is not text or missing");this._emit("textDelta",t,r.text)}if(n.index!=Sn(this,on,"f")){if(Sn(this,an,"f"))switch(Sn(this,an,"f").type){case"text":this._emit("textDone",Sn(this,an,"f").text,Sn(this,rn,"f"));break;case"image_file":this._emit("imageFileDone",Sn(this,an,"f").image_file,Sn(this,rn,"f"))}An(this,on,n.index,"f")}An(this,an,e.content[n.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(void 0!==Sn(this,on,"f")){const e=t.data.content[Sn(this,on,"f")];if(e)switch(e.type){case"image_file":this._emit("imageFileDone",e.image_file,Sn(this,rn,"f"));break;case"text":this._emit("textDone",e.text,Sn(this,rn,"f"))}}Sn(this,rn,"f")&&this._emit("messageDone",t.data),An(this,rn,void 0,"f")}},mn=function(t){const e=Sn(this,Ze,"m",bn).call(this,t);switch(An(this,hn,e,"f"),t.event){case"thread.run.step.created":this._emit("runStepCreated",t.data);break;case"thread.run.step.delta":const n=t.data.delta;if(n.step_details&&"tool_calls"==n.step_details.type&&n.step_details.tool_calls&&"tool_calls"==e.step_details.type)for(const t of n.step_details.tool_calls)t.index==Sn(this,cn,"f")?this._emit("toolCallDelta",t,e.step_details.tool_calls[t.index]):(Sn(this,ln,"f")&&this._emit("toolCallDone",Sn(this,ln,"f")),An(this,cn,t.index,"f"),An(this,ln,e.step_details.tool_calls[t.index],"f"),Sn(this,ln,"f")&&this._emit("toolCallCreated",Sn(this,ln,"f")));this._emit("runStepDelta",t.data.delta,e);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":An(this,hn,void 0,"f"),"tool_calls"==t.data.step_details.type&&Sn(this,ln,"f")&&(this._emit("toolCallDone",Sn(this,ln,"f")),An(this,ln,void 0,"f")),this._emit("runStepDone",t.data,e)}},gn=function(t){Sn(this,tn,"f").push(t),this._emit("event",t)},bn=function(t){switch(t.event){case"thread.run.step.created":return Sn(this,en,"f")[t.data.id]=t.data,t.data;case"thread.run.step.delta":let e=Sn(this,en,"f")[t.data.id];if(!e)throw Error("Received a RunStepDelta before creation of a snapshot");let n=t.data;if(n.delta){const r=Pn.accumulateDelta(e,n.delta);Sn(this,en,"f")[t.data.id]=r}return Sn(this,en,"f")[t.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":Sn(this,en,"f")[t.data.id]=t.data}if(Sn(this,en,"f")[t.data.id])return Sn(this,en,"f")[t.data.id];throw new Error("No snapshot available")},wn=function(t,e){let n=[];switch(t.event){case"thread.message.created":return[t.data,n];case"thread.message.delta":if(!e)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=t.data;if(r.delta.content)for(const t of r.delta.content)if(t.index in e.content){let n=e.content[t.index];e.content[t.index]=Sn(this,Ze,"m",vn).call(this,t,n)}else e.content[t.index]=t,n.push(t);return[e,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(e)return[e,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},vn=function(t,e){return Pn.accumulateDelta(e,t)},_n=function(t){switch(An(this,fn,t.data,"f"),t.event){case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.cancelling":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":An(this,sn,t.data,"f"),Sn(this,ln,"f")&&(this._emit("toolCallDone",Sn(this,ln,"f")),An(this,ln,void 0,"f"))}};class En extends At{create(t,e,n){return this._client.post(`/threads/${t}/messages`,{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(t,e,n){return this._client.get(`/threads/${t}/messages/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(t,e,n,r){return this._client.post(`/threads/${t}/messages/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(t,e={},n){return U(e)?this.list(t,{},e):this._client.getAPIList(`/threads/${t}/messages`,On,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(t,e,n){return this._client.delete(`/threads/${t}/messages/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class On extends St{}!function(t){t.MessagesPage=On}(En||(En={}));class jn extends At{retrieve(t,e,n,r={},s){return U(r)?this.retrieve(t,e,n,{},r):this._client.get(`/threads/${t}/runs/${e}/steps/${n}`,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}list(t,e,n={},r){return U(n)?this.list(t,e,{},n):this._client.getAPIList(`/threads/${t}/runs/${e}/steps`,kn,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}}class kn extends St{}!function(t){t.RunStepsPage=kn}(jn||(jn={}));class Rn extends At{constructor(){super(...arguments),this.steps=new jn(this._client)}create(t,e,n){const{include:r,...s}=e;return this._client.post(`/threads/${t}/runs`,{query:{include:r},body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers},stream:e.stream??!1})}retrieve(t,e,n){return this._client.get(`/threads/${t}/runs/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(t,e,n,r){return this._client.post(`/threads/${t}/runs/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(t,e={},n){return U(e)?this.list(t,{},e):this._client.getAPIList(`/threads/${t}/runs`,In,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}cancel(t,e,n){return this._client.post(`/threads/${t}/runs/${e}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(t,e,n){const r=await this.create(t,e,n);return await this.poll(t,r.id,n)}createAndStream(t,e,n){return Pn.createAssistantStream(t,this._client.beta.threads.runs,e,n)}async poll(t,e,n){const r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:s,response:o}=await this.retrieve(t,e,{...n,headers:{...n?.headers,...r}}).withResponse();switch(s.status){case"queued":case"in_progress":case"cancelling":let t=5e3;if(n?.pollIntervalMs)t=n.pollIntervalMs;else{const e=o.headers.get("openai-poll-after-ms");if(e){const n=parseInt(e);isNaN(n)||(t=n)}}await z(t);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return s}}}stream(t,e,n){return Pn.createAssistantStream(t,this._client.beta.threads.runs,e,n)}submitToolOutputs(t,e,n,r){return this._client.post(`/threads/${t}/runs/${e}/submit_tool_outputs`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(t,e,n,r){const s=await this.submitToolOutputs(t,e,n,r);return await this.poll(t,s.id,r)}submitToolOutputsStream(t,e,n,r){return Pn.createToolAssistantStream(t,e,this._client.beta.threads.runs,n,r)}}class In extends St{}!function(t){t.RunsPage=In,t.Steps=jn,t.RunStepsPage=kn}(Rn||(Rn={}));class $n extends At{constructor(){super(...arguments),this.runs=new Rn(this._client),this.messages=new En(this._client)}create(t={},e){return U(t)?this.create({},t):this._client.post("/threads",{body:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}retrieve(t,e){return this._client.get(`/threads/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}update(t,e,n){return this._client.post(`/threads/${t}`,{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(t,e){return this._client.delete(`/threads/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}createAndRun(t,e){return this._client.post("/threads/runs",{body:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers},stream:t.stream??!1})}async createAndRunPoll(t,e){const n=await this.createAndRun(t,e);return await this.runs.poll(n.thread_id,n.id,e)}createAndRunStream(t,e){return Pn.createThreadAssistantStream(t,this._client.beta.threads,e)}}!function(t){t.Runs=Rn,t.RunsPage=In,t.Messages=En,t.MessagesPage=On}($n||($n={}));class Cn extends At{create(t,e,n){return this._client.post(`/vector_stores/${t}/files`,{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(t,e,n){return this._client.get(`/vector_stores/${t}/files/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(t,e={},n){return U(e)?this.list(t,{},e):this._client.getAPIList(`/vector_stores/${t}/files`,Tn,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(t,e,n){return this._client.delete(`/vector_stores/${t}/files/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(t,e,n){const r=await this.create(t,e,n);return await this.poll(t,r.id,n)}async poll(t,e,n){const r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const s=await this.retrieve(t,e,{...n,headers:r}).withResponse(),o=s.data;switch(o.status){case"in_progress":let t=5e3;if(n?.pollIntervalMs)t=n.pollIntervalMs;else{const e=s.response.headers.get("openai-poll-after-ms");if(e){const n=parseInt(e);isNaN(n)||(t=n)}}await z(t);break;case"failed":case"completed":return o}}}async upload(t,e,n){const r=await this._client.files.create({file:e,purpose:"assistants"},n);return this.create(t,{file_id:r.id},n)}async uploadAndPoll(t,e,n){const r=await this.upload(t,e,n);return await this.poll(t,r.id,n)}}class Tn extends St{}!function(t){t.VectorStoreFilesPage=Tn}(Cn||(Cn={}));class Mn extends At{create(t,e,n){return this._client.post(`/vector_stores/${t}/file_batches`,{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(t,e,n){return this._client.get(`/vector_stores/${t}/file_batches/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}cancel(t,e,n){return this._client.post(`/vector_stores/${t}/file_batches/${e}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(t,e,n){const r=await this.create(t,e);return await this.poll(t,r.id,n)}listFiles(t,e,n={},r){return U(n)?this.listFiles(t,e,{},n):this._client.getAPIList(`/vector_stores/${t}/file_batches/${e}/files`,Tn,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async poll(t,e,n){const r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:s,response:o}=await this.retrieve(t,e,{...n,headers:r}).withResponse();switch(s.status){case"in_progress":let t=5e3;if(n?.pollIntervalMs)t=n.pollIntervalMs;else{const e=o.headers.get("openai-poll-after-ms");if(e){const n=parseInt(e);isNaN(n)||(t=n)}}await z(t);break;case"failed":case"cancelled":case"completed":return s}}}async uploadAndPoll(t,{files:e,fileIds:n=[]},r){if(null==e||0==e.length)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const s=r?.maxConcurrency??5,o=Math.min(s,e.length),i=this._client,a=e.values(),c=[...n],l=Array(o).fill(a).map((async function(t){for(let e of t){const t=await i.files.create({file:e,purpose:"assistants"},r);c.push(t.id)}}));return await(async t=>{const e=await Promise.allSettled(t),n=e.filter((t=>"rejected"===t.status));if(n.length){for(const t of n)console.error(t.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const t of e)"fulfilled"===t.status&&r.push(t.value);return r})(l),await this.createAndPoll(t,{file_ids:c})}}Mn||(Mn={});class Nn extends At{constructor(){super(...arguments),this.files=new Cn(this._client),this.fileBatches=new Mn(this._client)}create(t,e){return this._client.post("/vector_stores",{body:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}retrieve(t,e){return this._client.get(`/vector_stores/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}update(t,e,n){return this._client.post(`/vector_stores/${t}`,{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(t={},e){return U(t)?this.list({},t):this._client.getAPIList("/vector_stores",Fn,{query:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}del(t,e){return this._client.delete(`/vector_stores/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}}class Fn extends St{}!function(t){t.VectorStoresPage=Fn,t.Files=Cn,t.VectorStoreFilesPage=Tn,t.FileBatches=Mn}(Nn||(Nn={}));class Bn extends At{constructor(){super(...arguments),this.vectorStores=new Nn(this._client),this.chat=new Ye(this._client),this.assistants=new Ht(this._client),this.threads=new $n(this._client)}}!function(t){t.VectorStores=Nn,t.VectorStoresPage=Fn,t.Chat=Ye,t.Assistants=Ht,t.AssistantsPage=Xt,t.Threads=$n}(Bn||(Bn={}));class Ln extends At{create(t,e){return this._client.post("/batches",{body:t,...e})}retrieve(t,e){return this._client.get(`/batches/${t}`,e)}list(t={},e){return U(t)?this.list({},t):this._client.getAPIList("/batches",Wn,{query:t,...e})}cancel(t,e){return this._client.post(`/batches/${t}/cancel`,e)}}class Wn extends St{}!function(t){t.BatchesPage=Wn}(Ln||(Ln={}));class Dn extends At{create(t,e,n){return this._client.post(`/uploads/${t}/parts`,R({body:e,...n}))}}Dn||(Dn={});class Un extends At{constructor(){super(...arguments),this.parts=new Dn(this._client)}create(t,e){return this._client.post("/uploads",{body:t,...e})}cancel(t,e){return this._client.post(`/uploads/${t}/cancel`,e)}complete(t,e,n){return this._client.post(`/uploads/${t}/complete`,{body:e,...n})}}!function(t){t.Parts=Dn}(Un||(Un={}));class qn extends F{constructor({baseURL:t=Z("OPENAI_BASE_URL"),apiKey:e=Z("OPENAI_API_KEY"),organization:n=Z("OPENAI_ORG_ID")??null,project:r=Z("OPENAI_PROJECT_ID")??null,...s}={}){if(void 0===e)throw new it("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:e,organization:n,project:r,...s,baseURL:t||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator)throw new it("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new Pt(this),this.chat=new Ot(this),this.embeddings=new jt(this),this.files=new kt(this),this.images=new It(this),this.audio=new Mt(this),this.moderations=new Nt(this),this.models=new Ft(this),this.fineTuning=new Jt(this),this.beta=new Bn(this),this.batches=new Ln(this),this.uploads=new Un(this),this._options=o,this.apiKey=e,this.organization=n,this.project=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(t){return{...super.defaultHeaders(t),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(t){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(t){return _t.stringify(t,{arrayFormat:"brackets"})}}xn=qn,qn.OpenAI=xn,qn.DEFAULT_TIMEOUT=6e5,qn.OpenAIError=it,qn.APIError=at,qn.APIConnectionError=lt,qn.APIConnectionTimeoutError=ut,qn.APIUserAbortError=ct,qn.NotFoundError=dt,qn.ConflictError=yt,qn.RateLimitError=gt,qn.BadRequestError=ft,qn.AuthenticationError=ht,qn.InternalServerError=bt,qn.PermissionDeniedError=pt,qn.UnprocessableEntityError=mt,qn.toFile=E,qn.fileFromPath=u;const{vc:Jn,LG:Hn,xX:Xn,qA:Vn,cH:Gn,m_:Kn,fK:zn,OE:Qn,v7:Yn,v3:Zn,PO:tr,Ll:er,Is:nr}=t;var rr;(rr=qn||(qn={})).Page=xt,rr.CursorPage=St,rr.Completions=Pt,rr.Chat=Ot,rr.Embeddings=jt,rr.Files=kt,rr.FileObjectsPage=Rt,rr.Images=It,rr.Audio=Mt,rr.Moderations=Nt,rr.Models=Ft,rr.ModelsPage=Bt,rr.FineTuning=Jt,rr.Beta=Bn,rr.Batches=Ln,rr.BatchesPage=Wn,rr.Uploads=Un,new Set(["/completions","/chat/completions","/embeddings","/audio/transcriptions","/audio/translations","/audio/speech","/images/generations"]);var sr=qn;function or(t){return or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},or(t)}function ir(){ir=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof g?e:g,i=Object.create(o.prototype),a=new R(r||[]);return s(i,"_invoke",{value:E(t,n,a)}),i}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",m={};function g(){}function b(){}function w(){}var v={};l(v,i,(function(){return this}));var _=Object.getPrototypeOf,x=_&&_(_(I([])));x&&x!==n&&r.call(x,i)&&(v=x);var S=w.prototype=g.prototype=Object.create(v);function A(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function n(s,o,i,a){var c=f(t[s],t,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==or(u)&&r.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(u).then((function(t){l.value=t,i(l)}),(function(t){return n("throw",t,i,a)}))}a(c.arg)}var o;s(this,"_invoke",{value:function(t,r){function s(){return new e((function(e,s){n(t,r,e,s)}))}return o=o?o.then(s,s):s()}})}function E(e,n,r){var s=h;return function(o,i){if(s===d)throw Error("Generator is already running");if(s===y){if("throw"===o)throw i;return{value:t,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=O(a,r);if(c){if(c===m)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(s===h)throw s=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);s=d;var l=f(e,n,r);if("normal"===l.type){if(s=r.done?y:p,l.arg===m)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(s=y,r.method="throw",r.arg=l.arg)}}}function O(e,n){var r=n.method,s=e.iterator[r];if(s===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=f(s,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function I(e){if(e||""===e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var s=-1,o=function n(){for(;++s<e.length;)if(r.call(e,s))return n.value=e[s],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(or(e)+" is not iterable")}return b.prototype=w,s(S,"constructor",{value:w,configurable:!0}),s(w,"constructor",{value:b,configurable:!0}),b.displayName=l(w,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,l(t,c,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},A(P.prototype),l(P.prototype,a,(function(){return this})),e.AsyncIterator=P,e.async=function(t,n,r,s,o){void 0===o&&(o=Promise);var i=new P(u(t,n,r,s),o);return e.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},A(S),l(S,c,"Generator"),l(S,i,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=I,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function s(r,s){return a.type="throw",a.arg=e,n.next=r,s&&(n.method="next",n.arg=t),!!s}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return s("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(c&&l){if(this.prev<i.catchLoc)return s(i.catchLoc,!0);if(this.prev<i.finallyLoc)return s(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return s(i.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return s(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n];if(s.tryLoc<=this.prev&&r.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var o=s;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var s=r.arg;k(n)}return s}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:I(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}function ar(t,e,n,r,s,o,i){try{var a=t[o](i),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,s)}function cr(t){return function(){var e=this,n=arguments;return new Promise((function(r,s){var o=t.apply(e,n);function i(t){ar(o,r,s,i,a,"next",t)}function a(t){ar(o,r,s,i,a,"throw",t)}i(void 0)}))}}var lr,ur=n(27852),fr="";function hr(t,e,n){return pr.apply(this,arguments)}function pr(){return(pr=cr(ir().mark((function t(e,n,r){var s,o,i,a,c,l,u,f;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,s=new sr({apiKey:"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",dangerouslyAllowBrowser:!0}),o="asst_BnExFeePPpmWiBzyNfkWrAaP",i="Change Article "+e+' in a way that "'+n+'". Show only revised version of '+e+". Highlight the changes using Italic font.",t.next=6,s.beta.threads.create({messages:[{role:"user",content:String(i)}]});case 6:return a=t.sent,c=a.id,console.log("Created thread with Id: "+c),l=s.beta.threads.runs.stream(c,{assistant_id:o}),t.next=12,l.finalRun();case 12:if("completed"!=t.sent.status){t.next=19;break}return t.next=16,s.beta.threads.messages.list(c);case 16:u=t.sent,fr=u.data[0].content[0].text.value,fr=String(fr).replace("\n",String.fromCharCode(11));case 19:t.next=27;break;case 21:t.prev=21,t.t0=t.catch(0),(f=$("#"+r)).text(t.t0.message),f.show(),console.log(t.t0);case 27:case"end":return t.stop()}}),t,null,[[0,21]])})))).apply(this,arguments)}function dr(){return yr.apply(this,arguments)}function yr(){return(yr=cr(ir().mark((function t(){var e,n;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=document.getElementById("bib-file"),(n=new FileReader).onloadend=function(){lr=n.result,wr(),gr()},n.readAsBinaryString(e.files[0]);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function mr(){return(mr=cr(ir().mark((function t(){var e,n;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=$("#search"),n=$("#radio-buttons"),e.on("search keyup",(function(){var t=$(this).val();t?n.children().each((function(){var e=$(this);e.text().search(new RegExp(t,"i"))<0?e.hide():e.show()})):$("#radio-buttons").children().each((function(){$(this).show()})),n.change()}));case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function gr(){return br.apply(this,arguments)}function br(){return(br=cr(ir().mark((function t(){var e;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(e=$("#references-section")).show(),e.change();case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function wr(){return vr.apply(this,arguments)}function vr(){return(vr=cr(ir().mark((function t(){var e,n,r,s,o;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(s in e=ur.toJSON(lr),console.log(e),n=$("#populate-radio"),(r=$("#radio-buttons")).empty(),e)o='<section><input type="radio" id="'.concat(e[s].citationKey,'" name="citation" value=\'').concat(e[s].entryTags.article,"|").concat(e[s].entryTags.annotation,"'>\n      <label for=\"").concat(e[s].citationKey,'"><b>').concat(e[s].entryTags.annotation,"</b><br>").concat(e[s].entryTags.article,'</label><br><br>\n      <div>\n      <textarea class="input" id="openAIPanel').concat(e[s].citationKey,'" rows="8" cols="80"  style="display: none;"></textarea>\n      <div>\n      <div class="error" id="error').concat(e[s].citationKey,'" style="display: none;">\n      <div>\n      </section>'),r.append(o);r.appendTo(n),$("input[name='citation'][type='radio']").on("click",(function(){if($(this).prop("checked")){var t=String($(this).prop("value")).split("|"),e=t[0],n=t[1];kr(e),Mr();var r="error".concat($(this).prop("id"));Ir(e.replace("Article","").trim(),r),_r("openAIPanel".concat($(this).prop("id")),e,n,r)}else Cr(),Fr()})),n.change();case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function _r(t,e,n,r){return xr.apply(this,arguments)}function xr(){return(xr=cr(ir().mark((function t(e,n,r,s){var o,i;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if($(".input").hide(),o=$("#"+e),0!=String(o.text()).trim().length){t.next=11;break}return(i=$("#radio-buttons")).children("input[type=radio]").prop("disabled",!0),$("#please_wait").show(),t.next=8,hr(n,r,s);case 8:o.text(fr),i.children("input[type=radio]").prop("disabled",!1),$("#please_wait").hide();case 11:o.show();case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Sr(){return Ar.apply(this,arguments)}function Ar(){return Ar=cr(ir().mark((function t(){return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Word.run(function(){var t=cr(ir().mark((function t(e){var n,r,s;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=$("input[name='citation'][type='radio']:checked").attr("id"),r=$("#openAIPanel"+n),s=r.text(),e.document.getSelection().insertText(s,Word.InsertLocation.end),t.next=8,e.sync();case 8:console.log("Inserted suggestion: ".concat(citationsuggestion));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)}))),Ar.apply(this,arguments)}function Pr(){return Er.apply(this,arguments)}function Er(){return Er=cr(ir().mark((function t(){return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Word.run(function(){var t=cr(ir().mark((function t(e){var n,r,s;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=$("input[name='citation'][type='radio']:checked").attr("id"),r=$("#openAIPanel"+n),s=r.text(),e.document.getSelection().insertText(s,Word.InsertLocation.replace),t.next=8,e.sync();case 8:console.log("Replacement suggestion: ".concat(s));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)}))),Er.apply(this,arguments)}function Or(){return jr.apply(this,arguments)}function jr(){return(jr=cr(ir().mark((function t(){return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:$("input[name='citation'][type='radio']:checked").prop("checked",!1),$(".input").hide(),$(".error").hide(),Cr(),Fr();case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function kr(t){return Rr.apply(this,arguments)}function Rr(){return(Rr=cr(ir().mark((function t(e){return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:$("#selected").text(e);case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ir(t,e){return $r.apply(this,arguments)}function $r(){return $r=cr(ir().mark((function t(e,n){return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Word.run(function(){var t=cr(ir().mark((function t(r){var s;return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r.document.body.search(e,{ignorePunct:!0}).getFirst().select(),t.next=5,r.sync();case 5:t.next=13;break;case 7:t.prev=7,t.t0=t.catch(0),(s=$("#"+n)).text(t.t0.message),s.show(),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)}))),$r.apply(this,arguments)}function Cr(){return Tr.apply(this,arguments)}function Tr(){return(Tr=cr(ir().mark((function t(){return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:$("#selected").text("");case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Mr(){return Nr.apply(this,arguments)}function Nr(){return(Nr=cr(ir().mark((function t(){return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:$(".ms-Button").removeAttr("disabled");case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Fr(){return Br.apply(this,arguments)}function Br(){return(Br=cr(ir().mark((function t(){return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:$(".ms-Button").attr("disabled","disabled");case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Lr(t){return Wr.apply(this,arguments)}function Wr(){return(Wr=cr(ir().mark((function t(e){return ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e();case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.log(t.t0);case 8:case"end":return t.stop()}}),t,null,[[0,5]])})))).apply(this,arguments)}Office.onReady((function(t){$(document).ready((function(){t.host===Office.HostType.Word&&(document.getElementById("app-body").style.display="flex",$("#bib-file").on("change",(function(){return Lr(dr)})),function(){mr.apply(this,arguments)}(),$("#replace-suggestion").on("click",(function(){return Lr(Pr)})),$("#insert-suggestion").on("click",(function(){return Lr(Sr)})),$("#clear").on("click",(function(){return Lr(Or)})))}))}))}(),function(){"use strict";var t=n(14385),e=n.n(t),r=new URL(n(58394),n.b);e()(r)}()}();
>>>>>>> aca24b35e7bf8a02d8f724197711e93d7e452fc3
//# sourceMappingURL=taskpane.js.map